!function(){"use strict";function e(){return"mce-pagebreak"}function n(){return'<img src="'+t.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'}var a=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),r=function(e){return e.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")},o=function(e){return e.getParam("pagebreak_split_block",!1)},c=function(e){var a=r(e),t=new RegExp(a.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,(function(e){return"\\"+e})),"gi");e.on("BeforeSetContent",(function(e){e.content=e.content.replace(t,n())})),e.on("PreInit",(function(){e.serializer.addNodeFilter("img",(function(n){for(var t,r,c=n.length;c--;)if((r=(t=n[c]).attr("class"))&&-1!==r.indexOf("mce-pagebreak")){var i=t.parent;if(e.schema.getBlockElements()[i.name]&&o(e)){i.type=3,i.value=a,i.raw=!0,t.remove();continue}t.type=3,t.value=a,t.raw=!0}}))}))},i=n,u=e,g=function(e){e.addCommand("mcePageBreak",(function(){e.settings.pagebreak_split_block?e.insertContent("<p>"+i()+"</p>"):e.insertContent(i())}))},m=function(e){e.on("ResolveName",(function(n){"IMG"===n.target.nodeName&&e.dom.hasClass(n.target,u())&&(n.name="pagebreak")}))},s=function(e){e.ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:function(){return e.execCommand("mcePageBreak")}}),e.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:function(){return e.execCommand("mcePageBreak")}})};!function(){a.add("pagebreak",(function(e){g(e),s(e),c(e),m(e)}))}()}();