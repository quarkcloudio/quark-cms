!function(){"use strict";function e(){}function t(e){return function(){return e}}function n(){return s}var r,o=function(e){function t(){return n}var n=e;return{get:t,set:function(e){n=e},clone:function(){return o(t())}}},a=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c=t(!1),u=t(!0),d=t("[!-#%-*,-\\/:;?@\\[-\\]_{}\xa1\xab\xb7\xbb\xbf;\xb7\u055a-\u055f\u0589\u058a\u05be\u05c0\u05c3\u05c6\u05f3\u05f4\u0609\u060a\u060c\u060d\u061b\u061e\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0830-\u083e\u085e\u0964\u0965\u0970\u0df4\u0e4f\u0e5a\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u0fd9\u0fda\u104a-\u104f\u10fb\u1361-\u1368\u1400\u166d\u166e\u169b\u169c\u16eb-\u16ed\u1735\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944\u1945\u1a1e\u1a1f\u1aa0-\u1aa6\u1aa8-\u1aad\u1b5a-\u1b60\u1bfc-\u1bff\u1c3b-\u1c3f\u1c7e\u1c7f\u1cd3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u207d\u207e\u208d\u208e\u3008\u3009\u2768-\u2775\u27c5\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc\u29fd\u2cf9-\u2cfc\u2cfe\u2cff\u2d70\u2e00-\u2e2e\u2e30\u2e31\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\ua4fe\ua4ff\ua60d-\ua60f\ua673\ua67e\ua6f2-\ua6f7\ua874-\ua877\ua8ce\ua8cf\ua8f8-\ua8fa\ua92e\ua92f\ua95f\ua9c1-\ua9cd\ua9de\ua9df\uaa5c-\uaa5f\uaade\uaadf\uabeb\ufd3e\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a\uff1b\uff1f\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]"),s=(r={fold:function(e,t){return e()},is:c,isSome:c,isNone:u,getOr:m,getOrThunk:f,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:m,orThunk:f,map:n,each:e,bind:n,exists:c,forall:u,filter:n,equals:l,equals_:l,toArray:function(){return[]},toString:t("none()")},Object.freeze&&Object.freeze(r),r);function l(e){return e.isNone()}function f(e){return e()}function m(e){return e}var g=function(e){function n(){return a}function r(t){return t(e)}var o=t(e),a={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:u,isNone:c,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(t){return g(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?a:s},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(c,(function(t){return n(e,t)}))}};return a},p={some:g,none:n,from:function(e){return null===e||void 0===e?s:g(e)}},h=d,x=tinymce.util.Tools.resolve("tinymce.util.Tools");function v(e){return e&&1===e.nodeType&&"false"===e.contentEditable}function y(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t}function b(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function N(e,t){var n,r=[];if((n=x.toArray(e.getBody().getElementsByTagName("span"))).length)for(var o=0;o<n.length;o++){var a=y(n[o]);null!==a&&a.length&&a===t.toString()&&r.push(n[o])}return r}function w(e,t,n){var r=t.get(),o=r.index,a=e.dom;(n=!1!==n)?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,a.removeClass(N(e,r.index),"mce-match-marker-selected");var i=N(e,o);return i.length?(a.addClass(N(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(i[0]),o):-1}function C(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)}function T(e,t,n,r,o){var a=function(e,t){var n="("+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n]")+")";return t?"(?:^|\\s|"+h()+")"+n+"(?=$|\\s|"+h()+")":n}(n,o),i=function(e,t,n){var r,o;return(o=e.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",r=e.getBody(),M(e,t,!1),E.findAndReplaceDOMText(n,r,o,1,e.schema)}(e,t,new RegExp(a,r?"g":"gi"));if(i){var c=w(e,t,!0);t.set({index:c,count:i,text:n,matchCase:r,wholeWord:o})}return i}function S(e,t){var n=w(e,t,!0);t.set(i(i({},t.get()),{index:n}))}function O(e,t){var n=w(e,t,!1);t.set(i(i({},t.get()),{index:n}))}function A(e){var t=y(e);return null!==t&&0<t.length}function k(e,t,n,r,o){var a,c,u,d,s,l=t.get(),f=l.index,m=f;for(r=!1!==r,u=e.getBody(),c=x.grep(x.toArray(u.getElementsByTagName("span")),A),a=0;a<c.length;a++){var g=y(c[a]);if(d=s=parseInt(g,10),o||d===l.index){for(n.length?(c[a].firstChild.nodeValue=n,b(c[a])):C(e.dom,c[a]);c[++a];){if((d=parseInt(y(c[a]),10))!==s){a--;break}C(e.dom,c[a])}r&&m--}else f<s&&c[a].setAttribute("data-mce-index",String(s-1))}return t.set(i(i({},l),{count:o?0:l.count-1,index:m})),r?S(e,t):O(e,t),!o&&0<t.get().count}function B(e,t){return function(){j(e,t)}}var I,E={findAndReplaceDOMText:function(e,t,n,r,o){var a,i,c,u,d,s,l=[],f=0;function m(e,t){if(t=t||0,!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var n=e.index;if(0<t){var r=e[t];if(!r)throw new Error("Invalid capture group");n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}if(c=t.ownerDocument,u=o.getBlockElements(),d=o.getWhiteSpaceElements(),s=o.getShortEndedElements(),i=function e(t){var n;if(3===t.nodeType)return t.data;if(d[t.nodeName]&&!u[t.nodeName])return"";if(n="",v(t))return"\n";if((u[t.nodeName]||s[t.nodeName])&&(n+="\n"),t=t.firstChild)for(;n+=e(t),t=t.nextSibling;);return n}(t)){if(e.global)for(;a=e.exec(i);)l.push(m(a,r));else a=i.match(e),l.push(m(a,r));return l.length&&(f=l.length,function(e,t,n){var r,o,a,i,c=[],l=0,f=e,m=t.shift(),g=0;e:for(;;){if((u[f.nodeName]||s[f.nodeName]||v(f))&&l++,3===f.nodeType&&(!o&&f.length+l>=m[1]?(o=f,i=m[1]-l):r&&c.push(f),!r&&f.length+l>m[0]&&(r=f,a=m[0]-l),l+=f.length),r&&o){if(f=n({startNode:r,startNodeIndex:a,endNode:o,endNodeIndex:i,innerNodes:c,match:m[2],matchIndex:g}),l-=o.length-i,o=r=null,c=[],g++,!(m=t.shift()))break}else if(d[f.nodeName]&&!u[f.nodeName]||!f.firstChild){if(f.nextSibling){f=f.nextSibling;continue}}else if(!v(f)){f=f.firstChild;continue}for(;;){if(f.nextSibling){f=f.nextSibling;break}if(f.parentNode===e)break e;f=f.parentNode}}}(t,l,function(e){var t;if("function"!=typeof e){var n=e.nodeType?e:c.createElement(e);t=function(e,t){var r=n.cloneNode(!1);return r.setAttribute("data-mce-index",t),e&&r.appendChild(c.createTextNode(e)),r}}else t=e;return function(e){var n,r,o,a=e.startNode,i=e.endNode,u=e.matchIndex;if(a===i){var d=a;o=d.parentNode,0<e.startNodeIndex&&(n=c.createTextNode(d.data.substring(0,e.startNodeIndex)),o.insertBefore(n,d));var s=t(e.match[0],u);return o.insertBefore(s,d),e.endNodeIndex<d.length&&(r=c.createTextNode(d.data.substring(e.endNodeIndex)),o.insertBefore(r,d)),d.parentNode.removeChild(d),s}n=c.createTextNode(a.data.substring(0,e.startNodeIndex)),r=c.createTextNode(i.data.substring(e.endNodeIndex));for(var l=t(a.data.substring(e.startNodeIndex),u),f=0,m=e.innerNodes.length;f<m;++f){var g=e.innerNodes[f],p=t(g.data,u);g.parentNode.replaceChild(p,g)}var h=t(i.data.substring(0,e.endNodeIndex),u);return(o=a.parentNode).insertBefore(n,a),o.insertBefore(l,a),o.removeChild(a),(o=i.parentNode).insertBefore(h,i),o.insertBefore(r,i),o.removeChild(i),h}}(n))),f}}},M=function(e,t,n){var r,o,a,c,u=t.get();for(o=x.toArray(e.getBody().getElementsByTagName("span")),r=0;r<o.length;r++){var d=y(o[r]);null!==d&&d.length&&(d===u.index.toString()&&(a=a||o[r].firstChild,c=o[r].firstChild),b(o[r]))}if(t.set(i(i({},u),{index:-1,count:0,text:""})),a&&c){var s=e.dom.createRng();return s.setStart(a,0),s.setEnd(c,c.data.length),!1!==n&&e.selection.setRng(s),s}},D=function(e,t){return{done:function(n){return M(e,t,n)},find:function(n,r,o){return T(e,t,n,r,o)},next:function(){return S(e,t)},prev:function(){return O(e,t)},replace:function(n,r,o){return k(e,t,n,r,o)}}},R=(I="function",function(e){return function(e){if(null===e)return"null";var t=typeof e;return"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t}(e)===I}),F=(Array.prototype.slice,R(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.Env")),j=function(e,t){var n=function(){var e=o(p.none());return{clear:function(){e.set(p.none())},set:function(t){e.set(p.some(t))},isSet:function(){return e.get().isSome()},on:function(t){e.get().each(t)}}}();e.undoManager.add();var r=x.trim(e.selection.getContent({format:"text"}));function a(e){(!function(e,t){return 1<t.get().count}(0,t)?e.disable:e.enable)("next"),(function(e,t){return 1<t.get().count}(0,t)?e.enable:e.disable)("prev")}function c(e,t){!function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}(["replace","replaceall","prev","next"],t?e.disable:e.enable)}function u(e,t){F.browser.isSafari()&&F.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)}function d(n){M(e,t,!1),c(n,!0),a(n)}function s(n){var r=n.getData(),o=t.get();if(r.findtext.length){if(o.text===r.findtext&&o.matchCase===r.matchcase&&o.wholeWord===r.wholewords)S(e,t);else{var i=T(e,t,r.findtext,r.matchcase,r.wholewords);i<=0&&function(t){e.windowManager.alert("Could not find the specified string.",(function(){t.focus("findtext")}))}(n),c(n,0===i)}a(n)}else d(n)}var l=t.get(),f={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace All",disabled:!0}],initialData:{findtext:r,replacetext:"",wholewords:l.wholeWord,matchcase:l.matchCase},onChange:function(e,n){"findtext"===n.name&&0<t.get().count&&d(e)},onAction:function(n,r){var o=n.getData();switch(r.name){case"find":s(n);break;case"replace":k(e,t,o.replacetext)?a(n):d(n);break;case"replaceall":k(e,t,o.replacetext,!0,!0),d(n);break;case"prev":O(e,t),a(n);break;case"next":S(e,t),a(n);break;case"matchcase":case"wholewords":!function(e){var n=e.getData(),r=t.get();t.set(i(i({},r),{matchCase:n.matchcase,wholeWord:n.wholewords}))}(n),d(n)}u(n,r.name)},onSubmit:function(e){s(e),u(e,"find")},onClose:function(){e.focus(),M(e,t),e.undoManager.add()}};n.set(e.windowManager.open(f,{inline:"toolbar"}))},P=function(e,t){e.addCommand("SearchReplace",(function(){j(e,t)}))},W=function(e,t){e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:B(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:B(e,t),icon:"search"}),e.shortcuts.add("Meta+F","",B(e,t))};!function(){a.add("searchreplace",(function(e){var t=o({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1});return P(e,t),W(e,t),D(e,t)}))}()}();