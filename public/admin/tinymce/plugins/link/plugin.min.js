!function(n){"use strict";function t(n){return function(t){return function(n){if(null===n)return"null";var t=typeof n;return"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(t)===n}}function e(){}function r(n){return function(){return n}}function o(){return C}var i,u=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=tinymce.util.Tools.resolve("tinymce.util.VK"),a=t("string"),l=t("array"),f=t("boolean"),s=t("function"),m=function(n){var t=n.getParam("link_assume_external_targets",!1);return f(t)&&t?1:!a(t)||"http"!==t&&"https"!==t?0:t},d=function(n){return n.getParam("link_context_toolbar",!1,"boolean")},h=function(n){return n.getParam("link_list")},p=function(n){return n.getParam("default_link_target")},g=function(n){return n.getParam("target_list",!0)},v=function(n){return n.getParam("rel_list",[],"array")},y=function(n){return n.getParam("link_class_list",[],"array")},w=function(n){return n.getParam("link_title",!0,"boolean")},k=function(n){return n.getParam("allow_unsafe_link_target",!1,"boolean")},x=function(n){return n.getParam("link_quicklink",!1,"boolean")},b=function(n){return n.getParam("link_default_protocol","http","string")},_=function(t){var e=n.document.createElement("a");e.target="_blank",e.href=t,e.rel="noreferrer noopener";var r=n.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,n.window,0,0,0,0,0,!1,!1,!1,!1,0,null),function(t,e){n.document.body.appendChild(t),t.dispatchEvent(e),n.document.body.removeChild(t)}(e,r)},T=function(){return(T=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},O=r(!1),A=r(!0),C=(i={fold:function(n,t){return n()},is:O,isSome:O,isNone:A,getOr:E,getOrThunk:N,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:E,orThunk:N,map:o,each:e,bind:o,exists:O,forall:A,filter:o,equals:P,equals_:P,toArray:function(){return[]},toString:r("none()")},Object.freeze&&Object.freeze(i),i);function P(n){return n.isNone()}function N(n){return n()}function E(n){return n}function I(n,t){return-1<function(n,t){return Y.call(n,t)}(n,t)}function S(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)}function j(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!l(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);Z.apply(t,n[e])}return t}function F(n,t){return j(function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r}(n,t))}function L(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return Q.none()}function R(n){return/^\w+:/i.test(n)}function D(n){var t=n.getAttribute("data-mce-href");return t||n.getAttribute("href")}function U(n,t){var e,r,o=["noopener"],i=n?n.split(/\s+/):[],u=function(n){return n.filter((function(n){return-1===nn.inArray(o,n)}))},c=t?0<(e=u(e=i)).length?e.concat(o):o:u(i);return 0<c.length?(r=c,nn.trim(r.sort().join(" "))):""}function M(n,t){return t=t||n.selection.getNode(),tn(t)?n.dom.select("a[href]",t)[0]:n.dom.getParent(t,"a[href]")}function z(n){return n&&"A"===n.nodeName&&!!D(n)}function q(n){return function(n,t,e){return S(n,(function(n){e=t(e,n)})),e}(["title","rel","class","target"],(function(t,e){return n[e].each((function(n){t[e]=0<n.length?n:null})),t}),{href:n.href})}function K(n,t){var e=T({},t);if(!(0<v(n).length)&&!1===k(n)){var r=U(e.rel,"_blank"===e.target);e.rel=r||null}return Q.from(e.target).isNone()&&!1===g(n)&&(e.target=p(n)),e.href=function(n,t){return"http"!==t&&"https"!==t||R(n)?n:t+"://"+n}(e.href,m(n)),e}function B(n){return a(n.value)?n.value:""}function V(n){return void 0===n&&(n=B),function(t){return Q.from(t).map((function(t){return function(n,t){var e=[];return nn.each(n,(function(n){var r=a(n.text)?n.text:a(n.title)?n.title:"";if(void 0!==n.menu);else{var o=t(n);e.push({text:r,value:o})}})),e}(t,n)}))}}function W(n,t,r,o){var i=o[t],u=0<n.length;return void 0!==i?function(n,t){return L(t,(function(t){return Q.some(t).filter((function(t){return t.value===n}))}))}(i,r).map((function(t){return{url:{value:t.value,meta:{text:u?n:t.text,attach:e}},text:u?n:t.text}})):Q.none()}var H,$,G,J,X=function(n){function t(){return i}function e(t){return t(n)}var o=r(n),i={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:A,isNone:O,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:t,orThunk:t,map:function(t){return X(t(n))},each:function(t){t(n)},bind:e,exists:e,forall:e,filter:function(t){return t(n)?i:C},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(O,(function(t){return e(n,t)}))}};return i},Q={some:X,none:o,from:function(n){return null===n||void 0===n?C:X(n)}},Y=(Array.prototype.slice,Array.prototype.indexOf),Z=Array.prototype.push,nn=(s(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Tools")),tn=function(n){return n&&"FIGURE"===n.nodeName&&/\bimage\b/i.test(n.className)},en=function(n,t){var e=n.dom.select("img",t)[0];if(e){var r=n.dom.getParents(e,"a[href]",t)[0];r&&(r.parentNode.insertBefore(e,r),n.dom.remove(r))}},rn=function(n,t,e){var r=n.dom.select("img",t)[0];if(r){var o=n.dom.create("a",e);r.parentNode.insertBefore(o,r),o.appendChild(r)}},on=function(n,t,e){var r=n.selection.getNode(),o=M(n,r),i=K(n,q(e));n.undoManager.transact((function(){e.href===t.href&&t.attach(),o?(n.focus(),function(n,t,e,r){e.each((function(n){t.hasOwnProperty("innerText")?t.innerText=n:t.textContent=n})),n.dom.setAttribs(t,r),n.selection.select(t)}(n,o,e.text,i)):function(n,t,e,r){tn(t)?rn(n,t,r):e.fold((function(){n.execCommand("mceInsertLink",!1,r)}),(function(t){n.insertContent(n.dom.createHTML("a",r,n.dom.encode(t)))}))}(n,r,e.text,i)}))},un=function(n){n.undoManager.transact((function(){var t=n.selection.getNode();if(tn(t))en(n,t);else{var e=n.dom.getParent(t,"a[href]",n.getBody());e&&n.dom.remove(e,!0)}n.focus()}))},cn=function(n){return 0<nn.grep(n,z).length},an=D,ln=function(n){return!(/</.test(n)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(n)||-1===n.indexOf("href=")))},fn=M,sn=function(n,t){return function(n){return n.replace(/\uFEFF/g,"")}(t?t.innerText||t.textContent:n.getContent({format:"text"}))},mn=U,dn=R,hn={sanitize:function(n){return V(B)(n)},sanitizeWith:V,createUi:function(n,t){return function(e){return{name:n,type:"selectbox",label:t,items:e}}},getValue:B},pn=function(n){function t(){return e}var e=n;return{get:t,set:function(n){e=n},clone:function(){return pn(t())}}},gn=function(n,t){function e(n,e){var o=function(n,t){return"link"===t?n.catalogs.link:"anchor"===t?n.catalogs.anchor:Q.none()}(t,e.name).getOr([]);return W(r.get(),e.name,o,n)}var r=pn(n.text);return{onChange:function(n,t){return"url"===t.name?function(n){if(r.get().length<=0){var t=void 0!==n.url.meta.text?n.url.meta.text:n.url.value,e=void 0!==n.url.meta.title?n.url.meta.title:"";return Q.some({text:t,title:e})}return Q.none()}(n()):I(["anchor","link"],t.name)?e(n(),t):("text"===t.name&&r.set(n().text),Q.none())}}},vn={},yn={exports:vn};function wn(t){n.setTimeout((function(){throw t}),0)}function kn(n){var t=n.href;return 0<t.indexOf("@")&&-1===t.indexOf("//")&&-1===t.indexOf("mailto:")?Q.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(n){return T(T({},n),{href:"mailto:"+t})}}):Q.none()}function xn(n,t,e){var r=n.getAttrib(t,e);return null!==r&&0<r.length?Q.some(r):Q.none()}function bn(n,t){return n.dom.getParent(t,"a[href]")}function _n(n){return bn(n,n.selection.getStart())}function Tn(n,t){if(t){var e=an(t);if(/^#/.test(e)){var r=n.$(e);r.length&&n.selection.scrollIntoView(r[0],!0)}else _(t.href)}}H=void 0,$=vn,G=yn,J=void 0,function(n){"object"==typeof $&&void 0!==G?G.exports=n():"function"==typeof H&&H.amd?H([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}((function(){return function n(t,e,r){function o(u,c){if(!e[u]){if(!t[u]){var a="function"==typeof J&&J;if(!c&&a)return a(u,!0);if(i)return i(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var f=e[u]={exports:{}};t[u][0].call(f.exports,(function(n){return o(t[u][1][n]||n)}),f,f.exports,n,t,e,r)}return e[u].exports}for(var i="function"==typeof J&&J,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(n,t,e){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(t){try{return r.call(null,n,0)}catch(t){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var l,f=[],s=!1,m=-1;function d(){s&&l&&(s=!1,l.length?f=l.concat(f):m=-1,f.length&&h())}function h(){if(!s){var n=a(d);s=!0;for(var t=f.length;t;){for(l=f,f=[];++m<t;)l&&l[m].run();m=-1,t=f.length}l=null,s=!1,function(n){if(o===clearTimeout)return clearTimeout(n);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{o(n)}catch(t){try{return o.call(null,n)}catch(t){return o.call(this,n)}}}(n)}}function p(n,t){this.fun=n,this.array=t}function g(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];f.push(new p(n,t)),1!==f.length||s||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){function e(){}function r(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(n,this)}function o(n,t){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,r._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var r;try{r=e(n._value)}catch(s){return void u(t.promise,s)}i(t.promise,r)}else(1===n._state?i:u)(t.promise,n._value)}))):n._deferreds.push(t)}function i(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof r)return n._state=3,n._value=t,void c(n);if("function"==typeof e)return void l(function(n,t){return function(){n.apply(t,arguments)}}(e,t),n)}n._state=1,n._value=t,c(n)}catch(o){u(n,o)}}function u(n,t){n._state=2,n._value=t,c(n)}function c(n){2===n._state&&0===n._deferreds.length&&r._immediateFn((function(){n._handled||r._unhandledRejectionFn(n._value)}));for(var t=0,e=n._deferreds.length;t<e;t++)o(n,n._deferreds[t]);n._deferreds=null}function a(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function l(n,t){var r=!1;try{n((function(n){r||(r=!0,i(t,n))}),(function(n){r||(r=!0,u(t,n))}))}catch(e){if(r)return;r=!0,u(t,e)}}var f,s;f=this,s=setTimeout,r.prototype["catch"]=function(n){return this.then(null,n)},r.prototype.then=function(n,t){var r=new this.constructor(e);return o(this,new a(n,t,r)),r},r.all=function(n){var t=Array.prototype.slice.call(n);return new r((function(n,r){if(0===t.length)return n([]);var o=t.length;function i(u,c){try{if(c&&("object"==typeof c||"function"==typeof c)){var a=c.then;if("function"==typeof a)return void a.call(c,(function(n){i(u,n)}),r)}t[u]=c,0==--o&&n(t)}catch(e){r(e)}}for(var u=0;u<t.length;u++)i(u,t[u])}))},r.resolve=function(n){return n&&"object"==typeof n&&n.constructor===r?n:new r((function(t){t(n)}))},r.reject=function(n){return new r((function(t,e){e(n)}))},r.race=function(n){return new r((function(t,e){for(var r=0,o=n.length;r<o;r++)n[r].then(t,e)}))},r._immediateFn="function"==typeof n?function(t){n(t)}:function(n){s(n,0)},r._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},r._setImmediateFn=function(n){r._immediateFn=n},r._setUnhandledRejectionFn=function(n){r._unhandledRejectionFn=n},void 0!==t&&t.exports?t.exports=r:f.Promise||(f.Promise=r)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,r){var o=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,c={},a=0;function l(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new l(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new l(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;0<=t&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"==typeof t?t:function(n){var t=a++,r=!(arguments.length<2)&&u.call(arguments,1);return c[t]=!0,o((function(){c[t]&&(r?n.apply(null,r):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"==typeof r?r:function(n){delete c[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}));var On=yn.exports.boltExport,An=function(t){var e=Q.none(),r=[],o=function(n){i()?c(n):r.push(n)},i=function(){return e.isSome()},u=function(n){S(n,c)},c=function(t){e.each((function(e){n.setTimeout((function(){t(e)}),0)}))};return t((function(n){e=Q.some(n),u(r),r=[]})),{get:o,map:function(n){return An((function(t){o((function(e){t(n(e))}))}))},isReady:i}},Cn={nu:An,pure:function(n){return An((function(t){t(n)}))}},Pn=function(n){function t(t){n().then(t,wn)}return{map:function(t){return Pn((function(){return n().then(t)}))},bind:function(t){return Pn((function(){return n().then((function(n){return t(n).toPromise()}))}))},anonBind:function(t){return Pn((function(){return n().then((function(){return t.toPromise()}))}))},toLazy:function(){return Cn.nu(t)},toCached:function(){var t=null;return Pn((function(){return null===t&&(t=n()),t}))},toPromise:n,get:t}},Nn=function(n){return Pn((function(){return new On(n)}))},En=function(n){return Pn((function(){return On.resolve(n)}))},In=tinymce.util.Tools.resolve("tinymce.util.Delay"),Sn=function(n,t){return L([kn,function(n,t){return function(e){var r=e.href;return 1===n&&!dn(r)||0===n&&/^\s*www[\.|\d\.]/i.test(r)?Q.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+t+":// prefix?",preprocess:function(n){return T(T({},n),{href:t+"://"+r})}}):Q.none()}}(m(n),b(n))],(function(n){return n(t)})).fold((function(){return En(t)}),(function(e){return Nn((function(r){!function(n,t,e){var r=n.selection.getRng();In.setEditorTimeout(n,(function(){n.windowManager.confirm(t,(function(t){n.selection.setRng(r),e(t)}))}))}(n,e.message,(function(n){r(n?e.preprocess(t):t)}))}))}))},jn=function(n){var t=n.dom.select("a:not([href])"),e=F(t,(function(n){var t=n.name||n.id;return t?[{text:t,value:"#"+t}]:[]}));return 0<e.length?Q.some([{text:"None",value:""}].concat(e)):Q.none()},Fn=function(n){var t=y(n);return 0<t.length?hn.sanitize(t):Q.none()},Ln=tinymce.util.Tools.resolve("tinymce.util.XHR"),Rn=function(n){function t(t){return n.convertURL(t.value||t.url,"href")}var e=h(n);return Nn((function(n){a(e)?Ln.send({url:e,success:function(t){return n(function(t){try{return Q.some(JSON.parse(t))}catch(n){return Q.none()}}(t))},error:function(t){return n(Q.none())}}):s(e)?e((function(t){return n(Q.some(t))})):n(Q.from(e))})).map((function(n){return n.bind(hn.sanitizeWith(t)).map((function(n){return 0<n.length?[{text:"None",value:""}].concat(n):n}))}))},Dn=function(n,t){var e=v(n);if(0<e.length){var r=t.is("_blank");return(!1===k(n)?hn.sanitizeWith((function(n){return mn(hn.getValue(n),r)})):hn.sanitize)(e)}return Q.none()},Un=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],Mn=function(n){var t=g(n);return l(t)?hn.sanitize(t).orThunk((function(){return Q.some(Un)})):!1===t?Q.none():Q.some(Un)},zn=function(n,t){return Rn(n).map((function(e){var r=function(n,t){var e=n.dom,r=ln(n.selection.getContent())?Q.some(sn(n.selection,t)):Q.none(),o=t?Q.some(e.getAttrib(t,"href")):Q.none(),i=t?Q.from(e.getAttrib(t,"target")):Q.none(),u=xn(e,t,"rel"),c=xn(e,t,"class");return{url:o,text:r,title:xn(e,t,"title"),target:i,rel:u,linkClass:c}}(n,t);return{anchor:r,catalogs:{targets:Mn(n),rels:Dn(n,r.target),classes:Fn(n),anchor:jn(n),link:e},optNode:Q.from(t),flags:{titleEnabled:w(n)}}}))},qn=function(n){(function(n){var t=fn(n);return zn(n,t)})(n).map((function(t){return function(n,t,e){var r=n.anchor.text.map((function(){return{name:"text",type:"input",label:"Text to display"}})).toArray(),o=n.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],i=function(n,t){return{url:{value:n.anchor.url.getOr(""),meta:{attach:function(){},text:n.anchor.url.fold((function(){return""}),(function(){return n.anchor.text.getOr("")})),original:{value:n.anchor.url.getOr("")}}},text:n.anchor.text.getOr(""),title:n.anchor.title.getOr(""),anchor:n.anchor.url.getOr(""),link:n.anchor.url.getOr(""),rel:n.anchor.rel.getOr(""),target:n.anchor.target.or(t).getOr(""),linkClass:n.anchor.linkClass.getOr("")}}(n,Q.from(p(e))),u=gn(i,n),c=n.catalogs;return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:j([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],r,o,function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t}([c.anchor.map(hn.createUi("anchor","Anchors")),c.rels.map(hn.createUi("rel","Rel")),c.targets.map(hn.createUi("target","Open link in...")),c.link.map(hn.createUi("link","Link list")),c.classes.map(hn.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onChange:function(n,t){var e=t.name;u.onChange(n.getData,{name:e}).each((function(t){n.setData(t)}))},onSubmit:t}}(t,function(n,t){return function(e){var r=e.getData();if(!r.url.value)return un(n),void e.close();function o(n){return Q.from(r[n]).filter((function(e){return!t.anchor[n].is(e)}))}var i={href:r.url.value,text:o("text"),target:o("target"),rel:o("rel"),class:o("linkClass"),title:o("title")},u={href:r.url.value,attach:void 0!==r.url.meta&&r.url.meta.attach?r.url.meta.attach:function(){}};Sn(n,i).get((function(t){on(n,u,t)})),e.close()}}(n,t),n)})).get((function(t){n.windowManager.open(t)}))},Kn=function(n){return function(){qn(n)}},Bn=function(n){return function(){Tn(n,_n(n))}},Vn=function(n){n.on("click",(function(t){var e=bn(n,t.target);e&&c.metaKeyPressed(t)&&(t.preventDefault(),Tn(n,e))})),n.on("keydown",(function(t){var e=_n(n);e&&13===t.keyCode&&function(n){return!0===n.altKey&&!1===n.shiftKey&&!1===n.ctrlKey&&!1===n.metaKey}(t)&&(t.preventDefault(),Tn(n,e))}))},Wn=function(n){return function(t){function e(e){return t.setActive(!n.mode.isReadOnly()&&!!fn(n,e.element))}return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}},Hn=function(n){return function(t){var e=n.dom.getParents(n.selection.getStart());function r(n){return t.setDisabled(!cn(n.parents))}return t.setDisabled(!cn(e)),n.on("NodeChange",r),function(){return n.off("NodeChange",r)}}},$n=function(n){n.addCommand("mceLink",(function(){x(n)?n.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):Kn(n)()}))},Gn=function(n){n.addShortcut("Meta+K","",(function(){n.execCommand("mceLink")}))},Jn=function(n){n.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:Kn(n),onSetup:Wn(n)}),n.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:Bn(n),onSetup:Hn(n)}),n.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return un(n)},onSetup:Hn(n)})},Xn=function(n){n.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:Bn(n),onSetup:Hn(n)}),n.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:Kn(n)}),n.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return un(n)},onSetup:Hn(n)})},Qn=function(n){n.ui.registry.addContextMenu("link",{update:function(t){return cn(n.dom.getParents(t,"a"))?"link unlink openlink":"link"}})},Yn=function(n){function t(t){var e=n.selection.getNode();return t.setDisabled(!fn(n,e)),function(){}}n.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:Wn(n)},label:"Link",predicate:function(t){return!!fn(n,t)&&d(n)},initValue:function(){var t=fn(n);return t?an(t):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var e=n.selection.getNode();return t.setActive(!!fn(n,e)),Wn(n)(t)},onAction:function(t){var e=fn(n),r=t.getValue();if(e)n.dom.setAttrib(e,"href",r),function(n){n.selection.collapse(!1)}(n),t.hide();else{var o={href:r,attach:function(){}},i=ln(n.selection.getContent())?Q.some(sn(n.selection,e)).filter((function(n){return 0<n.length})).or(Q.from(r)):Q.none();on(n,o,{href:r,text:i,title:Q.none(),rel:Q.none(),target:Q.none(),class:Q.none()}),t.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:t,onAction:function(t){un(n),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:t,onAction:function(t){Bn(n)(),t.hide()}}]})};!function(){u.add("link",(function(n){Jn(n),Xn(n),Qn(n),Yn(n),Vn(n),$n(n),Gn(n)}))}()}(window);