!function(t){"use strict";function e(t){return function(){return t}}function n(t){return t}var r=function(t){function e(){return n}var n=t;return{get:e,set:function(t){n=t},clone:function(){return r(e())}}},o=function(){};function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}}function u(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}}function c(){return s}var a,l=e(!1),f=e(!0),s=(a={fold:function(t,e){return t()},is:l,isSome:l,isNone:f,getOr:g,getOrThunk:m,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:e(null),getOrUndefined:e(void 0),or:g,orThunk:m,map:c,each:o,bind:c,exists:l,forall:f,filter:c,equals:d,equals_:d,toArray:function(){return[]},toString:e("none()")},Object.freeze&&Object.freeze(a),a);function d(t){return t.isNone()}function m(t){return t()}function g(t){return t}function p(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e}(e)===t}}function h(t,e){return-1<function(t,e){return Ut.call(t,e)}(t,e)}function v(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return!0;return!1}function b(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r}function w(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}function y(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r)&&n.push(i)}return n}function C(t,e,n){return function(t,e){for(var n=t.length-1;0<=n;n--)e(t[n],n)}(t,(function(t){n=e(n,t)})),n}function S(t,e,n){return w(t,(function(t){n=e(n,t)})),n}function x(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return Mt.some(o)}return Mt.none()}function R(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n))return Mt.some(n);return Mt.none()}function T(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!Lt(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);qt.apply(e,t[n])}return e}function O(t,e){return T(b(t,e))}function D(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n))return!1;return!0}function A(t){var e=Ft.call(t,0);return e.reverse(),e}function E(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return Mt.none()}function N(t,e){for(var n=Vt(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i)}}function k(t,e){return Yt(t,(function(t,n){return{k:n,v:e(t,n)}}))}function I(t,e){return Kt(t,e)?Mt.from(t[e]):Mt.none()}function B(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var o={};return w(t,(function(t,r){o[t]=e(n[r])})),o}}function P(t){return t.slice(0).sort()}function M(t,e){throw new Error("All required keys ("+P(t).join(", ")+") were not specified. Specified keys were: "+P(e).join(", ")+".")}function W(t){throw new Error("Unsupported keys for object: "+P(t).join(", "))}function _(t,e){if(!Lt(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");w(e,(function(e){if(!_t(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")}))}function L(t){var e=P(t);x(e,(function(t,n){return n<e.length-1&&t===e[n+1]})).each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")}))}function j(t){return t.dom().nodeType}function z(t){return function(e){return j(e)===t}}function H(t){return j(t)===$t||"#comment"===te(t)}function F(e,n,r){if(!(_t(r)||jt(r)||Ht(r)))throw t.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")}function U(t,e,n){F(t.dom(),e,n)}function q(t,e){var n=t.dom();N(e,(function(t,e){F(n,e,t)}))}function V(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n}function G(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)}function Y(t,e){t.dom().removeAttribute(e)}function K(t){return S(t.dom().attributes,(function(t,e){return t[e.name]=e.value,t}),{})}function X(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e}function $(t,e){return-1!==t.indexOf(e)}function J(t,e){return X(t,e,0)}function Q(t){return void 0!==t.style&&zt(t.style.getPropertyValue)}function Z(t){var e,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,e=t.apply(null,r)),e}}function tt(t){var e=ne(t)?t.dom().parentNode:t.dom();return void 0!==e&&null!==e&&e.ownerDocument.body.contains(e)}function et(e,n,r){if(!_t(r))throw t.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);Q(e)&&e.style.setProperty(n,r)}function nt(t,e,n){var r=t.dom();et(r,e,n)}function rt(t,e){var n=t.dom();N(e,(function(t,e){et(n,e,t)}))}function ot(e,n){var r=e.dom(),o=t.window.getComputedStyle(r).getPropertyValue(n),i=""!==o||tt(e)?o:ce(r,n);return null===i?void 0:i}function it(t,e){var n=t.dom(),r=ce(n,e);return Mt.from(r).filter((function(t){return 0<t.length}))}function ut(t,e){!function(t,e){Q(t)&&t.style.removeProperty(e)}(t.dom(),e),G(t,"style")&&""===function(t){return t.replace(/^\s+|\s+$/g,"")}(V(t,"style"))&&Y(t,"style")}function ct(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)}function at(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};function r(t){return Number(e.replace(n,"$"+t))}return se(r(1),r(2))}function lt(t,e){return function(){return e===t}}function ft(t,e){return function(){return e===t}}function st(t,e){var n=String(e).toLowerCase();return x(t,(function(t){return t.search(n)}))}function dt(t){return function(e){return $(e,t)}}function mt(){return Ee.get()}function gt(t,e){var n=t.dom();if(n.nodeType!==Ne)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function pt(t){return t.nodeType!==Ne&&t.nodeType!==ke||0===t.childElementCount}function ht(t){return oe.fromDom(t.dom().ownerDocument)}function vt(t){return Mt.from(t.dom().parentNode).map(oe.fromDom)}function bt(t,e){for(var n=zt(e)?e:l,r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=oe.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o}function wt(t){return Mt.from(t.dom().previousSibling).map(oe.fromDom)}function yt(t){return Mt.from(t.dom().nextSibling).map(oe.fromDom)}function Ct(t){return b(t.dom().childNodes,oe.fromDom)}function St(t,e){var n=t.dom().childNodes;return Mt.from(n[e]).map(oe.fromDom)}function xt(t,e){vt(t).each((function(n){n.dom().insertBefore(e.dom(),t.dom())}))}function Rt(t,e){yt(t).fold((function(){vt(t).each((function(t){Me(t,e)}))}),(function(t){xt(t,e)}))}function Tt(t,e){(function(t){return St(t,0)})(t).fold((function(){Me(t,e)}),(function(n){t.dom().insertBefore(e.dom(),n.dom())}))}function Ot(t,e){xt(t,e),Me(e,t)}function Dt(t,e){w(e,(function(n,r){var o=0===r?t:e[r-1];Rt(o,n)}))}function At(t,e){w(e,(function(e){Me(t,e)}))}function Et(t){t.dom().textContent="",w(Ct(t),(function(t){We(t)}))}function Nt(t){var e=Ct(t);0<e.length&&function(t,e){w(e,(function(e){xt(t,e)}))}(t,e),We(t)}function kt(t,e,n){return function(t,e,n){return y(bt(t,n),e)}(t,(function(t){return gt(t,e)}),n)}function It(t,e){return function(t,e){return y(Ct(t),e)}(t,(function(t){return gt(t,e)}))}function Bt(e,n){return function(e,n){var r=void 0===n?t.document:n.dom();return pt(r)?[]:b(r.querySelectorAll(e),oe.fromDom)}(n,e)}var Pt=function(t){function n(){return i}function r(e){return e(t)}var o=e(t),i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:f,isNone:l,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(e){return Pt(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:s},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(l,(function(e){return n(t,e)}))}};return i},Mt={some:Pt,none:c,from:function(t){return null===t||void 0===t?s:Pt(t)}},Wt=tinymce.util.Tools.resolve("tinymce.PluginManager"),_t=p("string"),Lt=p("array"),jt=p("boolean"),zt=p("function"),Ht=p("number"),Ft=Array.prototype.slice,Ut=Array.prototype.indexOf,qt=Array.prototype.push,Vt=(zt(Array.from)&&Array.from,Object.keys),Gt=Object.hasOwnProperty,Yt=function(t,e){var n={};return N(t,(function(t,r){var o=e(t,r);n[o.k]=o.v})),n},Kt=function(t,e){return Gt.call(t,e)},Xt=function(t,n){var r=t.concat(n);if(0===r.length)throw new Error("You must specify at least one required or optional field.");return _("required",t),_("optional",n),L(r),function(o){var i=Vt(o);D(t,(function(t){return h(i,t)}))||M(t,i);var u=y(i,(function(t){return!h(r,t)}));0<u.length&&W(u);var c={};return w(t,(function(t){c[t]=e(o[t])})),w(n,(function(t){c[t]=e(Object.prototype.hasOwnProperty.call(o,t)?Mt.some(o[t]):Mt.none())})),c}},$t=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),Jt=t.Node.DOCUMENT_NODE,Qt=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),Zt=t.Node.TEXT_NODE,te=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,"undefined"!=typeof t.window?t.window:Function("return this;")(),function(t){return t.dom().nodeName.toLowerCase()}),ee=z(Qt),ne=z(Zt),re=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:e(t)}},oe={fromHtml:function(e,n){var r=(n||t.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||1<r.childNodes.length)throw t.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return re(r.childNodes[0])},fromTag:function(e,n){var r=(n||t.document).createElement(e);return re(r)},fromText:function(e,n){var r=(n||t.document).createTextNode(e);return re(r)},fromDom:re,fromPoint:function(t,e,n){var r=t.dom();return Mt.from(r.elementFromPoint(e,n)).map(re)}},ie=Z((function(){return ue(oe.fromDom(t.document))})),ue=function(t){var e=t.dom().body;if(null===e||void 0===e)throw new Error("Body is not available yet");return oe.fromDom(e)},ce=function(t,e){return Q(t)?t.style.getPropertyValue(e):""},ae=function(e,n){return ct(e,n,t.Node.DOCUMENT_POSITION_CONTAINED_BY)},le=function(){return(le=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},fe=function(){return se(0,0)},se=function(t,e){return{major:t,minor:e}},de={nu:se,detect:function(t,e){var n=String(e).toLowerCase();return 0===t.length?fe():at(t,n)},unknown:fe},me="Firefox",ge=function(t){var e=t.current;return{current:e,version:t.version,isEdge:lt("Edge",e),isChrome:lt("Chrome",e),isIE:lt("IE",e),isOpera:lt("Opera",e),isFirefox:lt(me,e),isSafari:lt("Safari",e)}},pe={unknown:function(){return ge({current:void 0,version:de.unknown()})},nu:ge,edge:e("Edge"),chrome:e("Chrome"),ie:e("IE"),opera:e("Opera"),firefox:e(me),safari:e("Safari")},he="Windows",ve="Android",be="Solaris",we="FreeBSD",ye="ChromeOS",Ce=function(t){var e=t.current;return{current:e,version:t.version,isWindows:ft(he,e),isiOS:ft("iOS",e),isAndroid:ft(ve,e),isOSX:ft("OSX",e),isLinux:ft("Linux",e),isSolaris:ft(be,e),isFreeBSD:ft(we,e),isChromeOS:ft(ye,e)}},Se={unknown:function(){return Ce({current:void 0,version:de.unknown()})},nu:Ce,windows:e(he),ios:e("iOS"),android:e(ve),linux:e("Linux"),osx:e("OSX"),solaris:e(be),freebsd:e(we),chromeos:e(ye)},xe=function(t,e){return st(t,e).map((function(t){var n=de.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},Re=function(t,e){return st(t,e).map((function(t){var n=de.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},Te=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Oe=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return $(t,"edge/")&&$(t,"chrome")&&$(t,"safari")&&$(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Te],search:function(t){return $(t,"chrome")&&!$(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return $(t,"msie")||$(t,"trident")}},{name:"Opera",versionRegexes:[Te,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:dt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:dt("firefox")},{name:"Safari",versionRegexes:[Te,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return($(t,"safari")||$(t,"mobile/"))&&$(t,"applewebkit")}}],De=[{name:"Windows",search:dt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return $(t,"iphone")||$(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:dt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:dt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:dt("linux"),versionRegexes:[]},{name:"Solaris",search:dt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:dt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:dt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ae={browsers:e(Oe),oses:e(De)},Ee=r(function(t,n){var r=Ae.browsers(),o=Ae.oses(),i=xe(r,t).fold(pe.unknown,pe.nu),u=Re(o,t).fold(Se.unknown,Se.nu);return{browser:i,os:u,deviceType:function(t,n,r,o){var i=t.isiOS()&&!0===/ipad/i.test(r),u=t.isiOS()&&!i,c=t.isiOS()||t.isAndroid(),a=c||o("(pointer:coarse)"),l=i||!u&&c&&o("(min-device-width:768px)"),f=u||c&&!l,s=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(r),d=!f&&!l&&!s;return{isiPad:e(i),isiPhone:e(u),isTablet:e(l),isPhone:e(f),isTouch:e(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:e(s),isDesktop:e(d)}}(u,i,t,n)}}(t.navigator.userAgent,(function(e){return t.window.matchMedia(e).matches}))),Ne=Qt,ke=Jt,Ie=function(t,e){return t.dom()===e.dom()},Be=mt().browser.isIE()?function(t,e){return ae(t.dom(),e.dom())}:function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},Pe=gt,Me=(B("element","offset"),function(t,e){t.dom().appendChild(e.dom())}),We=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},_e=(B("width","height"),B("width","height"),B("rows","columns")),Le=B("row","column"),je=(B("x","y"),B("element","rowspan","colspan")),ze=B("element","rowspan","colspan","isNew"),He=B("element","rowspan","colspan","row","column"),Fe=B("element","cells","section"),Ue=B("element","isNew"),qe=B("element","cells","section","isNew"),Ve=B("cells","section"),Ge=B("details","section"),Ye=B("startRow","startCol","finishRow","finishCol"),Ke=function(t,e){var n=[];return w(Ct(t),(function(t){e(t)&&(n=n.concat([t])),n=n.concat(Ke(t,e))})),n};function Xe(t,e,n,r,o){return t(n,r)?Mt.some(n):zt(o)&&o(n)?Mt.none():e(n,r,o)}function $e(t,n,r){for(var o=t.dom(),i=zt(r)?r:e(!1);o.parentNode;){o=o.parentNode;var u=oe.fromDom(o);if(n(u))return Mt.some(u);if(i(u))break}return Mt.none()}function Je(t,e,n){return $e(t,(function(t){return gt(t,e)}),n)}function Qe(t,e){return function(t,e){return x(t.dom().childNodes,(function(t){return e(oe.fromDom(t))})).map(oe.fromDom)}(t,(function(t){return gt(t,e)}))}function Ze(e,n){return function(e,n){var r=void 0===n?t.document:n.dom();return pt(r)?Mt.none():Mt.from(r.querySelector(e)).map(oe.fromDom)}(n,e)}function tn(t,e,n){return Xe(gt,Je,t,e,n)}function en(t,e,n){return void 0===n&&(n=l),n(e)?Mt.none():h(t,te(e))?Mt.some(e):Je(e,t.join(","),(function(t){return gt(t,"table")||n(t)}))}function nn(t,e){return vt(e).map((function(e){return It(e,t)}))}function rn(t,e){return parseInt(V(t,e),10)}function on(t,e){return t+","+e}var un=function(t,e,n){return O(Ct(t),(function(t){return gt(t,e)?n(t)?[t]:[]:un(t,e,n)}))},cn={firstLayer:function(t,n){return un(t,n,e(!0))},filterFirstLayer:un},an=i(nn,"th,td"),ln=i(nn,"tr"),fn={cell:function(t,e){return en(["td","th"],t,e)},firstCell:function(t){return Ze(t,"th,td")},cells:function(t){return cn.firstLayer(t,"th,td")},neighbourCells:an,table:function(t,e){return tn(t,"table",e)},row:function(t,e){return en(["tr"],t,e)},rows:function(t){return cn.firstLayer(t,"tr")},notCell:function(t,e){return en(["caption","tr","tbody","tfoot","thead"],t,e)},neighbourRows:ln,attr:rn,grid:function(t,e,n){var r=rn(t,e),o=rn(t,n);return _e(r,o)}},sn=function(t){var e=fn.rows(t);return b(e,(function(t){var e=t,n=vt(e).map((function(t){var e=te(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"})).getOr("tbody"),r=b(fn.cells(t),(function(t){var e=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1,n=G(t,"colspan")?parseInt(V(t,"colspan"),10):1;return je(t,e,n)}));return Fe(e,r,n)}))},dn=function(t,e){return b(t,(function(t){var n=b(fn.cells(t),(function(t){var e=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1,n=G(t,"colspan")?parseInt(V(t,"colspan"),10):1;return je(t,e,n)}));return Fe(t,n,e.section())}))},mn=function(t,e){var n=O(t.all(),(function(t){return t.cells()}));return y(n,e)},gn={generate:function(t){var n={},r=[],o=t.length,i=0;w(t,(function(t,e){var o=[];w(t.cells(),(function(t){for(var r=0;void 0!==n[on(e,r)];)r++;for(var u=He(t.element(),t.rowspan(),t.colspan(),e,r),c=0;c<t.colspan();c++)for(var a=0;a<t.rowspan();a++){var l=r+c,f=on(e+a,l);n[f]=u,i=Math.max(i,l+1)}o.push(u)})),r.push(Fe(t.element(),o,t.section()))}));var u=_e(o,i);return{grid:e(u),access:e(n),all:e(r)}},getAt:function(t,e,n){var r=t.access()[on(e,n)];return void 0!==r?Mt.some(r):Mt.none()},findItem:function(t,e,n){var r=mn(t,(function(t){return n(e,t.element())}));return 0<r.length?Mt.some(r[0]):Mt.none()},filterItems:mn,justCells:function(t){var e=b(t.all(),(function(t){return t.cells()}));return T(e)}},pn=B("minRow","minCol","maxRow","maxCol"),hn=function(t,e){function n(t){return gt(t.element(),e)}var r=sn(t),o=gn.generate(r),i=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=n,i=0,u=0;return N(t.access(),(function(t){if(e(t)){var n=t.row(),c=n+t.rowspan()-1,a=t.column(),l=a+t.colspan()-1;n<r?r=n:i<c&&(i=c),a<o?o=a:u<l&&(u=l)}})),pn(r,o,i,u)}(o,n),u="th:not("+e+"),td:not("+e+")",c=cn.filterFirstLayer(t,"th,td",(function(t){return gt(t,u)}));return w(c,We),function(t,e,n,r){for(var o,i,u,c=e.grid().columns(),a=e.grid().rows(),l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<n.minRow()||l>n.maxRow()||s<n.minCol()||s>n.maxCol()||(gn.getAt(e,l,s).filter(r).isNone()?(o=f,i=t[l].element(),u=oe.fromTag("td"),Me(u,oe.fromTag("br")),(o?Me:Tt)(i,u)):f=!0)}(r,o,i,n),function(t,e){var n=y(cn.firstLayer(t,"tr"),(function(t){return 0===t.dom().childElementCount}));w(n,We),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||w(cn.firstLayer(t,"th,td"),(function(t){Y(t,"rowspan"),Y(t,"colspan")})),Y(t,"width"),Y(t,"height"),ut(t,"width"),ut(t,"height")}(t,i),t};function vn(t){return Pn.get(t)}function bn(t){return Pn.getOption(t)}function wn(t,e){Pn.set(t,e)}function yn(t){return"img"===te(t)?1:bn(t).fold((function(){return Ct(t).length}),(function(t){return t.length}))}function Cn(t){return function(t){return bn(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf("\xa0")})).isSome()}(t)||h(Mn,te(t))}function Sn(t){return function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){var o=oe.fromDom(t.childNodes[r]);if(e(o))return Mt.some(o);var i=n(t.childNodes[r]);if(i.isSome())return i}return Mt.none()};return n(t.dom())}(t,Cn)}function xn(t){return Wn(t,Cn)}function Rn(t,e){return oe.fromDom(t.dom().cloneNode(e))}function Tn(t){return Rn(t,!1)}function On(t){return Rn(t,!0)}function Dn(t,e){var n=function(t,e){var n=oe.fromTag(e),r=K(t);return q(n,r),n}(t,e),r=Ct(On(t));return At(n,r),n}function An(){var t=oe.fromTag("td");return Me(t,oe.fromTag("br")),t}function En(t,e,n){var r=Dn(t,e);return N(n,(function(t,e){null===t?Y(r,e):U(r,e,t)})),r}function Nn(t){return t}function kn(t){return function(){return oe.fromTag("tr",t.dom())}}function In(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()}function Bn(t,e,n){var r=gn.findItem(t,e,Ie),o=gn.findItem(t,n,Ie);return r.bind((function(t){return o.map((function(e){return function(t,e){return Ye(Math.min(t.row(),e.row()),Math.min(t.column(),e.column()),Math.max(t.row()+t.rowspan()-1,e.row()+e.rowspan()-1),Math.max(t.column()+t.colspan()-1,e.column()+e.colspan()-1))}(t,e)}))}))}var Pn=function(t,e){var n=function(e){return t(e)?Mt.from(e.dom().nodeValue):Mt.none()};return{get:function(r){if(!t(r))throw new Error("Can only get "+e+" value of a "+e+" node");return n(r).getOr("")},getOption:n,set:function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r}}}(ne,"text"),Mn=["img","br"],Wn=function(t,e){var n=function(t){for(var r=Ct(t),o=r.length-1;0<=o;o--){var i=r[o];if(e(i))return Mt.some(i);var u=n(i);if(u.isSome())return u}return Mt.none()};return n(t)},_n={cellOperations:function(t,e,n){return{row:kn(e),cell:function(e){var r=ht(e.element()),o=oe.fromTag(te(e.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=0<i.length?function(t,e,n){return Sn(t).map((function(r){var o=n.join(","),i=kt(r,o,(function(e){return Ie(e,t)}));return C(i,(function(t,e){var n=Tn(e);return Y(n,"contenteditable"),Me(t,n),n}),e)})).getOr(e)}(e.element(),o,i):o;return Me(u,oe.fromTag("br")),function(t,e){var n=t.dom(),r=e.dom();Q(n)&&Q(r)&&(r.style.cssText=n.style.cssText)}(e.element(),o),ut(o,"height"),1!==e.colspan()&&ut(e.element(),"width"),t(e.element(),o),o},replace:En,gap:An}},paste:function(t){return{row:kn(t),cell:An,replace:Nn,gap:An}}},Ln=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},jn=function(t,e){for(var n=!0,r=i(In,e),o=e.startRow();o<=e.finishRow();o++)for(var u=e.startCol();u<=e.finishCol();u++)n=n&&gn.getAt(t,o,u).exists(r);return n?Mt.some(e):Mt.none()},zn=Bn,Hn=function(t,e,n){return Bn(t,e,n).bind((function(e){return jn(t,e)}))},Fn=function(t,e,n,r){return gn.findItem(t,e,Ie).bind((function(e){var o=0<n?e.row()+e.rowspan()-1:e.row(),i=0<r?e.column()+e.colspan()-1:e.column();return gn.getAt(t,o+n,i+r).map((function(t){return t.element()}))}))},Un=function(t,e,n){return zn(t,e,n).map((function(e){var n=gn.filterItems(t,i(Ln,e));return b(n,(function(t){return t.element()}))}))},qn=function(t,e){return gn.findItem(t,e,(function(t,e){return Be(e,t)})).map((function(t){return t.element()}))},Vn=function(t){var e=sn(t);return gn.generate(e)},Gn=function(t,e,n){return fn.table(t).bind((function(r){var o=Vn(r);return Fn(o,t,e,n)}))},Yn=function(t,e,n){var r=Vn(t);return Un(r,e,n)},Kn=function(t,e,n,r,o){var i=Vn(t),u=Ie(t,n)?Mt.some(e):qn(i,e),c=Ie(t,o)?Mt.some(r):qn(i,r);return u.bind((function(t){return c.bind((function(e){return Un(i,t,e)}))}))},Xn=function(t,e,n){var r=Vn(t);return Hn(r,e,n)},$n=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Jn(){return{up:e({selector:Je,closest:tn,predicate:$e,all:bt}),down:e({selector:Bt,predicate:Ke}),styles:e({get:ot,getRaw:it,set:nt,remove:ut}),attrs:e({get:V,set:U,remove:Y,copyTo:function(t,e){var n=K(t);q(e,n)}}),insert:e({before:xt,after:Rt,afterAll:Dt,append:Me,appendAll:At,prepend:Tt,wrap:Ot}),remove:e({unwrap:Nt,remove:We}),create:e({nu:oe.fromTag,clone:function(t){return oe.fromDom(t.dom().cloneNode(!1))},text:oe.fromText}),query:e({comparePosition:function(t,e){return t.dom().compareDocumentPosition(e.dom())},prevSibling:wt,nextSibling:yt}),property:e({children:Ct,name:te,parent:vt,document:function(t){return t.dom().ownerDocument},isText:ne,isComment:H,isElement:ee,getText:vn,setText:wn,isBoundary:function(t){return!!ee(t)&&("body"===te(t)||h($n,te(t)))},isEmptyTag:function(t){return!!ee(t)&&h(["br","img","hr","input"],te(t))},isNonEditable:function(t){return ee(t)&&"false"===V(t,"contenteditable")}}),eq:Ie,is:Pe}}function Qn(t,n,r){var o=t.property().children(n);return R(o,i(t.eq,r)).map((function(t){return{before:e(o.slice(0,t)),after:e(o.slice(t+1))}}))}function Zn(t,e){return i(t.eq,e)}function tr(t,n,r,o){function i(t){return R(t,o).fold((function(){return t}),(function(e){return t.slice(0,e+1)}))}void 0===o&&(o=l);var u=[n].concat(t.up().all(n)),c=[r].concat(t.up().all(r)),a=i(u),f=i(c),s=x(a,(function(e){return v(f,Zn(t,e))}));return{firstpath:e(a),secondpath:e(f),shared:e(s)}}function er(t){return Je(t,"table")}function nr(t,e,n){function r(t){return function(e){return void 0!==n&&n(e)||Ie(e,t)}}return Ie(t,e)?Mt.some(dr.create({boxes:Mt.some([t]),start:t,finish:e})):er(t).bind((function(o){return er(e).bind((function(i){if(Ie(o,i))return Mt.some(dr.create({boxes:Yn(o,t,e),start:t,finish:e}));if(Be(o,i)){var u=0<(c=kt(e,"td,th",r(o))).length?c[c.length-1]:e;return Mt.some(dr.create({boxes:Kn(o,t,o,e,i),start:t,finish:u}))}if(Be(i,o)){var c,a=0<(c=kt(t,"td,th",r(i))).length?c[c.length-1]:t;return Mt.some(dr.create({boxes:Kn(i,t,o,e,i),start:t,finish:a}))}return sr.ancestors(t,e).shared().bind((function(u){return tn(u,"table",n).bind((function(n){var u=kt(e,"td,th",r(n)),c=0<u.length?u[u.length-1]:e,a=kt(t,"td,th",r(n)),l=0<a.length?a[a.length-1]:t;return Mt.some(dr.create({boxes:Kn(n,t,o,e,i),start:l,finish:c}))}))}))}))}))}function rr(t,r){return Tr.cata(r.get(),e([]),n,e([t]))}function or(t){return{element:e(t),mergable:Mt.none,unmergable:Mt.none,selection:e([t])}}var ir=B("left","right"),ur=B("first","second","splits"),cr=function(t,e,n,r){var o=e(t,n);return C(r,(function(n,r){var o=e(t,r);return ar(t,n,o)}),o)},ar=function(t,e,n){return e.bind((function(e){return n.filter(i(t.eq,e))}))},lr={sharedOne:function(t,e,n){return 0<n.length?function(t,e,n,r){return r(t,e,n[0],n.slice(1))}(t,e,n,cr):Mt.none()},subset:function(t,e,n){var r=tr(t,e,n);return r.shared().bind((function(e){return function(t,e,n,r){var o=t.property().children(e);if(t.eq(e,n[0]))return Mt.some([n[0]]);if(t.eq(e,r[0]))return Mt.some([r[0]]);function i(n){var r=A(n),i=R(r,Zn(t,e)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return R(o,Zn(t,u))}var u=i(n),c=i(r);return u.bind((function(t){return c.map((function(e){var n=Math.min(t,e),r=Math.max(t,e);return o.slice(n,r+1)}))}))}(t,e,r.firstpath(),r.secondpath())}))},ancestors:tr,breakToLeft:function(t,e,n){return Qn(t,e,n).map((function(r){var o=t.create().clone(e);return t.insert().appendAll(o,r.before().concat([n])),t.insert().appendAll(e,r.after()),t.insert().before(e,o),ir(o,e)}))},breakToRight:function(t,e,n){return Qn(t,e,n).map((function(n){var r=t.create().clone(e);return t.insert().appendAll(r,n.after()),t.insert().after(e,r),ir(e,r)}))},breakPath:function(t,e,n,r){var o=function(e,i,u){var c=ur(e,Mt.none(),u);return n(e)?ur(e,i,u):t.property().parent(e).bind((function(i){return r(t,i,e).map((function(t){var e=[{first:t.left,second:t.right}],r=n(i)?i:t.left();return o(r,Mt.some(t.right()),u.concat(e))}))})).getOr(c)};return o(e,Mt.none(),[])}},fr=Jn(),sr={sharedOne:function(t,e){return lr.sharedOne(fr,(function(e,n){return t(n)}),e)},subset:function(t,e){return lr.subset(fr,t,e)},ancestors:function(t,e,n){return lr.ancestors(fr,t,e,n)},breakToLeft:function(t,e){return lr.breakToLeft(fr,t,e)},breakToRight:function(t,e){return lr.breakToRight(fr,t,e)},breakPath:function(t,e,n){return lr.breakPath(fr,t,e,(function(t,e,r){return n(e,r)}))}},dr={create:Xt(["boxes","start","finish"],[])},mr=nr,gr=function(t,e){var n=Bt(t,e);return 0<n.length?Mt.some(n):Mt.none()},pr=function(t,n,r,o,i){return function(t,e){return x(t,(function(t){return gt(t,e)}))}(t,i).bind((function(t){return Gn(t,n,r).bind((function(t){return function(t,n){return Je(t,"table").bind((function(r){return Ze(r,n).bind((function(n){return nr(n,t).bind((function(t){return t.boxes().map((function(n){return{boxes:e(n),start:e(t.start()),finish:e(t.finish())}}))}))}))}))}(t,o)}))}))},hr=function(t,n,r){return Ze(t,n).bind((function(n){return Ze(t,r).bind((function(t){return sr.sharedOne(er,[n,t]).map((function(r){return{first:e(n),last:e(t),table:e(r)}}))}))}))},vr=function(t,e){return gr(t,e)},br=function(t,e,n){return hr(t,e,n).bind((function(e){function n(e){return Ie(t,e)}var r=Je(e.first(),"thead,tfoot,tbody,table",n),o=Je(e.last(),"thead,tfoot,tbody,table",n);return r.bind((function(t){return o.bind((function(n){return Ie(t,n)?Xn(e.table(),e.first(),e.last()):Mt.none()}))}))}))},wr="data-mce-selected",yr="data-mce-first-selected",Cr="data-mce-last-selected",Sr={selected:e(wr),selectedSelector:e("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:e("[data-mce-selected]"),firstSelected:e(yr),firstSelectedSelector:e("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:e(Cr),lastSelectedSelector:e("td[data-mce-last-selected],th[data-mce-last-selected]")},xr=function(e){if(!Lt(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],r={};return w(e,(function(o,i){var u=Vt(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!Lt(a))throw new Error("case arguments must be an array");n.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var e=Vt(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!D(n,(function(t){return h(e,t)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[c].apply(null,o)},log:function(e){t.console.log(e,{constructors:n,constructor:c,params:o})}}}})),r},Rr=xr([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Tr={cata:function(t,e,n,r){return t.fold(e,n,r)},none:Rr.none,multiple:Rr.multiple,single:Rr.single},Or=function(t,n){return Tr.cata(n.get(),Mt.none,(function(n,r){return 0===n.length?Mt.none():br(t,Sr.firstSelectedSelector(),Sr.lastSelectedSelector()).bind((function(t){return 1<n.length?Mt.some({bounds:e(t),cells:e(n)}):Mt.none()}))}),Mt.none)},Dr=function(t,e){var n=rr(t,e);return 0<n.length&&D(n,(function(t){return G(t,"rowspan")&&1<parseInt(V(t,"rowspan"),10)||G(t,"colspan")&&1<parseInt(V(t,"colspan"),10)}))?Mt.some(n):Mt.none()},Ar=rr,Er=B("element","clipboard","generators"),Nr={noMenu:or,forMenu:function(t,n,r){return{element:e(r),mergable:e(Or(n,t)),unmergable:e(Dr(r,t)),selection:e(Ar(r,t))}},notCell:function(t){return or(t)},paste:Er,pasteRows:function(t,n,r,o,i){return{element:e(r),mergable:Mt.none,unmergable:Mt.none,selection:e(Ar(r,t)),clipboard:e(o),generators:e(i)}}},kr={registerEvents:function(e,n,r,i){e.on("BeforeGetContent",(function(t){!0===t.selection&&Tr.cata(n.get(),o,(function(n){t.preventDefault(),function(t){return fn.table(t[0]).map(On).map((function(t){return[hn(t,Sr.attributeSelector())]}))}(n).each((function(n){t.content="text"===t.format?function(t){return b(t,(function(t){return t.dom().innerText})).join("")}(n):function(t,e){return b(e,(function(e){return t.selection.serializer.serialize(e.dom(),{})})).join("")}(e,n)}))}),o)})),e.on("BeforeSetContent",(function(n){!0===n.selection&&!0===n.paste&&Mt.from(e.dom.getParent(e.selection.getStart(),"th,td")).each((function(o){var u=oe.fromDom(o);fn.table(u).each((function(o){var c=y(function(e,n){var r=(n||t.document).createElement("div");return r.innerHTML=e,Ct(oe.fromDom(r))}(n.content),(function(t){return"meta"!==te(t)}));if(1===c.length&&"table"===te(c[0])){n.preventDefault();var a=oe.fromDom(e.getDoc()),l=_n.paste(a),f=Nr.paste(u,c[0],l);r.pasteCells(o,f).each((function(t){e.selection.setRng(t),e.focus(),i.clear(o)}))}}))}))}))}};function Ir(t,e){function n(n){var r=e(n);if(r<=0||null===r){var o=ot(n,t);return parseFloat(o)||0}return r}function r(t,e){return S(e,(function(e,n){var r=ot(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o}),0)}return{set:function(e,n){if(!Ht(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom();Q(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var o=r(t,n);return o<e?e-o:0}}}function Br(t){return Zr.get(t)}function Pr(t){return Zr.getOuter(t)}function Mr(t){return to.get(t)}function Wr(t){return to.getOuter(t)}function _r(t,e,n){return function(t,e){var n=parseFloat(t);return isNaN(n)?e:n}(ot(t,e),n)}function Lr(t,e){nt(t,"height",e+"px")}function jr(t,e,n,r){var o=parseInt(t,10);return function(t,e){return X(t,e,t.length-e.length)}(t,"%")&&"table"!==te(e)?function(t,e,n,r){var o=fn.table(t).map((function(t){var r=n(t);return Math.floor(e/100*r)})).getOr(e);return r(t,o),o}(e,o,n,r):o}function zr(t){var e=function(t){return it(t,"height").getOrThunk((function(){return no(t)+"px"}))}(t);return e?jr(e,t,Br,Lr):Br(t)}function Hr(t){return it(t,"width").fold((function(){return Mt.from(V(t,"width"))}),(function(t){return Mt.some(t)}))}function Fr(t,e){return t/e.pixelWidth()*100}function Ur(t,e){return void 0!==t?t:void 0!==e?e:0}function qr(t){var e=t.dom().ownerDocument,n=e.body,r=e.defaultView,o=e.documentElement;if(n===t.dom())return fo(n.offsetLeft,n.offsetTop);var i=Ur(r.pageYOffset,o.scrollTop),u=Ur(r.pageXOffset,o.scrollLeft),c=Ur(o.clientTop,n.clientTop),a=Ur(o.clientLeft,n.clientLeft);return so(t).translate(u-a,i-c)}function Vr(t){return qr(t).left()+Wr(t)}function Gr(t){return qr(t).left()}function Yr(t,e){return go(t,Gr(e))}function Kr(t,e){return go(t,Vr(e))}function Xr(t){return qr(t).top()}function $r(t,e){return mo(t,Xr(e))}function Jr(t,e){return mo(t,Xr(e)+Pr(e))}function Qr(t,e,n){if(0===n.length)return[];var r=b(n.slice(1),(function(e,n){return e.map((function(e){return t(n,e)}))})),o=n[n.length-1].map((function(t){return e(n.length-1,t)}));return r.concat([o])}var Zr=Ir("height",(function(t){var e=t.dom();return tt(t)?e.getBoundingClientRect().height:e.offsetHeight})),to=Ir("width",(function(t){return t.dom().offsetWidth})),eo=mt(),no=function(t){return eo.browser.isIE()||eo.browser.isEdge()?function(t){var e=_r(t,"padding-top",0),n=_r(t,"padding-bottom",0),r=_r(t,"border-top-width",0),o=_r(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===ot(t,"box-sizing")?i:i-e-n-(r+o)}(t):_r(t,"height",Br(t))},ro=/(\d+(\.\d+)?)(\w|%)*/,oo=/(\d+(\.\d+)?)%/,io=/(\d+(\.\d+)?)px|em/,uo=function(t,e){return G(t,e)?parseInt(V(t,e),10):1},co={percentageBasedSizeRegex:e(oo),pixelBasedSizeRegex:e(io),setPixelWidth:function(t,e){nt(t,"width",e+"px")},setPercentageWidth:function(t,e){nt(t,"width",e+"%")},setHeight:Lr,getPixelWidth:function(t,e){return Hr(t).fold((function(){return Mr(t)}),(function(n){return function(t,e,n){var r=io.exec(e);if(null!==r)return parseInt(r[1],10);var o=oo.exec(e);return null===o?Mr(t):function(t,e){return t/100*e.pixelWidth()}(parseFloat(o[1]),n)}(t,n,e)}))},getPercentageWidth:function(t,e){return Hr(t).fold((function(){var n=Mr(t);return Fr(n,e)}),(function(n){return function(t,e,n){var r=oo.exec(e);if(null!==r)return parseFloat(r[1]);var o=Mr(t);return Fr(o,n)}(t,n,e)}))},getGenericWidth:function(t){return Hr(t).bind((function(t){var n=ro.exec(t);return null!==n?Mt.some({width:e(parseFloat(n[1])),unit:e(n[3])}):Mt.none()}))},setGenericWidth:function(t,e,n){nt(t,"width",e+n)},getHeight:function(t){return function(t,e,n){return n(t)/uo(t,e)}(t,"rowspan",zr)},getRawWidth:Hr},ao=function(t,e){co.getGenericWidth(t).each((function(n){var r=n.width()/2;co.setGenericWidth(t,r,n.unit()),co.setGenericWidth(e,r,n.unit())}))},lo=function(t,n){return{left:e(t),top:e(n),translate:function(e,r){return lo(t+e,n+r)}}},fo=lo,so=function(t){var e=t.dom(),n=e.ownerDocument.body;return n===e?fo(n.offsetLeft,n.offsetTop):tt(t)?function(t){var e=t.getBoundingClientRect();return fo(e.left,e.top)}(e):fo(0,0)},mo=B("row","y"),go=B("col","x"),po={height:{delta:n,positions:function(t){return Qr($r,Jr,t)},edge:Xr},rtl:{delta:function(t){return-t},edge:Vr,positions:function(t){return Qr(Kr,Yr,t)}},ltr:{delta:n,edge:Gr,positions:function(t){return Qr(Yr,Kr,t)}}},ho={ltr:po.ltr,rtl:po.rtl};function vo(t){function e(e){return t(e).isRtl()?ho.rtl:ho.ltr}return{delta:function(t,n){return e(n).delta(t,n)},edge:function(t){return e(t).edge(t)},positions:function(t,n){return e(n).positions(t,n)}}}function bo(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e}function wo(t,e,n,r){n===r?Y(t,e):U(t,e,n)}function yo(t,e){var n=V(t,e);return void 0===n||""===n?[]:n.split(" ")}function Co(t){return void 0!==t.dom().classList}function So(t,e){return function(t,e,n){var r=yo(t,e).concat([n]);return U(t,e,r.join(" ")),!0}(t,"class",e)}function xo(t,e){return function(t,e,n){var r=y(yo(t,e),(function(t){return t!==n}));return 0<r.length?U(t,e,r.join(" ")):Y(t,e),!1}(t,"class",e)}function Ro(t,e){Co(t)?t.dom().classList.add(e):So(t,e)}function To(t){0===(Co(t)?t.dom().classList:function(t){return yo(t,"class")}(t)).length&&Y(t,"class")}function Oo(t,e){return Co(t)&&t.dom().classList.contains(e)}function Do(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n}function Ao(t,e){if(e<0||e>=t.length-1)return Mt.none();var n=t[e].fold((function(){var n=A(t.slice(0,e));return E(n,(function(t,e){return t.map((function(t){return{value:t,delta:e+1}}))}))}),(function(t){return Mt.some({value:t,delta:0})})),r=t[e+1].fold((function(){var n=t.slice(e+1);return E(n,(function(t,e){return t.map((function(t){return{value:t,delta:e+1}}))}))}),(function(t){return Mt.some({value:t,delta:1})}));return n.bind((function(t){return r.map((function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n}))}))}function Eo(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}}function No(t){var e=Bt(t.parent(),"."+iu);w(e,We)}function ko(t,e,n){var r=t.origin();w(e,(function(e,o){e.each((function(e){var o=n(r,e);Ro(o,iu),Me(t.parent(),o)}))}))}function Io(t,e,n,r,o,i){var u=qr(e);!function(t,e,n,r){ko(t,e,(function(t,e){var o=ou(e.row(),n.left()-t.left(),e.y()-t.top(),r,7);return Ro(o,uu),o}))}(t,0<n.length?o.positions(n,e):[],u,Wr(e)),function(t,e,n,r){ko(t,e,(function(t,e){var o=ru(e.col(),e.x()-t.left(),n.top()-t.top(),7,r);return Ro(o,cu),o}))}(t,0<r.length?i.positions(r,e):[],u,Pr(e))}function Bo(t,e){var n=Bt(t.parent(),"."+iu);w(n,e)}function Po(t,e){return t.cells()[e]}function Mo(t,e){if(0===t.length)return 0;var n=t[0];return R(t,(function(t){return!e(n.element(),t.element())})).fold((function(){return t.length}),(function(t){return t}))}function Wo(t,e){return b(t,(function(t){var n=function(t){return E(t,(function(t){return vt(t.element()).map((function(t){var e=vt(t).isNone();return Ue(t,e)}))})).getOrThunk((function(){return Ue(e.row(),!0)}))}(t.details());return qe(n.element(),t.details(),t.section(),n.isNew())}))}function _o(t,e){var n=vu(t,Ie);return Wo(n,e)}function Lo(t,e){var n=T(b(t.all(),(function(t){return t.cells()})));return x(n,(function(t){return Ie(e,t.element())}))}function jo(t,n,r,o,i){return function(u,c,a,l,f){var s=sn(c),d=gn.generate(s);return n(d,a).map((function(n){var r=function(t,e){return bu(t,e,!1)}(d,l),o=t(r,n,Ie,i(l)),u=_o(o.grid(),l);return{grid:e(u),cursor:o.cursor}})).fold((function(){return Mt.none()}),(function(t){var e=Ji(c,t.grid());return r(c,t.grid(),f),o(c),au(u,c,po.height,f),Mt.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})}))}}function zo(t,e){return fn.cell(e.element()).bind((function(e){return Lo(t,e)}))}function Ho(t,e){var n=b(e.selection(),(function(e){return fn.cell(e).bind((function(e){return Lo(t,e)}))})),r=bo(n);return 0<r.length?Mt.some({cells:r,generators:e.generators,clipboard:e.clipboard}):Mt.none()}function Fo(t,e){var n=b(e.selection(),(function(e){return fn.cell(e).bind((function(e){return Lo(t,e)}))})),r=bo(n);return 0<r.length?Mt.some(r):Mt.none()}function Uo(t,e){return b(t,(function(){return Ue(e.cell(),!0)}))}function qo(t,e,n){return t.concat(function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n}(e,(function(e){return pu.setCells(t[t.length-1],Uo(t[t.length-1].cells(),n))})))}function Vo(t,e,n){return b(t,(function(t){return pu.setCells(t,t.cells().concat(Uo(Do(0,e),n)))}))}function Go(t,e,n,r){return b(t,(function(t){return pu.mapCells(t,(function(t){return function(t){return v(e,(function(e){return n(t.element(),e.element())}))}(t)?Ue(r(t.element(),n),!0):t}))}))}function Yo(t,e,n,r){return void 0!==pu.getCellElement(t[e],n)&&0<e&&r(pu.getCellElement(t[e-1],n),pu.getCellElement(t[e],n))}function Ko(t,e,n){return 0<e&&n(pu.getCellElement(t,e-1),pu.getCellElement(t,e))}function Xo(t,e){return G(t,e)&&1<parseInt(V(t,e),10)}function $o(t,e,n){return it(t,e).fold((function(){return n(t)+"px"}),(function(t){return t}))}function Jo(t,e){return $o(t,"width",(function(t){return co.getPixelWidth(t,e)}))}function Qo(t){return $o(t,"height",co.getHeight)}function Zo(t,e,n,r,o){var i=tu(t),c=b(i,(function(t){return t.map(e.edge)}));return b(i,(function(t,e){return t.filter(u(Hu.hasColspan)).fold((function(){var t=Ao(c,e);return r(t)}),(function(t){return n(t,o)}))}))}function ti(t){return t.map((function(t){return t+"px"})).getOr("")}function ei(t,e,n,r){var o=eu(t),i=b(o,(function(t){return t.map(e.edge)}));return b(o,(function(t,e){return t.filter(u(Hu.hasRowspan)).fold((function(){var t=Ao(i,e);return r(t)}),(function(t){return n(t)}))}))}function ni(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r}function ri(t){var r=n;return{width:e(t),pixelWidth:e(t),getWidths:Fu.getPixelWidths,getCellDelta:r,singleColumnWidth:function(t,e){return[Math.max(Hu.minWidth(),t+e)-t]},minCellWidth:Hu.minWidth,setElementWidth:co.setPixelWidth,setTableWidth:function(t,e,n){var r=C(e,(function(t,e){return t+e}),0);co.setPixelWidth(t,r)}}}function oi(t,n){var r=co.percentageBasedSizeRegex().exec(n);if(null!==r)return function(t,n){var r=parseFloat(t),o=Mr(n);return{width:e(r),pixelWidth:e(o),getWidths:Fu.getPercentageWidths,getCellDelta:function(t){return t/o*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return Hu.minWidth()/o*100},setElementWidth:co.setPercentageWidth,setTableWidth:function(t,e,n){var o=n/100*r;co.setPercentageWidth(t,r+o)}}}(r[1],t);var o=co.pixelBasedSizeRegex().exec(n);if(null!==o){var i=parseInt(o[1],10);return ri(i)}var u=Mr(t);return ri(u)}function ii(t){return gn.generate(t)}function ui(t){var e=sn(t);return ii(e)}function ci(t,e){var n=y(e,(function(e){return!h(t,e)}));0<n.length&&W(n)}function ai(t){return function(t,e){return $u(t,e,{validate:zt,label:"function"})}(ci,t)}function li(t){var n=G(t,"colspan")?parseInt(V(t,"colspan"),10):1,r=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1;return{element:e(t),colspan:e(n),rowspan:e(r)}}function fi(t,e){var n=t.property().name(e);return h(ec,n)}function si(t,e){return h(["br","img","hr","input"],t.property().name(e))}function di(t){0===fn.cells(t).length&&We(t)}function mi(t,e,n){return sc(t,e,n).orThunk((function(){return sc(t,0,0)}))}function gi(t,e,n){return fc(t,sc(t,e,n))}function pi(t){return S(t,(function(t,e){return v(t,(function(t){return t.row()===e.row()}))?t:t.concat([e])}),[]).sort((function(t,e){return t.row()-e.row()}))}function hi(t){return S(t,(function(t,e){return v(t,(function(t){return t.column()===e.column()}))?t:t.concat([e])}),[]).sort((function(t,e){return t.column()-e.column()}))}function vi(t,e,n){var r=dn(t,n),o=gn.generate(r);return bu(o,e,!0)}function bi(t){return t.getBoundingClientRect().width}function wi(t){return t.getBoundingClientRect().height}function yi(t){return/^[0-9]+$/.test(t)&&(t+="px"),t}function Ci(t){var e=Bt(t,"td[data-mce-style],th[data-mce-style]");Y(t,"data-mce-style"),w(e,(function(t){Y(t,"data-mce-style")}))}function Si(t){return t.getParam("table_default_attributes",yc,"object")}function xi(t){return t.getParam("table_default_styles",wc,"object")}function Ri(t){return t.getParam("table_cell_advtab",!0,"boolean")}function Ti(t){return t.getParam("table_row_advtab",!0,"boolean")}function Oi(t){return t.getParam("table_advtab",!0,"boolean")}function Di(t){return t.getParam("table_style_by_css",!1,"boolean")}function Ai(t){return t.getParam("table_class_list",[],"array")}function Ei(t){return!1===t.getParam("table_responsive_width")}function Ni(t,e){return t.fire("newrow",{node:e})}function ki(t,e){return t.fire("newcell",{node:e})}function Ii(t,e,n,r){t.fire("ObjectResizeStart",{target:e,width:n,height:r})}function Bi(t,e,n,r){t.fire("ObjectResized",{target:e,width:n,height:r})}function Pi(t,e){return t.property().isText(e)?t.property().getText(e).length:t.property().children(e).length}function Mi(t,e){function n(e){return J(e,"rgb")?t.toHex(e):e}return{borderwidth:it(oe.fromDom(e),"border-width").getOr(""),borderstyle:it(oe.fromDom(e),"border-style").getOr(""),bordercolor:it(oe.fromDom(e),"border-color").map(n).getOr(""),backgroundcolor:it(oe.fromDom(e),"background-color").map(n).getOr("")}}function Wi(t,e,n,r,o){var i={};return Ic.each(t.split(" "),(function(t){r.formatter.matchNode(o,e+t)&&(i[n]=t)})),i[n]||(i[n]=""),i}function _i(t,e){t.setAttrib("scope",e.scope),t.setAttrib("class",e["class"]),t.setStyle("width",yi(e.width)),t.setStyle("height",yi(e.height))}function Li(t,e){t.setStyle("background-color",e.backgroundcolor),t.setStyle("border-color",e.bordercolor),t.setStyle("border-style",e.borderstyle),t.setStyle("border-width",yi(e.borderwidth))}function ji(t,e,n){var r=t.dom,o=n.celltype&&e[0].nodeName.toLowerCase()!==n.celltype?r.rename(e[0],n.celltype):e[0],i=Xc.normal(r,o);_i(i,n),Ri(t)&&Li(i,n),Mc(t,o),Wc(t,o),n.halign&&Bc(t,o,n.halign),n.valign&&Pc(t,o,n.valign)}function zi(t,e,n){var r=t.dom;Ic.each(e,(function(e){n.celltype&&e.nodeName.toLowerCase()!==n.celltype&&(e=r.rename(e,n.celltype));var o=Xc.ifTruthy(r,e);_i(o,n),Ri(t)&&Li(o,n),n.halign&&Bc(t,e,n.halign),n.valign&&Pc(t,e,n.valign)}))}function Hi(t,e,n){var r=n.getData();n.close(),t.undoManager.transact((function(){(1===e.length?ji:zi)(t,e,r),t.focus()}))}function Fi(t,e,n,r){var o=t.dom,i=r.getData();r.close();var u=1===e.length?Xc.normal:Xc.ifTruthy;t.undoManager.transact((function(){Ic.each(e,(function(e){i.type!==e.parentNode.nodeName.toLowerCase()&&function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),"tbody"===n&&"THEAD"===o.nodeName&&i.firstChild?i.insertBefore(e,i.firstChild):i.appendChild(e),o.hasChildNodes()||t.remove(o)}(t.dom,e,i.type);var r=u(o,e);r.setAttrib("scope",i.scope),r.setAttrib("class",i["class"]),r.setStyle("height",yi(i.height)),Ti(t)&&function(t,e){t.setStyle("background-color",e.backgroundcolor),t.setStyle("border-color",e.bordercolor),t.setStyle("border-style",e.borderstyle)}(r,i),i.align!==n.align&&(Mc(t,e),Bc(t,e,i.align))})),t.focus()}))}function Ui(t,e,n,r,o){void 0===o&&(o=ea);var i=oe.fromTag("table");rt(i,o.styles),q(i,o.attributes);var u=oe.fromTag("tbody");Me(i,u);for(var c=[],a=0;a<t;a++){for(var l=oe.fromTag("tr"),f=0;f<e;f++){var s=a<n||f<r?oe.fromTag("th"):oe.fromTag("td");f<r&&U(s,"scope","row"),a<n&&U(s,"scope","col"),Me(s,oe.fromTag("br")),o.percentages&&nt(s,"width",100/e+"%"),Me(l,s)}c.push(l)}return At(u,c),i}function qi(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)}function Vi(t,e,n){var r,o=t.dom,i=n.getData();n.close(),""===i["class"]&&delete i["class"],t.undoManager.transact((function(){if(!e){var n=parseInt(i.cols,10)||1,u=parseInt(i.rows,10)||1;e=na(t,n,u)}!function(t,e,n){var r=t.dom,o={},i={};if(o["class"]=n["class"],i.height=yi(n.height),r.getAttrib(e,"width")&&!Di(t)?o.width=function(t){return t?t.replace(/px$/,""):""}(n.width):i.width=yi(n.width),Di(t)?(i["border-width"]=yi(n.border),i["border-spacing"]=yi(n.cellspacing)):(o.border=n.border,o.cellpadding=n.cellpadding,o.cellspacing=n.cellspacing),Di(t)&&e.children)for(var u=0;u<e.children.length;u++)oa(r,e.children[u],{"border-width":yi(n.border),padding:yi(n.cellpadding)}),Oi(t)&&oa(r,e.children[u],{"border-color":n.bordercolor});Oi(t)&&(i["background-color"]=n.backgroundcolor,i["border-color"]=n.bordercolor,i["border-style"]=n.borderstyle),o.style=r.serializeStyle(le(le({},xi(t)),i)),r.setAttribs(e,le(le({},Si(t)),o))}(t,e,i),(r=o.select("caption",e)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=ta.ie?"\xa0":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),""===i.align?Mc(t,e):Bc(t,e,i.align),t.focus(),t.addVisual()}))}function Gi(t){return function(e){return Mt.from(e.dom.getParent(e.selection.getStart(),t)).map(oe.fromDom)}}function Yi(t){function n(){t.stopPropagation()}function r(){t.preventDefault()}var o=oe.fromDom(t.target),i=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}}(r,n);return function(t,n,r,o,i,u,c){return{target:e(t),x:e(n),y:e(r),stop:o,prevent:i,kill:u,raw:e(c)}}(o,t.clientX,t.clientY,n,r,i,t)}function Ki(t,e,n,r,o){var u=function(t,e){return function(n){t(n)&&e(Yi(n))}}(n,r);return t.dom().addEventListener(e,u,o),{unbind:i(ga,t,e,u,o)}}function Xi(t,e,n){return function(t,e,n,r){return Ki(t,e,n,r,!1)}(t,e,pa,n)}var $i=function(t){var e=sn(t);return gn.generate(e).grid()},Ji=function(t,n){function r(e,n){0<e.length?function(e,n){var r=Qe(t,n).getOrThunk((function(){var e=oe.fromTag(n,ht(t).dom());return Me(t,e),e}));Et(r);var u=b(e,(function(t){t.isNew()&&o.push(t.element());var e=t.element();return Et(e),w(t.cells(),(function(t){t.isNew()&&i.push(t.element()),wo(t.element(),"colspan",t.colspan(),1),wo(t.element(),"rowspan",t.rowspan(),1),Me(e,t.element())})),e}));At(r,u)}(e,n):function(e){Qe(t,e).each(We)}(n)}var o=[],i=[],u=[],c=[],a=[];return w(n,(function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":c.push(t);break;case"tfoot":a.push(t)}})),r(u,"thead"),r(c,"tbody"),r(a,"tfoot"),{newRows:e(o),newCells:e(i)}},Qi=function(t){return b(t,(function(t){var e=Tn(t.element());return w(t.cells(),(function(t){var n=On(t.element());wo(n,"colspan",t.colspan(),1),wo(n,"rowspan",t.rowspan(),1),Me(e,n)})),e}))},Zi=function(t,e,n){var r=t();return x(r,e).orThunk((function(){return Mt.from(r[0]).orThunk(n)})).map((function(t){return t.element()}))},tu=function(t){var n=t.grid(),r=Do(0,n.columns()),o=Do(0,n.rows());return b(r,(function(n){return Zi((function(){return O(o,(function(r){return gn.getAt(t,r,n).filter((function(t){return t.column()===n})).fold(e([]),(function(t){return[t]}))}))}),(function(t){return 1===t.colspan()}),(function(){return gn.getAt(t,0,n)}))}))},eu=function(t){var n=t.grid(),r=Do(0,n.rows()),o=Do(0,n.columns());return b(r,(function(n){return Zi((function(){return O(o,(function(r){return gn.getAt(t,n,r).filter((function(t){return t.row()===n})).fold(e([]),(function(t){return[t]}))}))}),(function(t){return 1===t.rowspan()}),(function(){return gn.getAt(t,n,0)}))}))},nu={resolve:Eo("ephox-snooker").resolve},ru=function(t,e,n,r,o){var i=oe.fromTag("div");return rt(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),q(i,{"data-column":t,role:"presentation"}),i},ou=function(t,e,n,r,o){var i=oe.fromTag("div");return rt(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),q(i,{"data-row":t,role:"presentation"}),i},iu=nu.resolve("resizer-bar"),uu=nu.resolve("resizer-rows"),cu=nu.resolve("resizer-cols"),au=function(t,e,n,r){No(t);var o=sn(e),i=gn.generate(o),u=eu(i),c=tu(i);Io(t,e,u,c,n,r)},lu=function(t){Bo(t,(function(t){nt(t,"display","none")}))},fu=function(t){Bo(t,(function(t){nt(t,"display","block")}))},su=No,du=function(t){return Oo(t,uu)},mu=function(t){return Oo(t,cu)},gu=function(t,e){return Ve(e,t.section())},pu={addCell:function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return gu(t,u)},setCells:gu,mutateCell:function(t,e,n){t.cells()[e]=n},getCell:Po,getCellElement:function(t,e){return Po(t,e).element()},mapCells:function(t,e){var n=t.cells(),r=b(n,e);return Ve(r,t.section())},cellLength:function(t){return t.cells().length}},hu=function(t,n,r,o){var i=function(t,e){return t[e]}(t,n).cells().slice(r),u=Mo(i,o),c=function(t,e){return b(t,(function(t){return pu.getCell(t,e)}))}(t,r).slice(n),a=Mo(c,o);return{colspan:e(u),rowspan:e(a)}},vu=function(t,e){var n=b(t,(function(t,e){return b(t.cells(),(function(t,e){return!1}))}));return b(t,(function(r,o){var i=O(r.cells(),(function(r,i){if(!1!==n[o][i])return[];var u=hu(t,o,i,e);return function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[ze(r.element(),u.rowspan(),u.colspan(),r.isNew())]}));return Ge(i,r.section())}))},bu=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var c=gn.getAt(t,o,u).map((function(t){return Ue(t.element(),n)})).getOrThunk((function(){return Ue(e.gap(),!0)}));i.push(c)}var a=Ve(i,t.all()[o].section());r.push(a)}return r},wu=function(t){return{is:function(e){return t===e},isValue:f,isError:l,getOr:e(t),getOrThunk:e(t),getOrDie:e(t),or:function(e){return wu(t)},orThunk:function(e){return wu(t)},fold:function(e,n){return n(t)},map:function(e){return wu(e(t))},mapError:function(e){return wu(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOption:function(){return Mt.some(t)}}},yu=function(t){return{is:l,isValue:l,isError:f,getOr:n,getOrThunk:function(t){return t()},getOrDie:function(){return function(t){return function(){throw new Error(t)}}(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return yu(t)},mapError:function(e){return yu(e(t))},each:o,bind:function(e){return yu(t)},exists:l,forall:f,toOption:Mt.none}},Cu={value:wu,error:yu,fromOption:function(t,e){return t.fold((function(){return yu(e)}),wu)}},Su=function(t,n,r){if(t.row()>=n.length||t.column()>pu.cellLength(n[0]))return Cu.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var o=n.slice(t.row()),i=o[0].cells().slice(t.column()),u=pu.cellLength(r[0]),c=r.length;return Cu.value({rowDelta:e(o.length-c),colDelta:e(i.length-u)})},xu=function(t,n){var r=pu.cellLength(t[0]),o=pu.cellLength(n[0]);return{rowDelta:e(0),colDelta:e(r-o)}},Ru=function(t,e,r){var o=e.colDelta()<0?Vo:n;return(e.rowDelta()<0?qo:n)(o(t,Math.abs(e.colDelta()),r),Math.abs(e.rowDelta()),r)},Tu=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)pu.mutateCell(t[o],i,Ue(r(),!1));return t},Ou=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<pu.cellLength(t[0]);u++){var c=n(pu.getCellElement(t[i],u),e);!0===c&&!1===o?pu.mutateCell(t[i],u,Ue(r(),!0)):!0===c&&(o=!1)}return t},Du=function(t,e,n,r){if(0<e&&e<t.length){var o=function(t,e){return S(t,(function(t,n){return v(t,(function(t){return e(t.element(),n.element())}))?t:t.concat([n])}),[])}(t[e-1].cells(),n);w(o,(function(o){for(var i=Mt.none(),u=function(e){for(var u=function(u){var c=t[e].cells()[u];n(c.element(),o.element())&&(i.isNone()&&(i=Mt.some(r())),i.each((function(n){pu.mutateCell(t[e],u,Ue(n,!0))})))},c=0;c<pu.cellLength(t[0]);c++)u(c)},c=e;c<t.length;c++)u(c)}))}return t},Au=function(t,e,n,r,o){return Su(t,e,n).map((function(u){var c=Ru(e,u,r);return function(t,e,n,r,o){for(var u,c,a,l,f,s=t.row(),d=t.column(),m=s+n.length,g=d+pu.cellLength(n[0]),p=s;p<m;p++)for(var h=d;h<g;h++){u=e,c=p,a=h,f=l=void 0,l=i(o,pu.getCell(u[c],a).element()),f=u[c],1<u.length&&1<pu.cellLength(f)&&(0<a&&l(pu.getCellElement(f,a-1))||a<f.cells().length-1&&l(pu.getCellElement(f,a+1))||0<c&&l(pu.getCellElement(u[c-1],a))||c<u.length-1&&l(pu.getCellElement(u[c+1],a)))&&Ou(e,pu.getCellElement(e[p],h),o,r.cell);var v=pu.getCellElement(n[p-s],h-d),b=r.replace(v);pu.mutateCell(e[p],h,Ue(b,!0))}return e}(t,c,n,r,o)}))},Eu=function(t,e,n,r,o){Du(e,t,o,r.cell);var i=xu(n,e),u=Ru(n,i,r),c=xu(e,u),a=Ru(e,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},Nu=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),c=pu.mapCells(t[n],(function(n,i){return 0<e&&e<t.length&&r(pu.getCellElement(t[e-1],i),pu.getCellElement(t[e],i))?pu.getCell(t[e],i):Ue(o(n.element(),r),!0)}));return i.concat([c]).concat(u)},ku=function(t,e,n,r,o){return b(t,(function(t){var i=0<e&&e<pu.cellLength(t)&&r(pu.getCellElement(t,e-1),pu.getCellElement(t,e))?pu.getCell(t,e):Ue(o(pu.getCellElement(t,n),r),!0);return pu.addCell(t,e,i)}))},Iu=function(t,e,n,r,o){var i=n+1;return b(t,(function(t,u){var c=u===e?Ue(o(pu.getCellElement(t,n),r),!0):pu.getCell(t,n);return pu.addCell(t,i,c)}))},Bu=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),c=t.slice(i),a=pu.mapCells(t[e],(function(t,e){return e===n?Ue(o(t.element(),r),!0):t}));return u.concat([a]).concat(c)},Pu=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},Mu=function(t,e,n){var r=b(t,(function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return Ve(r,t.section())}));return y(r,(function(t){return 0<t.cells().length}))},Wu=function(t,e,n,r){var o=O(t,(function(r,o){return Yo(t,o,e,n)||Ko(r,e,n)?[]:[pu.getCell(r,e)]}));return Go(t,o,n,r)},_u=function(t,e,n,r){var o=t[e],i=O(o.cells(),(function(r,i){return Yo(t,e,i,n)||Ko(o,i,n)?[]:[r]}));return Go(t,i,n,r)},Lu=xr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),ju=le({},Lu),zu=function(t,n,r,o){function i(t){return b(t,e(0))}function u(t,e){if(0<=r){var n=Math.max(o.minCellWidth(),c[e]-r);return i(c.slice(0,t)).concat([r,n-c[e]]).concat(i(c.slice(e+1)))}var u=Math.max(o.minCellWidth(),c[t]+r),a=c[t]-u;return i(c.slice(0,t)).concat([u-c[t],a]).concat(i(c.slice(e+1)))}var c=t.slice(0),a=function(t,e){return 0===t.length?ju.none():1===t.length?ju.only(0):0===e?ju.left(0,1):e===t.length-1?ju.right(e-1,e):0<e&&e<t.length-1?ju.middle(e-1,e,e+1):ju.none()}(t,n),l=e(i(c)),f=u;return a.fold(l,(function(t){return o.singleColumnWidth(c[t],r)}),f,(function(t,e,n){return u(e,n)}),(function(t,e){if(0<=r)return i(c.slice(0,e)).concat([r]);var n=Math.max(o.minCellWidth(),c[e]+r);return i(c.slice(0,e)).concat([n-c[e]])}))},Hu={hasColspan:function(t){return Xo(t,"colspan")},hasRowspan:function(t){return Xo(t,"rowspan")},minWidth:e(10),minHeight:e(10),getInt:function(t,e){return parseInt(ot(t,e),10)}},Fu={getRawWidths:function(t,e,n){return Zo(t,e,Jo,ti,n)},getPixelWidths:function(t,e,n){return Zo(t,e,co.getPixelWidth,(function(t){return t.getOrThunk(n.minCellWidth)}),n)},getPercentageWidths:function(t,e,n){return Zo(t,e,co.getPercentageWidth,(function(t){return t.fold((function(){return n.minCellWidth()}),(function(t){return t/n.pixelWidth()*100}))}),n)},getPixelHeights:function(t,e){return ei(t,e,co.getHeight,(function(t){return t.getOrThunk(Hu.minHeight)}))},getRawHeights:function(t,e){return ei(t,e,Qo,ti)}},Uu=function(t,n){var r=gn.justCells(t);return b(r,(function(t){var r=ni(t.column(),t.column()+t.colspan(),n);return{element:t.element,width:e(r),colspan:t.colspan}}))},qu=function(t,n){var r=gn.justCells(t);return b(r,(function(t){var r=ni(t.row(),t.row()+t.rowspan(),n);return{element:t.element,height:e(r),rowspan:t.rowspan}}))},Vu=function(t,n){return b(t.all(),(function(t,r){return{element:t.element,height:e(n[r])}}))},Gu=function(t){return co.getRawWidth(t).fold((function(){var e=Mr(t);return ri(e)}),(function(e){return oi(t,e)}))},Yu=function(t,e,n,r){var o=Gu(t),i=o.getCellDelta(e),u=ui(t),c=o.getWidths(u,r,o),a=zu(c,n,i,o),l=b(a,(function(t,e){return t+c[e]})),f=Uu(u,l);w(f,(function(t){o.setElementWidth(t.element(),t.width())})),n===u.grid().columns()-1&&o.setTableWidth(t,l,i)},Ku=function(t,e,n,r){var o=ui(t),i=Fu.getPixelHeights(o,r),u=b(i,(function(t,r){return n===r?Math.max(e+t,Hu.minHeight()):t})),c=qu(o,u),a=Vu(o,u);w(a,(function(t){co.setHeight(t.element(),t.height())})),w(c,(function(t){co.setHeight(t.element(),t.height())}));var l=function(t){return C(t,(function(t,e){return t+e}),0)}(u);co.setHeight(t,l)},Xu=function(t,e,n){var r=Gu(t),o=ii(e),i=r.getWidths(o,n,r),u=Uu(o,i);w(u,(function(t){r.setElementWidth(t.element(),t.width())})),0<u.length&&r.setTableWidth(t,i,r.getCellDelta(0))},$u=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return _("required",e),L(e),function(r){var o=Vt(r);D(e,(function(t){return h(o,t)}))||M(e,o),t(e,o);var i=y(e,(function(t){return!n.validate(r[t],t)}));return 0<i.length&&function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+P(t).join(", ")+") were not.")}(i,n.label),r}},Ju=ai(["cell","row","replace","gap"]),Qu=function(t,e){function n(n){return function(e){return t.cell(e)}(e(n))}function o(t){var e=n(t);return i.get().isNone()&&i.set(Mt.some(e)),u=Mt.some({item:t,replacement:e}),e}void 0===e&&(e=li),Ju(t);var i=r(Mt.none()),u=Mt.none();return{getOrInit:function(t,e){return u.fold((function(){return o(t)}),(function(n){return e(t,n.item)?n.replacement:o(t)}))},cursor:i.get}},Zu=function(t,e){return function(n){var o=r(Mt.none());function i(r){var i={scope:t},c=n.replace(r,e,i);return u.push({item:r,sub:c}),o.get().isNone()&&o.set(Mt.some(c)),c}Ju(n);var u=[];return{replaceOrInit:function(t,e){return function(t,e){return x(u,(function(n){return e(n.item,t)}))}(t,e).fold((function(){return i(t)}),(function(n){return e(t,n.item)?n.sub:i(t)}))},cursor:o.get}}},tc=function(t){Ju(t);var n=r(Mt.none());return{combine:function(r){return n.get().isNone()&&n.set(Mt.some(r)),function(){var n=t.cell({element:e(r),colspan:e(1),rowspan:e(1)});return ut(n,"width"),ut(r,"width"),n}},cursor:n.get}},ec=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],nc=fi,rc=function(t,e){var n=t.property().name(e);return h(["ol","ul"],n)},oc=si,ic=Jn(),uc=function(t){return nc(ic,t)},cc=function(t){return rc(ic,t)},ac=function(t){return oc(ic,t)},lc=function(t){function e(t){return"br"===te(t)}function n(t){return xn(t).bind((function(n){var r=function(t){return yt(t).map((function(t){return!!uc(t)||!!ac(t)&&"img"!==te(t)})).getOr(!1)}(n);return vt(n).map((function(o){return!0===r||function(t){return"li"===te(t)||$e(t,cc).isSome()}(o)||e(n)||uc(o)&&!Ie(t,o)?[]:[oe.fromTag("br")]}))})).getOr([])}var r,o=0===(r=O(t,(function(t){var r=Ct(t);return function(t){return D(t,(function(t){return e(t)||ne(t)&&0===vn(t).trim().length}))}(r)?[]:r.concat(n(t))}))).length?[oe.fromTag("br")]:r;Et(t[0]),At(t[0],o)},fc=B("grid","cursor"),sc=function(t,e,n){return Mt.from(t[e]).bind((function(t){return Mt.from(t.cells()[n]).bind((function(t){return Mt.from(t.element())}))}))},dc=Xu,mc={insertRowBefore:jo((function(t,e,n,r){var o=e.row(),i=e.row(),u=Nu(t,i,o,n,r.getOrInit);return gi(u,i,e.column())}),zo,o,o,Qu),insertRowsBefore:jo((function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=pi(e),c=S(u,(function(t,e){return Nu(t,i,o,n,r.getOrInit)}),t);return gi(c,i,e[0].column())}),Fo,o,o,Qu),insertRowAfter:jo((function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=Nu(t,i,o,n,r.getOrInit);return gi(u,i,e.column())}),zo,o,o,Qu),insertRowsAfter:jo((function(t,e,n,r){var o=pi(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),c=S(o,(function(t,e){return Nu(t,u,i,n,r.getOrInit)}),t);return gi(c,u,e[0].column())}),Fo,o,o,Qu),insertColumnBefore:jo((function(t,e,n,r){var o=e.column(),i=e.column(),u=ku(t,i,o,n,r.getOrInit);return gi(u,e.row(),i)}),zo,dc,o,Qu),insertColumnsBefore:jo((function(t,e,n,r){var o=hi(e),i=o[0].column(),u=o[0].column(),c=S(o,(function(t,e){return ku(t,u,i,n,r.getOrInit)}),t);return gi(c,e[0].row(),u)}),Fo,dc,o,Qu),insertColumnAfter:jo((function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=ku(t,i,o,n,r.getOrInit);return gi(u,e.row(),i)}),zo,dc,o,Qu),insertColumnsAfter:jo((function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=hi(e),c=S(u,(function(t,e){return ku(t,i,o,n,r.getOrInit)}),t);return gi(c,e[0].row(),i)}),Fo,dc,o,Qu),splitCellIntoColumns:jo((function(t,e,n,r){var o=Iu(t,e.row(),e.column(),n,r.getOrInit);return gi(o,e.row(),e.column())}),zo,dc,o,Qu),splitCellIntoRows:jo((function(t,e,n,r){var o=Bu(t,e.row(),e.column(),n,r.getOrInit);return gi(o,e.row(),e.column())}),zo,o,o,Qu),eraseColumns:jo((function(t,e,n,r){var o=hi(e),i=Mu(t,o[0].column(),o[o.length-1].column()),u=mi(i,e[0].row(),e[0].column());return fc(i,u)}),Fo,dc,di,Qu),eraseRows:jo((function(t,e,n,r){var o=pi(e),i=Pu(t,o[0].row(),o[o.length-1].row()),u=mi(i,e[0].row(),e[0].column());return fc(i,u)}),Fo,o,di,Qu),makeColumnHeader:jo((function(t,e,n,r){var o=Wu(t,e.column(),n,r.replaceOrInit);return gi(o,e.row(),e.column())}),zo,o,o,Zu("row","th")),unmakeColumnHeader:jo((function(t,e,n,r){var o=Wu(t,e.column(),n,r.replaceOrInit);return gi(o,e.row(),e.column())}),zo,o,o,Zu(null,"td")),makeRowHeader:jo((function(t,e,n,r){var o=_u(t,e.row(),n,r.replaceOrInit);return gi(o,e.row(),e.column())}),zo,o,o,Zu("col","th")),unmakeRowHeader:jo((function(t,e,n,r){var o=_u(t,e.row(),n,r.replaceOrInit);return gi(o,e.row(),e.column())}),zo,o,o,Zu(null,"td")),mergeCells:jo((function(t,n,r,o){var i=n.cells();lc(i);var u=Tu(t,n.bounds(),r,e(i[0]));return fc(u,Mt.from(i[0]))}),(function(t,e){return e.mergable()}),o,o,tc),unmergeCells:jo((function(t,e,n,r){var o=C(e,(function(t,e){return Ou(t,e,n,r.combine(e))}),t);return fc(o,Mt.from(e[0]))}),(function(t,e){return e.unmergable()}),dc,o,tc),pasteCells:jo((function(t,e,n,r){var o,i,u,c,a=(o=e.clipboard(),i=e.generators(),u=sn(o),c=gn.generate(u),bu(c,i,!0)),l=Le(e.row(),e.column());return Au(l,t,a,e.generators(),n).fold((function(){return fc(t,Mt.some(e.element()))}),(function(t){var n=mi(t,e.row(),e.column());return fc(t,n)}))}),(function(t,e){return fn.cell(e.element()).bind((function(n){return Lo(t,n).map((function(t){return le(le({},t),{generators:e.generators,clipboard:e.clipboard})}))}))}),dc,o,Qu),pasteRowsBefore:jo((function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=vi(e.clipboard(),e.generators(),o),c=Eu(i,t,u,e.generators(),n),a=mi(c,e.cells[0].row(),e.cells[0].column());return fc(c,a)}),Ho,o,o,Qu),pasteRowsAfter:jo((function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=vi(e.clipboard(),e.generators(),o),c=Eu(i,t,u,e.generators(),n),a=mi(c,e.cells[0].row(),e.cells[0].column());return fc(c,a)}),Ho,o,o,Qu)},gc=function(t){return oe.fromDom(t.getBody())},pc=function(t){return function(e){return Ie(e,gc(t))}},hc={isRtl:e(!1)},vc={isRtl:e(!0)},bc={directionAt:function(t){return"rtl"===function(t){return"rtl"===ot(t,"direction")?"rtl":"ltr"}(t)?vc:hc}},wc={"border-collapse":"collapse",width:"100%"},yc={border:"1"},Cc=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},Sc=function(t){var e=t.getParam("table_clone_elements");return _t(e)?Mt.some(e.split(/[ ,]/)):Array.isArray(e)?Mt.some(e):Mt.none()},xc=function(t,e,n,r,o){t.fire("TableSelectionChange",{cells:e,start:n,finish:r,otherCells:o})},Rc=function(t){t.fire("TableSelectionClear")},Tc=B("element","offset"),Oc=(B("element","deltaOffset"),B("element","start","finish"),B("begin","end"),B("element","text"),function(t,e,n){return t.property().isText(e)&&0===t.property().getText(e).trim().length||t.property().isComment(e)?n(e).bind((function(e){return Oc(t,e,n).orThunk((function(){return Mt.some(e)}))})):Mt.none()}),Dc=function(t,e){var n=Oc(t,e,t.query().prevSibling).getOr(e);if(t.property().isText(n))return Tc(n,Pi(t,n));var r=t.property().children(n);return 0<r.length?Dc(t,r[r.length-1]):Tc(n,Pi(t,n))},Ac=Dc,Ec=Jn(),Nc=function(t,e){function n(t){return"table"===te(gc(t))}function r(e,n,r,o){return function(u,c){Ci(u);var a=o(),l=oe.fromDom(t.getDoc()),f=vo(bc.directionAt),s=_n.cellOperations(r,l,i);return n(u)?e(a,u,c,s,f).bind((function(e){return w(e.newRows(),(function(e){Ni(t,e.dom())})),w(e.newCells(),(function(e){ki(t,e.dom())})),e.cursor().map((function(e){var n=function(t){return Ac(Ec,t)}(e),r=t.dom.createRng();return r.setStart(n.element().dom(),n.offset()),r.setEnd(n.element().dom(),n.offset()),r}))})):Mt.none()}}var i=Sc(t);return{deleteRow:r(mc.eraseRows,(function(e){var r=$i(e);return!1===n(t)||1<r.rows()}),o,e),deleteColumn:r(mc.eraseColumns,(function(e){var r=$i(e);return!1===n(t)||1<r.columns()}),o,e),insertRowsBefore:r(mc.insertRowsBefore,f,o,e),insertRowsAfter:r(mc.insertRowsAfter,f,o,e),insertColumnsBefore:r(mc.insertColumnsBefore,f,ao,e),insertColumnsAfter:r(mc.insertColumnsAfter,f,ao,e),mergeCells:r(mc.mergeCells,f,o,e),unmergeCells:r(mc.unmergeCells,f,o,e),pasteRowsBefore:r(mc.pasteRowsBefore,f,o,e),pasteRowsAfter:r(mc.pasteRowsAfter,f,o,e),pasteCells:r(mc.pasteCells,f,o,e)}},kc=function(t,e,n){var r=sn(t),o=gn.generate(r);return Fo(o,e).map((function(t){var e=bu(o,n,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=_o(e,n);return Qi(r)}))},Ic=tinymce.util.Tools.resolve("tinymce.util.Tools"),Bc=function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},Pc=function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},Mc=function(t,e){Ic.each("left center right".split(" "),(function(n){t.formatter.remove("align"+n,{},e)}))},Wc=function(t,e){Ic.each("top middle bottom".split(" "),(function(n){t.formatter.remove("valign"+n,{},e)}))},_c=function(t,e,n){var r;return function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,t.select("td,th",e))},Lc=i(Wi,"left center right"),jc=i(Wi,"top middle bottom"),zc=function(t,e,n){var r=function(t,n){return n=n||[],Ic.each(t,(function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)})),n};return r(t,n||[])},Hc=function(t){var e=t[0],n=t.slice(1),r=Vt(e);return w(n,(function(t){w(r,(function(n){N(t,(function(t,r){var o=e[n];""!==o&&n===r&&o!==t&&(e[n]="")}))}))})),e},Fc=function(t){var e=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(e):e}},Uc=function(t,e,n){var r,o,i,u=t.dom;return le(le({width:u.getStyle(e,"width")||u.getAttrib(e,"width"),height:u.getStyle(e,"height")||u.getAttrib(e,"height"),cellspacing:u.getStyle(e,"border-spacing")||u.getAttrib(e,"cellspacing"),cellpadding:u.getAttrib(e,"cellpadding")||_c(t.dom,e,"padding"),border:(r=u,o=e,i=it(oe.fromDom(o),"border-width"),Di(t)&&i.isSome()?i.getOr(""):r.getAttrib(o,"border")||_c(t.dom,o,"border-width")||_c(t.dom,o,"border")),caption:!!u.select("caption",e)[0],class:u.getAttrib(e,"class","")},Lc("align","align",t,e)),n?Mi(u,e):{})},qc=function(t,e,n){var r=t.dom;return le(le({height:r.getStyle(e,"height")||r.getAttrib(e,"height"),scope:r.getAttrib(e,"scope"),class:r.getAttrib(e,"class",""),align:"",type:e.parentNode.nodeName.toLowerCase()},Lc("align","align",t,e)),n?Mi(r,e):{})},Vc=function(t,e,n){var r=t.dom;return le(le(le({width:r.getStyle(e,"width")||r.getAttrib(e,"width"),height:r.getStyle(e,"height")||r.getAttrib(e,"height"),scope:r.getAttrib(e,"scope"),celltype:e.nodeName.toLowerCase(),class:r.getAttrib(e,"class","")},Lc("align","halign",t,e)),jc("valign","valign",t,e)),n?Mi(r,e):{})},Gc=function(t,e){var n,r,o,i,u,c,a,l=xi(t),f=Si(t),s=t.dom,d=e?(n=s,r=I(l,"border-style").getOr(""),o=I(l,"border-color").getOr(""),i=I(l,"background-color").getOr(""),{borderstyle:r,bordercolor:m(o),backgroundcolor:m(i)}):{};function m(t){return J(t,"rgb")?n.toHex(t):t}return le(le(le(le(le(le({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),l),f),d),(a=l["border-width"],Di(t)&&a?{border:a}:I(f,"border").fold((function(){return{}}),(function(t){return{border:t}})))),(u=I(l,"border-spacing").or(I(f,"cellspacing")).fold((function(){return{}}),(function(t){return{cellspacing:t}})),c=I(l,"border-padding").or(I(f,"cellpadding")).fold((function(){return{}}),(function(t){return{cellpadding:t}})),le(le({},u),c)))},Yc=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Kc=function(t){return function(t){var e=function(t){return t.getParam("table_cell_class_list",[],"array")}(t),n=zc(e,(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})}));return 0<e.length?Mt.some({name:"class",type:"selectbox",label:"Class",items:n}):Mt.none()}(t).fold((function(){return Yc}),(function(t){return Yc.concat(t)}))},Xc={normal:function(t,e){return{setAttrib:function(n,r){t.setAttrib(e,n,r)},setStyle:function(n,r){t.setStyle(e,n,r)}}},ifTruthy:function(t,e){return{setAttrib:function(n,r){r&&t.setAttrib(e,n,r)},setStyle:function(n,r){r&&t.setStyle(e,n,r)}}}},$c=function(t){var e,n=[];if(n=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!n.length&&e&&n.push(e),e=e||n[0]){var r=Ic.map(n,(function(e){return Vc(t,e,Ri(t))})),o=Hc(r),u={type:"tabpanel",tabs:[{title:"General",name:"general",items:Kc(t)},Fc("cell")]},c={type:"panel",items:[{type:"grid",columns:2,items:Kc(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:Ri(t)?u:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:i(Hi,t,n)})}},Jc=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Qc=function(t){return function(t){var e=function(t){return t.getParam("table_row_class_list",[],"array")}(t),n=zc(e,(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})}));return 0<e.length?Mt.some({name:"class",type:"selectbox",label:"Class",items:n}):Mt.none()}(t).fold((function(){return Jc}),(function(t){return Jc.concat(t)}))},Zc=function(t){var e,n,r=t.dom,o=[];if((e=r.getParent(t.selection.getStart(),"table"))&&(n=r.getParent(t.selection.getStart(),"td,th"),Ic.each(e.rows,(function(t){Ic.each(t.cells,(function(e){if((r.getAttrib(e,"data-mce-selected")||e===n)&&o.indexOf(t)<0)return o.push(t),!1}))})),o[0])){var u=Ic.map(o,(function(e){return qc(t,e,Ti(t))})),c=Hc(u),a={type:"tabpanel",tabs:[{title:"General",name:"general",items:Qc(t)},Fc("row")]},l={type:"panel",items:[{type:"grid",columns:2,items:Qc(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:Ti(t)?a:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:i(Fi,t,o,c)})}},ta=tinymce.util.Tools.resolve("tinymce.Env"),ea={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},na=function(t,e,n){var r=xi(t),o={styles:r,attributes:Si(t),percentages:function(t){return _t(t)&&-1!==t.indexOf("%")}(r.width)&&!Ei(t)},u=Ui(n,e,0,0,o);U(u,"data-mce-id","__mce");var c=function(t){var e=oe.fromTag("div"),n=oe.fromDom(t.dom().cloneNode(!0));return Me(e,n),function(t){return t.dom().innerHTML}(e)}(u);return t.insertContent(c),Ze(gc(t),'table[data-mce-id="__mce"]').map((function(e){return Ei(t)&&nt(e,"width",ot(e,"width")),Y(e,"data-mce-id"),function(t,e){w(Bt(e,"tr"),(function(e){Ni(t,e.dom()),w(Bt(e,"th,td"),(function(e){ki(t,e.dom())}))}))}(t,e),function(t,e){Ze(e,"td,th").each(i(qi,t))}(t,e),e.dom()})).getOr(null)},ra=function(t,e,n){var r=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(t){return t.getParam("table_appearance_options",!0,"boolean")}(t)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=e?[{type:"selectbox",name:"class",label:"Class",items:zc(Ai(t),(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})}))}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},oa=function(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)_t(n)?t.setStyle(e,n,r):t.setStyle(e,n);else if(e.children)for(var o=0;o<e.children.length;o++)oa(t,e.children[o],n,r)},ia=function(t,e){var n,r=t.dom,o=Gc(t,Oi(t));!1===e?(n=r.getParent(t.selection.getStart(),"table"))?o=Uc(t,n,Oi(t)):Oi(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",Oi(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var u=0<Ai(t).length;u&&o["class"]&&(o["class"]=o["class"].replace(/\s*mce\-item\-table\s*/g,""));var c={type:"grid",columns:2,items:ra(t,u,e)},a=Oi(t)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[c]},Fc("table")]}:{type:"panel",items:[c]};t.windowManager.open({title:"Table Properties",size:"normal",body:a,onSubmit:i(Vi,t,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},ua=Gi("th,td"),ca=Gi("th,td,caption"),aa=Ic.each,la={registerCommands:function(t,e,n,r,c){function a(t){return fn.table(t,m)}function l(t){return{width:bi(t.dom()),height:bi(t.dom())}}function f(e){ua(t).each((function(o){a(o).each((function(i){var u=Nr.forMenu(r,i,o),c=l(i);e(i,u).each((function(e){!function(t,e,n){var r=l(n);e.width===r.width&&e.height===r.height||(Ii(t,n.dom(),e.width,e.height),Bi(t,n.dom(),r.width,r.height))}(t,c,i),t.selection.setRng(e),t.focus(),n.clear(i),Ci(i)}))}))}))}function s(e){return ua(t).map((function(e){return a(e).bind((function(n){var i=oe.fromDom(t.getDoc()),u=Nr.forMenu(r,n,e),c=_n.cellOperations(o,i,Mt.none());return kc(n,u,c)}))}))}function d(e){c.get().each((function(o){var i=b(o,(function(t){return On(t)}));ua(t).each((function(o){a(o).each((function(u){var c=oe.fromDom(t.getDoc()),a=_n.paste(c),l=Nr.pasteRows(r,u,o,i,a);e(u,l).each((function(e){t.selection.setRng(e),t.focus(),n.clear(u)}))}))}))}))}var m=pc(t);aa({mceTableSplitCells:function(){f(e.unmergeCells)},mceTableMergeCells:function(){f(e.mergeCells)},mceTableInsertRowBefore:function(){f(e.insertRowsBefore)},mceTableInsertRowAfter:function(){f(e.insertRowsAfter)},mceTableInsertColBefore:function(){f(e.insertColumnsBefore)},mceTableInsertColAfter:function(){f(e.insertColumnsAfter)},mceTableDeleteCol:function(){f(e.deleteColumn)},mceTableDeleteRow:function(){f(e.deleteRow)},mceTableCutRow:function(t){s().each((function(t){c.set(t),f(e.deleteRow)}))},mceTableCopyRow:function(t){s().each((function(t){c.set(t)}))},mceTablePasteRowBefore:function(t){d(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){d(e.pasteRowsAfter)},mceTableDelete:function(){ca(t).each((function(e){fn.table(e,m).filter(u(m)).each((function(e){var n=oe.fromText("");if(Rt(e,n),We(e),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r),t.nodeChanged()}}))}))}},(function(e,n){t.addCommand(n,e)})),aa({mceInsertTable:i(ia,t,!0),mceTableProps:i(ia,t,!1),mceTableRowProps:i(Zc,t),mceTableCellProps:i($c,t)},(function(e,n){t.addCommand(n,(function(){e()}))}))}},fa=function(t){var n=Mt.from(t.dom().documentElement).map(oe.fromDom).getOr(t);return{parent:e(n),view:e(t),origin:e(fo(0,0))}},sa=function(t,n){return{parent:e(n),view:e(t),origin:e(fo(0,0))}},da=function(t){var e=B.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");n.push(t)},unbind:function(t){n=y(n,(function(e){return e!==t}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.apply(null,t);w(n,(function(t){t(o)}))}}},ma={create:function(t){return{registry:k(t,(function(t){return{bind:t.bind,unbind:t.unbind}})),trigger:k(t,(function(t){return t.trigger}))}}},ga=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},pa=e(!0),ha=Yi,va={resolve:Eo("ephox-dragster").resolve},ba=ai(["compare","extract","mutate","sink"]),wa=ai(["element","start","stop","destroy"]),ya=ai(["forceDrop","drop","move","delayDrop"]),Ca=ba({compare:function(t,e){return fo(e.left()-t.left(),e.top()-t.top())},extract:function(t){return Mt.some(fo(t.x(),t.y()))},sink:function(t,e){var n=function(t){var e=le({layerClass:va.resolve("blocker")},t),n=oe.fromTag("div");return U(n,"role","presentation"),rt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Ro(n,va.resolve("blocker")),Ro(n,e.layerClass),{element:function(){return n},destroy:function(){We(n)}}}(e),r=Xi(n.element(),"mousedown",t.forceDrop),o=Xi(n.element(),"mouseup",t.drop),i=Xi(n.element(),"mousemove",t.move),u=Xi(n.element(),"mouseout",t.delayDrop);return wa({element:n.element,start:function(t){Me(t,n.element())},stop:function(){We(n.element())},destroy:function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,e){t.mutate(e.left(),e.top())}});function Sa(){var t=Mt.none(),e=ma.create({move:da(["info"])});return{onEvent:function(n,r){r.extract(n).each((function(n){(function(e,n){var r=t.map((function(t){return e.compare(t,n)}));return t=Mt.some(n),r})(r,n).each((function(t){e.trigger.move(t)}))}))},reset:function(){t=Mt.none()},events:e.registry}}function xa(){var t=function(){return{onEvent:o,reset:o}}(),e=Sa(),n=t;return{on:function(){n.reset(),n=e},off:function(){n.reset(),n=t},isOn:function(){return n===e},onEvent:function(t,e){n.onEvent(t,e)},events:e.events}}function Ra(){var t=ma.create({drag:da(["xDelta","yDelta","target"])}),e=Mt.none(),n=function(){var t=ma.create({drag:da(["xDelta","yDelta"])});return{mutate:function(e,n){t.trigger.drag(e,n)},events:t.registry}}();return n.events.drag.bind((function(n){e.each((function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)}))})),{assign:function(t){e=Mt.some(t)},get:function(){return e},mutate:n.mutate,events:t.registry}}function Ta(t){return"true"===V(t,"contenteditable")}function Oa(t,e,n){function r(t,e){return Mt.from(V(t,e))}var o=Ra(),u=Cl(o,{}),c=Mt.none();function a(t,e){return Hu.getInt(t,e)-parseInt(V(t,"data-initial-"+e),10)}function l(e,n){g.trigger.startAdjust(),o.assign(e),U(e,"data-initial-"+n,parseInt(ot(e,n),10)),Ro(e,Sl),nt(e,"opacity","0.2"),u.go(t.parent())}function f(e){return Ie(e,t.view())}function s(t){return tn(t,"table",f).filter((function(t){return function(t,e){return tn(t,"[contenteditable]",e)}(t,f).exists(Ta)}))}o.events.drag.bind((function(t){r(t.target(),"data-row").each((function(e){var n=Hu.getInt(t.target(),"top");nt(t.target(),"top",n+t.yDelta()+"px")})),r(t.target(),"data-column").each((function(e){var n=Hu.getInt(t.target(),"left");nt(t.target(),"left",n+t.xDelta()+"px")}))})),u.events.stop.bind((function(){o.get().each((function(o){c.each((function(i){r(o,"data-row").each((function(t){var e=a(o,"top");Y(o,"data-initial-top"),g.trigger.adjustHeight(i,e,parseInt(t,10))})),r(o,"data-column").each((function(t){var e=a(o,"left");Y(o,"data-initial-left"),g.trigger.adjustWidth(i,e,parseInt(t,10))})),au(t,i,n,e)}))}))}));var d=Xi(t.parent(),"mousedown",(function(t){du(t.target())&&l(t.target(),"top"),mu(t.target())&&l(t.target(),"left")})),m=Xi(t.view(),"mouseover",(function(r){s(r.target()).fold((function(){tt(r.target())&&su(t)}),(function(r){c=Mt.some(r),au(t,r,n,e)}))})),g=ma.create({adjustHeight:da(["table","delta","row"]),adjustWidth:da(["table","delta","column"]),startAdjust:da([])});return{destroy:function(){d.unbind(),m.unbind(),u.destroy(),su(t)},refresh:function(r){au(t,r,n,e)},on:u.on,off:u.off,hideBars:i(lu,t),showBars:i(fu,t),events:g.registry}}function Da(t,e){return bi(t.dom())/bi(e.dom())*100+"%"}function Aa(t,n){return fn.table(t,n).bind((function(n){var r=fn.cells(n);return R(r,(function(e){return Ie(t,e)})).map((function(t){return{index:e(t),all:e(r)}}))}))}function Ea(t,e,n){var r=t.document.createRange();return function(t,e){e.fold((function(e){t.setStartBefore(e.dom())}),(function(e,n){t.setStart(e.dom(),n)}),(function(e){t.setStartAfter(e.dom())}))}(r,e),function(t,e){e.fold((function(e){t.setEndBefore(e.dom())}),(function(e,n){t.setEnd(e.dom(),n)}),(function(e){t.setEndAfter(e.dom())}))}(r,n),r}function Na(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i}function ka(t){return{left:e(t.left),top:e(t.top),right:e(t.right),bottom:e(t.bottom),width:e(t.width),height:e(t.height)}}function Ia(t,e,n){return e(oe.fromDom(n.startContainer),n.startOffset,oe.fromDom(n.endContainer),n.endOffset)}function Ba(t,n){return function(t,e){var n=e.ltr();return n.collapsed?e.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return _l.rtl(oe.fromDom(t.endContainer),t.endOffset,oe.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Ia(0,_l.ltr,n)})):Ia(0,_l.ltr,n)}(0,function(t,n){return n.match({domRange:function(t){return{ltr:e(t),rtl:Mt.none}},relative:function(e,n){return{ltr:Z((function(){return Ea(t,e,n)})),rtl:Z((function(){return Mt.some(Ea(t,n,e))}))}},exact:function(e,n,r,o){return{ltr:Z((function(){return Na(t,e,n,r,o)})),rtl:Z((function(){return Mt.some(Na(t,r,o,e,n))}))}}})}(t,n))}function Pa(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom}function Ma(t,e,n,r,o){function i(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r}var u=vn(e).length,c=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var c=t(u),a=Math.abs(e-c.left);if(n<=c.bottom){if(n<c.top||i<a)return u-1;i=a}}return 0}((function(t){return i(t).getBoundingClientRect()}),n,r,o.right,u);return i(c)}function Wa(t,e){return e-t.left<t.right-e}function _a(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r}function La(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=Wa(o,n);return(!0===i?Sn:xn)(e).map((function(e){return _a(t,e,i)}))}function ja(t,e,n){var r=e.dom().getBoundingClientRect(),o=Wa(r,n);return Mt.some(_a(t,e,o))}function za(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect();return function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return jl(t,e,u,c)}(t,e,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))}function Ha(t,e){var n=te(t);return"input"===n?Bl.after(t):h(["br","img"],n)?0===e?Bl.before(t):Bl.after(t):Bl.on(t,e)}function Fa(t,e){var n=t.fold(Bl.before,Ha,Bl.after),r=e.fold(Bl.before,Ha,Bl.after);return Ml.relative(n,r)}function Ua(t,e,n,r){var o=Ha(t,e),i=Ha(n,r);return Ml.relative(o,i)}function qa(t,e,n,r){var o=function(t,e,n,r){var o=ht(t).dom().createRange();return o.setStart(t.dom(),e),o.setEnd(n.dom(),r),o}(t,e,n,r),i=Ie(t,n)&&e===r;return o.collapsed&&!i}function Va(t,e){Mt.from(t.getSelection()).each((function(t){t.removeAllRanges(),t.addRange(e)}))}function Ga(t,e,n,r,o){var i=Na(t,e,n,r,o);Va(t,i)}function Ya(t,e){return Ba(t,e).match({ltr:function(e,n,r,o){Ga(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(e.dom(),n,r.dom(),o);else if(i.extend)try{!function(t,e,n,r,o,i){e.collapse(n.dom(),r),e.extend(o.dom(),i)}(0,i,e,n,r,o)}catch(f){Ga(t,r,o,e,n)}else Ga(t,r,o,e,n)}})}function Ka(t,e,n,r,o){var i=Ua(e,n,r,o);Ya(t,i)}function Xa(t,e,n){var r=Fa(e,n);Ya(t,r)}function $a(t){function e(t,e,r,o){return Na(n,t,e,r,o)}var n=Ml.getWin(t).dom(),r=function(t){return t.match({domRange:function(t){var e=oe.fromDom(t.startContainer),n=oe.fromDom(t.endContainer);return Ua(e,t.startOffset,n,t.endOffset)},relative:Fa,exact:Ua})}(t);return Ba(n,r).match({ltr:e,rtl:e})}function Ja(t){var e=oe.fromDom(t.anchorNode),n=oe.fromDom(t.focusNode);return qa(e,t.anchorOffset,n,t.focusOffset)?Mt.some(kl.create(e,t.anchorOffset,n,t.focusOffset)):function(t){if(0<t.rangeCount){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return Mt.some(kl.create(oe.fromDom(e.startContainer),e.startOffset,oe.fromDom(n.endContainer),n.endOffset))}return Mt.none()}(t)}function Qa(t,e){var n=function(t,e){var n=t.document.createRange();return Wl(n,e),n}(t,e);Va(t,n)}function Za(t){return function(t){return Mt.from(t.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(Ja)}(t).map((function(t){return Ml.exact(t.start(),t.soffset(),t.finish(),t.foffset())}))}function tl(t,e){return function(t){var e=t.getClientRects(),n=0<e.length?e[0]:t.getBoundingClientRect();return 0<n.width||0<n.height?Mt.some(n).map(ka):Mt.none()}(Ll(t,e))}function el(t,e,n){return function(t,e,n){var r=oe.fromDom(t.document);return zl(r,e,n).map((function(t){return kl.create(oe.fromDom(t.startContainer),t.startOffset,oe.fromDom(t.endContainer),t.endOffset)}))}(t,e,n)}function nl(t,e,n,r){return Fl(t,e,El(n),r)}function rl(t,e,n,r){return Fl(t,e,Nl(n),r)}function ol(t,e){var n=Ml.exact(e,0,e,0);return $a(n)}function il(t,e){return function(t){return 0===t.length?Mt.none():Mt.some(t[t.length-1])}(Bt(e,"tr")).bind((function(t){return Ze(t,"td,th").map((function(t){return ol(0,t)}))}))}function ul(t,e,n,r){return void 0===r&&(r=Jl),t.property().parent(e).map((function(t){return $l(t,r)}))}function cl(t){return function(e){return 0===t.property().children(e).length}}function al(t,e){return function(t,e,n){return of(t,e,cl(t),n)}(cf,t,e)}function ll(t,e){return function(t,e,n){return uf(t,e,cl(t),n)}(cf,t,e)}function fl(t){return tn(t,"tr")}function sl(t){return"br"===te(t)}function dl(t,e,n,r){return function(t,e){return St(t,e).filter(sl).orThunk((function(){return St(t,e-1).filter(sl)}))}(e,n).bind((function(e){return r.traverse(e).fold((function(){return df(e,r.gather,t).map(r.relative)}),(function(t){return function(t){return vt(t).bind((function(e){var n=Ct(e);return sf(n,t).map((function(r){return ff(e,n,t,r)}))}))}(t).map((function(t){return Bl.on(t.parent(),t.index())}))}))}))}function ml(t){return hf.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})}function gl(t,e){return Mt.some(t.getRect(e))}function pl(t,n,r){return function(t,e,n){return Xe((function(t,e){return e(t)}),$e,t,e,n)}(n,uc).fold(e(!1),(function(e){return bf(t,e).exists((function(t){return function(t,e){return t.left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right()}(r,t)}))}))}function hl(t,e,n){var r=t.move(n,5),o=Sf(e,t,n,r,100).getOr(r);return function(t,e,n){return t.point(e)>n.getInnerHeight()?Mt.some(t.point(e)-n.getInnerHeight()):t.point(e)<0?Mt.some(-t.point(e)):Mt.none()}(t,o,e).fold((function(){return e.situsFromPoint(o.left(),t.point(o))}),(function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)}))}function vl(t,e){return function(t,e,n){return $e(t,e,n).isSome()}(t,(function(t){return vt(t).exists((function(t){return Ie(t,e)}))}))}function bl(t,n,r,o,i){return tn(o,"td,th",n).bind((function(o){return tn(o,"table",n).bind((function(u){return vl(i,u)?Ef(t,n,r).bind((function(t){return tn(t.finish(),"td,th",n).map((function(n){return{start:e(o),finish:e(n),range:e(t)}}))})):Mt.none()}))}))}function wl(t,e){return tn(t,"td,th",e)}var yl=function(e,n,r){function o(){f.stop(),c.isOn()&&(c.off(),u.trigger.stop())}var i=!1,u=ma.create({start:da([]),stop:da([])}),c=xa(),a=function(e,n){var r=null;return{cancel:function(){null!==r&&(t.clearTimeout(r),r=null)},throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null!==r&&t.clearTimeout(r),r=t.setTimeout((function(){e.apply(null,o),r=null}),n)}}}(o,200);function l(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];i&&t.apply(null,e)}}c.events.move.bind((function(t){n.mutate(e,t.info())}));var f=n.sink(ya({forceDrop:o,drop:l(o),move:l((function(t){a.cancel(),c.onEvent(t,n)})),delayDrop:l(a.throttle)}),r);return{element:f.element,go:function(t){f.start(t),c.on(),u.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){f.destroy()},events:u.registry}},Cl=function(t,e){void 0===e&&(e={});var n=void 0!==e.mode?e.mode:Ca;return yl(t,n,e)},Sl=nu.resolve("resizer-bar-dragging"),xl=function(t,e){var n=po.height,r=Oa(t,e,n),o=ma.create({beforeResize:da(["table"]),afterResize:da(["table"]),startDrag:da([])});return r.events.adjustHeight.bind((function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());Ku(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())})),r.events.startAdjust.bind((function(t){o.trigger.startDrag()})),r.events.adjustWidth.bind((function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());Yu(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}},Rl=function(t,e){return t.inline?sa(gc(t),function(){var t=oe.fromTag("div");return rt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Me(ie(),t),t}()):fa(oe.fromDom(t.getDoc()))},Tl=function(t,e){t.inline&&We(e.parent())},Ol=function(t){function e(t){return"TABLE"===t.nodeName}function n(e){var n=t.dom.getStyle(e,"width")||t.dom.getAttrib(e,"width");return Mt.from(n).filter((function(t){return 0<t.length}))}function r(){return c}var o,i,u=Mt.none(),c=Mt.none(),a=Mt.none(),l=/(\d+(\.\d+)?)%/;return t.on("init",(function(){var e=vo(bc.directionAt),n=Rl(t);if(a=Mt.some(n),function(t){var e=t.getParam("object_resizing",!0);return _t(e)?"table"===e:e}(t)&&function(t){return t.getParam("table_resize_bars",!0,"boolean")}(t)){var r=xl(n,e);r.on(),r.events.startDrag.bind((function(e){u=Mt.some(t.selection.getRng())})),r.events.beforeResize.bind((function(e){var n=e.table().dom();Ii(t,n,bi(n),wi(n))})),r.events.afterResize.bind((function(e){var n=e.table(),r=n.dom();Ci(n),u.each((function(e){t.selection.setRng(e),t.focus()})),Bi(t,r,bi(r),wi(r)),t.undoManager.add()})),c=Mt.some(r)}})),t.on("ObjectResizeStart",(function(r){var u=r.target;if(e(u)){var c=n(u).map((function(t){return l.test(t)})).getOr(!1);c&&Ei(t)?function(t){nt(oe.fromDom(t),"width",bi(t).toString()+"px")}(u):!c&&function(t){return!0===t.getParam("table_responsive_width")}(t)&&function(t){var e=oe.fromDom(t);vt(e).map((function(t){return Da(e,t)})).each((function(t){nt(e,"width",t),w(Bt(e,"tr"),(function(t){w(Ct(t),(function(e){nt(e,"width",Da(e,t))}))}))}))}(u),o=r.width,i=n(u).getOr("")}})),t.on("ObjectResized",(function(n){var r=n.target;if(e(r)){var u=r;if(l.test(i)){var c=parseFloat(l.exec(i)[1]),a=n.width*c/o;t.dom.setStyle(u,"width",a+"%")}else{var f=[];Ic.each(u.rows,(function(e){Ic.each(e.cells,(function(e){var n=t.dom.getStyle(e,"width",!0);f.push({cell:e,width:n})}))})),Ic.each(f,(function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)}))}}})),t.on("SwitchMode",(function(){r().each((function(e){t.mode.isReadOnly()?e.hideBars():e.showBars()}))})),{lazyResize:r,lazyWire:function(){return a.getOr(fa(oe.fromDom(t.getBody())))},destroy:function(){c.each((function(t){t.destroy()})),a.each((function(e){Tl(t,e)}))}}},Dl=xr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Al=le(le({},Dl),{none:function(t){return void 0===t&&(t=void 0),Dl.none(t)}}),El=function(t,e){return Aa(t,e).fold((function(){return Al.none(t)}),(function(e){return e.index()+1<e.all().length?Al.middle(t,e.all()[e.index()+1]):Al.last(t)}))},Nl=function(t,e){return Aa(t,e).fold((function(){return Al.none()}),(function(e){return 0<=e.index()-1?Al.middle(t,e.all()[e.index()-1]):Al.first(t)}))},kl={create:B("start","soffset","finish","foffset")},Il=xr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Bl={before:Il.before,on:Il.on,after:Il.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(n,n,n)}},Pl=xr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ml={domRange:Pl.domRange,relative:Pl.relative,exact:Pl.exact,exactFromRange:function(t){return Pl.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){return function(t){return oe.fromDom(t.dom().ownerDocument.defaultView)}(function(t){return t.match({domRange:function(t){return oe.fromDom(t.startContainer)},relative:function(t,e){return Bl.getStart(t)},exact:function(t,e,n,r){return t}})}(t))},range:kl.create},Wl=function(t,e){t.selectNodeContents(e.dom())},_l=xr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ll=function(t,e){return Ba(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},jl=(_l.ltr,_l.rtl,function(t,e,n,r){return ne(e)?function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return E(i,(function(t){return Pa(t,n,r)?Mt.some(t):Mt.none()})).map((function(o){return Ma(t,e,n,r,o)}))}(t,e,n,r):function(t,e,n,r){var o=t.dom().createRange(),i=Ct(e);return E(i,(function(e){return o.selectNode(e.dom()),Pa(o.getBoundingClientRect(),n,r)?jl(t,e,n,r):Mt.none()}))}(t,e,n,r)}),zl=document.caretPositionFromPoint?function(t,e,n){return Mt.from(t.dom().caretPositionFromPoint(e,n)).bind((function(e){if(null===e.offsetNode)return Mt.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),Mt.some(n)}))}:document.caretRangeFromPoint?function(t,e,n){return Mt.from(t.dom().caretRangeFromPoint(e,n))}:function(t,e,n){return oe.fromPoint(t,e,n).bind((function(r){function o(){return function(t,e,n){return(0===Ct(e).length?ja:La)(t,e,n)}(t,r,e)}return 0===Ct(r).length?o():za(t,r,e,n).orThunk(o)}))},Hl=tinymce.util.Tools.resolve("tinymce.util.VK"),Fl=function(t,e,n,r,o){return n.fold(Mt.none,Mt.none,(function(t,e){return Sn(e).map((function(t){return ol(0,t)}))}),(function(n){return fn.table(n,e).bind((function(e){var o=Nr.noMenu(n);return t.undoManager.transact((function(){r.insertRowsAfter(e,o)})),il(0,e)}))}))},Ul=["table","li","dl"],ql={handle:function(t,e,n,r){if(t.keyCode===Hl.TAB){var o=gc(e),i=function(t){var e=te(t);return Ie(t,o)||h(Ul,e)},u=e.selection.getRng();if(u.collapsed){var c=oe.fromDom(u.startContainer);fn.cell(c,i).each((function(o){t.preventDefault(),(t.shiftKey?rl:nl)(e,i,o,n,r).each((function(t){e.selection.setRng(t)}))}))}}}},Vl={create:B("selection","kill")},Gl=function(t,n,r,o){return{start:e(Bl.on(t,n)),finish:e(Bl.on(r,o))}},Yl={convertToRange:function(t,e){var n=Ll(t,e);return kl.create(oe.fromDom(n.startContainer),n.startOffset,oe.fromDom(n.endContainer),n.endOffset)},makeSitus:Gl},Kl=function(t,e,n,r,o){return Ie(n,r)?Mt.none():mr(n,r,e).bind((function(e){var r=e.boxes().getOr([]);return 0<r.length?(o(t,r,e.start(),e.finish()),Mt.some(Vl.create(Mt.some(Yl.makeSitus(n,0,n,yn(n))),!0))):Mt.none()}))},Xl={sync:function(t,e,n,r,o,i,u){return Ie(n,o)&&r===i?Mt.none():tn(n,"td,th",e).bind((function(n){return tn(o,"td,th",e).bind((function(r){return Kl(t,e,n,r,u)}))}))},detect:Kl,update:function(t,e,n,r,o){return pr(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map((function(t){return o.clearBeforeUpdate(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()}))}},$l=B("item","mode"),Jl=function(t,e,n,r){return void 0===r&&(r=Ql),n.sibling(t,e).map((function(t){return $l(t,r)}))},Ql=function(t,e,n,r){void 0===r&&(r=Ql);var o=t.property().children(e);return n.first(o).map((function(t){return $l(t,r)}))},Zl=[{current:ul,next:Jl,fallback:Mt.none()},{current:Jl,next:Ql,fallback:Mt.some(ul)},{current:Ql,next:Ql,fallback:Mt.some(Jl)}],tf=function(t,e,n,r,o){return void 0===o&&(o=Zl),x(o,(function(t){return t.current===n})).bind((function(n){return n.current(t,e,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return tf(t,e,n,r)}))}))}))},ef=function(){return{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return 0<t.length?Mt.some(t[t.length-1]):Mt.none()}}},nf=function(){return{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return 0<t.length?Mt.some(t[0]):Mt.none()}}},rf=function(t,e,n,r,o,i){return tf(t,e,r,o).bind((function(e){return i(e.item())?Mt.none():n(e.item())?Mt.some(e.item()):rf(t,e.item(),n,e.mode(),o,i)}))},of=function(t,e,n,r){return rf(t,e,n,Jl,ef(),r)},uf=function(t,e,n,r){return rf(t,e,n,Jl,nf(),r)},cf=Jn(),af=xr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),lf=le(le({},af),{verify:function(t,e,n,r,o,i,u){return tn(r,"td,th",u).bind((function(n){return tn(e,"td,th",u).map((function(e){return Ie(n,e)?Ie(r,n)&&yn(n)===o?i(e):af.none("in same cell"):sr.sharedOne(fl,[n,e]).fold((function(){return function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right}(t,e,n)?af.success():i(e)}),(function(t){return i(e)}))}))})).getOr(af.none("default"))},cata:function(t,e,n,r,o){return t.fold(e,n,r,o)}}),ff=(B("ancestor","descendants","element","index"),B("parent","children","element","index")),sf=function(t,e){return R(t,i(Ie,e))},df=function(t,e,n){return e(t,n).bind((function(t){return ne(t)&&0===vn(t).trim().length?df(t,e,n):Mt.some(t)}))},mf=function(t,n,r,o){return(sl(n)?function(t,e,n){return n.traverse(e).orThunk((function(){return df(e,n.gather,t)})).map(n.relative)}(t,n,o):dl(t,n,r,o)).map((function(t){return{start:e(t),finish:e(t)}}))},gf=function(t){return lf.cata(t,(function(t){return Mt.none()}),(function(){return Mt.none()}),(function(t){return Mt.some(Tc(t,0))}),(function(t){return Mt.some(Tc(t,yn(t)))}))},pf=Xt(["left","top","right","bottom"],[]),hf={nu:pf,moveUp:function(t,e){return pf({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},moveDown:function(t,e){return pf({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},moveBottomTo:function(t,e){var n=t.bottom()-t.top();return pf({left:t.left(),top:e-n,right:t.right(),bottom:e})},moveTopTo:function(t,e){var n=t.bottom()-t.top();return pf({left:t.left(),top:e,right:t.right(),bottom:e+n})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,e,n){return pf({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},vf=function(t,e,n){return ee(e)?gl(t,e).map(ml):ne(e)?function(t,e,n){return 0<=n&&n<yn(e)?t.getRangedRect(e,n,e,n+1):0<n?t.getRangedRect(e,n-1,e,n):Mt.none()}(t,e,n).map(ml):Mt.none()},bf=function(t,e){return ee(e)?gl(t,e).map(ml):ne(e)?t.getRangedRect(e,0,e,yn(e)).map(ml):Mt.none()},wf=xr([{none:[]},{retry:["caret"]}]),yf={point:hf.getTop,adjuster:function(t,e,n,r,o){var i=hf.moveUp(o,5);return Math.abs(n.top()-r.top())<1||n.bottom()<o.top()?wf.retry(i):n.bottom()===o.top()?wf.retry(hf.moveUp(o,1)):pl(t,e,o)?wf.retry(hf.translate(i,5,0)):wf.none()},move:hf.moveUp,gather:al},Cf={point:hf.getBottom,adjuster:function(t,e,n,r,o){var i=hf.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1||n.top()>o.bottom()?wf.retry(i):n.top()===o.bottom()?wf.retry(hf.moveDown(o,1)):pl(t,e,o)?wf.retry(hf.translate(i,5,0)):wf.none()},move:hf.moveDown,gather:ll},Sf=function(t,e,n,r,o){return 0===o?Mt.some(r):function(t,e,n){return t.elementFromPoint(e,n).filter((function(t){return"table"===te(t)})).isSome()}(t,r.left(),e.point(r))?function(t,e,n,r,o){return Sf(t,e,n,e.move(r,5),o)}(t,e,n,r,o-1):t.situsFromPoint(r.left(),e.point(r)).bind((function(i){return i.start().fold(Mt.none,(function(i){return bf(t,i).bind((function(u){return e.adjuster(t,i,u,n,r).fold(Mt.none,(function(r){return Sf(t,e,n,r,o-1)}))})).orThunk((function(){return Mt.some(r)}))}),Mt.none)}))},xf={tryUp:i(hl,yf),tryDown:i(hl,Cf),ieTryUp:function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},getJumpSize:e(5)},Rf=mt(),Tf=function(t,e,n,r,o,i){return 0===i?Mt.none():Af(t,e,n,r,o).bind((function(u){var c=t.fromSitus(u),a=lf.verify(t,n,r,c.finish(),c.foffset(),o.failure,e);return lf.cata(a,(function(){return Mt.none()}),(function(){return Mt.some(u)}),(function(u){return Ie(n,u)&&0===r?Of(t,n,r,hf.moveUp,o):Tf(t,e,u,0,o,i-1)}),(function(u){return Ie(n,u)&&r===yn(u)?Of(t,n,r,hf.moveDown,o):Tf(t,e,u,yn(u),o,i-1)}))}))},Of=function(t,e,n,r,o){return vf(t,e,n).bind((function(e){return Df(t,o,r(e,xf.getJumpSize()))}))},Df=function(t,e,n){return Rf.browser.isChrome()||Rf.browser.isSafari()||Rf.browser.isFirefox()||Rf.browser.isEdge()?e.otherRetry(t,n):Rf.browser.isIE()?e.ieRetry(t,n):Mt.none()},Af=function(t,e,n,r,o){return vf(t,n,r).bind((function(e){return Df(t,o,e)}))},Ef=function(t,e,n){return function(t,e,n){return t.getSelection().bind((function(r){return mf(e,r.finish(),r.foffset(),n).fold((function(){return Mt.some(Tc(r.finish(),r.foffset()))}),(function(o){var i=t.fromSitus(o),u=lf.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,e);return gf(u)}))}))}(t,e,n).bind((function(r){return Tf(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)}))},Nf=mt(),kf=function(t,e,n,r,o,i){return Nf.browser.isIE()?Mt.none():i(r,e).orThunk((function(){return bl(t,e,n,r,o).map((function(t){var e=t.range();return Vl.create(Mt.some(Yl.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)}))}))},If=function(t,e,n,r,o,i,u){return bl(t,n,r,o,i).bind((function(t){return Xl.detect(e,n,t.start(),t.finish(),u)}))},Bf=function(t,e){return tn(t,"tr",e).bind((function(t){return tn(t,"table",e).bind((function(n){var r=Bt(n,"tr");return Ie(t,r[0])?function(t,e,n){return of(cf,t,e,n)}(n,(function(t){return xn(t).isSome()}),e).map((function(t){var e=yn(t);return Vl.create(Mt.some(Yl.makeSitus(t,e,t,e)),!0)})):Mt.none()}))}))},Pf=function(t,e){return tn(t,"tr",e).bind((function(t){return tn(t,"table",e).bind((function(n){var r=Bt(n,"tr");return Ie(t,r[r.length-1])?function(t,e,n){return uf(cf,t,e,n)}(n,(function(t){return Sn(t).isSome()}),e).map((function(t){return Vl.create(Mt.some(Yl.makeSitus(t,0,t,0)),!0)})):Mt.none()}))}))};function Mf(t){return function(e){return e===t}}function Wf(e){return{elementFromPoint:function(t,n){return oe.fromPoint(oe.fromDom(e.document),t,n)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=Ml.exact(t,n,r,o);return tl(e,i).map(Ff)},getSelection:function(){return Za(e).map((function(t){return Yl.convertToRange(e,t)}))},fromSitus:function(t){var n=Ml.relative(t.start(),t.finish());return Yl.convertToRange(e,n)},situsFromPoint:function(t,n){return el(e,t,n).map((function(t){return Gl(t.start(),t.soffset(),t.finish(),t.foffset())}))},clearSelection:function(){!function(t){t.getSelection().removeAllRanges()}(e)},collapseSelection:function(t){void 0===t&&(t=!1),Za(e).each((function(n){return n.fold((function(e){return e.collapse(t)}),(function(n,r){var o=t?n:r;Xa(e,o,o)}),(function(n,r,o,i){var u=t?n:o,c=t?r:i;Ka(e,u,c,u,c)}))}))},setSelection:function(t){Ka(e,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,n){Xa(e,t,n)},selectContents:function(t){Qa(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){return function(e){var n=void 0!==e?e.dom():t.document,r=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return fo(r,o)}(oe.fromDom(e.document)).top()},scrollBy:function(n,r){!function(e,n,r){(void 0!==r?r.dom():t.document).defaultView.scrollBy(e,n)}(n,r,oe.fromDom(e.document))}}}function _f(t,e){w(e,(function(e){!function(t,e){Co(t)?t.dom().classList.remove(e):xo(t,e),To(t)}(t,e)}))}var Lf={down:{traverse:yt,gather:ll,relative:Bl.before,otherRetry:xf.tryDown,ieRetry:xf.ieTryDown,failure:lf.failedDown},up:{traverse:wt,gather:al,relative:Bl.before,otherRetry:xf.tryUp,ieRetry:xf.ieTryUp,failure:lf.failedUp}},jf=Mf(38),zf=Mf(40),Hf={ltr:{isBackward:Mf(37),isForward:Mf(39)},rtl:{isBackward:Mf(39),isForward:Mf(37)},isUp:jf,isDown:zf,isNavigation:function(t){return 37<=t&&t<=40}},Ff=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},Uf=(mt().browser.isSafari(),B("rows","cols")),qf={mouse:function(t,e,n,r){var o=function(t,e,n,r){function o(){i=Mt.none()}var i=Mt.none();return{mousedown:function(t){r.clear(e),i=wl(t.target(),n)},mouseover:function(o){i.each((function(i){r.clearBeforeUpdate(e),wl(o.target(),n).each((function(o){mr(i,o,n).each((function(n){var u=n.boxes().getOr([]);(1<u.length||1===u.length&&!Ie(i,o))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(o))}))}))}))},mouseup:function(t){i.each(o)}}}(Wf(t),e,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,e,n,r){function o(){return r.clear(e),Mt.none()}var u=Wf(t);return{keydown:function(t,c,a,l,f,s){var d=t.raw(),m=d.which,g=!0===d.shiftKey;return gr(e,r.selectedSelector()).fold((function(){return Hf.isDown(m)&&g?i(If,u,e,n,Lf.down,l,c,r.selectRange):Hf.isUp(m)&&g?i(If,u,e,n,Lf.up,l,c,r.selectRange):Hf.isDown(m)?i(kf,u,n,Lf.down,l,c,Pf):Hf.isUp(m)?i(kf,u,n,Lf.up,l,c,Bf):Mt.none}),(function(t){function n(n){return function(){return E(n,(function(n){return Xl.update(n.rows(),n.cols(),e,t,r)})).fold((function(){return hr(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map((function(t){var n=Hf.isDown(m)||s.isForward(m)?Bl.after:Bl.before;return u.setRelativeSelection(Bl.on(t.first(),0),n(t.table())),r.clear(e),Vl.create(Mt.none(),!0)}))}),(function(t){return Mt.some(Vl.create(Mt.none(),!0))}))}}return Hf.isDown(m)&&g?n([Uf(1,0)]):Hf.isUp(m)&&g?n([Uf(-1,0)]):s.isBackward(m)&&g?n([Uf(0,-1),Uf(-1,0)]):s.isForward(m)&&g?n([Uf(0,1),Uf(1,0)]):Hf.isNavigation(m)&&0==g?o:Mt.none}))()},keyup:function(t,o,i,u,c){return gr(e,r.selectedSelector()).fold((function(){var a=t.raw(),l=a.which;return 0==(!0===a.shiftKey)?Mt.none():Hf.isNavigation(l)?Xl.sync(e,n,o,i,u,c,r.selectRange):Mt.none()}),Mt.none)}}},external:function(t,e,n,r){var o=Wf(t);return function(t,i){r.clearBeforeUpdate(e),mr(t,i,n).each((function(t){var n=t.boxes().getOr([]);r.selectRange(e,n,t.start(),t.finish()),o.selectContents(i),o.collapseSelection()}))}}},Vf={byClass:function(t){function e(e){var n=Bt(e,t.selectedSelector());w(n,r)}var n=function(t){return function(e){Ro(e,t)}}(t.selected()),r=function(t){return function(e){_f(e,t)}}([t.selected(),t.lastSelected(),t.firstSelected()]);return{clearBeforeUpdate:e,clear:e,selectRange:function(r,o,i,u){e(r),w(o,n),Ro(i,t.firstSelected()),Ro(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t,e,n){function r(e){Y(e,t.selected()),Y(e,t.firstSelected()),Y(e,t.lastSelected())}function o(e){U(e,t.selected(),"1")}function i(t){u(t),n()}var u=function(e){var n=Bt(e,t.selectedSelector());w(n,r)};return{clearBeforeUpdate:u,clear:i,selectRange:function(n,r,u,c){i(n),w(r,o),U(u,t.firstSelected(),"1"),U(c,t.lastSelected(),"1"),e(r,u,c)},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}},Gf={getOtherCells:function(t,e,n){var r=sn(t),o=gn.generate(r);return Fo(o,e).map((function(t){var e=bu(o,n,!1);return{upOrLeftCells:function(t,e,n){var r=t.slice(0,e[e.length-1].row()+1),o=_o(r,n);return O(o,(function(t){var n=t.cells().slice(0,e[e.length-1].column()+1);return b(n,(function(t){return t.element()}))}))}(e,t,n),downOrRightCells:function(t,e,n){var r=t.slice(e[0].row()+e[0].rowspan()-1,t.length),o=_o(r,n);return O(o,(function(t){var n=t.cells().slice(e[0].column()+e[0].colspan()-1,+t.cells().length);return b(n,(function(t){return t.element()}))}))}(e,t,n)}}))}},Yf=function(t){return!1===Oo(oe.fromDom(t.target),"ephox-snooker-resizer-bar")};function Kf(t,e,n){var i=Xt(["mousedown","mouseover","mouseup","keyup","keydown"],[]),u=Mt.none(),c=Sc(t),a=Vf.byAttr(Sr,(function(e,r,i){n.targets().each((function(n){fn.table(r).each((function(u){var a=oe.fromDom(t.getDoc()),l=_n.cellOperations(o,a,c),f=Gf.getOtherCells(u,n,l);xc(t,e,r,i,f)}))}))}),(function(){Rc(t)}));return t.on("init",(function(n){var c=t.getWin(),l=gc(t),f=pc(t),s=qf.mouse(c,l,f,a),d=qf.keyboard(c,l,f,a),m=qf.external(c,l,f,a);function g(e,n){!function(t){return!0===t.raw().shiftKey}(e)||(n.kill()&&e.kill(),n.selection().each((function(e){var n=Ml.relative(e.start(),e.finish()),r=Ll(c,n);t.selection.setRng(r)})))}function p(e){var n=ha(e);if(n.raw().shiftKey&&Hf.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=oe.fromDom(r.startContainer),i=oe.fromDom(r.endContainer);d.keyup(n,o,r.startOffset,i,r.endOffset).each((function(t){g(n,t)}))}}function h(n){var r=ha(n);e().each((function(t){t.hideBars()}));var o=t.selection.getRng(),i=oe.fromDom(t.selection.getStart()),u=oe.fromDom(o.startContainer),c=oe.fromDom(o.endContainer),a=bc.directionAt(i).isRtl()?Hf.rtl:Hf.ltr;d.keydown(r,u,o.startOffset,c,o.endOffset,a).each((function(t){g(r,t)})),e().each((function(t){t.showBars()}))}function v(t){return 0===t.button}function b(t){v(t)&&Yf(t)&&s.mousedown(ha(t))}function w(t){(function(t){return void 0===t.buttons||!(!ta.browser.isEdge()||0!==t.buttons)||0!=(1&t.buttons)})(t)&&Yf(t)&&s.mouseover(ha(t))}function y(t){v(t)&&Yf(t)&&s.mouseup(ha(t))}t.on("TableSelectorChange",(function(t){m(t.start,t.finish)}));var C,S,x=(C=r(oe.fromDom(l)),S=r(0),{touchEnd:function(t){var e=oe.fromDom(t.target);if("td"===te(e)||"th"===te(e)){var n=C.get(),r=S.get();Ie(n,e)&&t.timeStamp-r<300&&(t.preventDefault(),m(e,e))}C.set(e),S.set(t.timeStamp)}});t.on("mousedown",b),t.on("mouseover",w),t.on("mouseup",y),t.on("touchend",x.touchEnd),t.on("keyup",p),t.on("keydown",h),t.on("NodeChange",(function(){var e=t.selection,n=oe.fromDom(e.getStart()),r=oe.fromDom(e.getEnd());sr.sharedOne(fn.table,[n,r]).fold((function(){a.clear(l)}),o)})),u=Mt.some(i({mousedown:b,mouseover:w,mouseup:y,keyup:p,keydown:h}))})),{clear:a.clear,destroy:function(){u.each((function(t){}))}}}var Xf=function(t){return{get:function(){var e=gc(t);return vr(e,Sr.selectedSelector()).fold((function(){return void 0===t.selection.getStart()?Tr.none():Tr.single(t.selection)}),(function(t){return Tr.multiple(t)}))}}},$f=function(t,e){function n(){return ca(t).bind((function(t){return fn.table(t).map((function(n){return"caption"===te(t)?Nr.notCell(t):Nr.forMenu(e,n,t)}))}))}function o(){u.set(Z(n)()),w(c.get(),(function(t){return t()}))}function i(t,e){function n(){return u.get().fold((function(){t.setDisabled(!0)}),(function(n){t.setDisabled(e(n))}))}return n(),c.set(c.get().concat([n])),function(){c.set(y(c.get(),(function(t){return t!==n})))}}var u=r(Mt.none()),c=r([]);return t.on("NodeChange TableSelectorChange",o),{onSetupTable:function(t){return i(t,(function(t){return!1}))},onSetupCellOrRow:function(t){return i(t,(function(t){return"caption"===te(t.element())}))},onSetupMergeable:function(t){return i(t,(function(t){return t.mergable().isNone()}))},onSetupUnmergeable:function(t){return i(t,(function(t){return t.unmergable().isNone()}))},resetTargets:o,targets:function(){return u.get()}}},Jf={addButtons:function(t,e){function n(e){return function(){return t.execCommand(e)}}t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable | cell row column | advtablesort | tableprops deletetable")}}),t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:n("mceTableProps"),icon:"table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:n("mceTableDelete"),icon:"table-delete-table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:n("mceTableCellProps"),icon:"table-cell-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:n("mceTableMergeCells"),icon:"table-merge-cells",onSetup:e.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:n("mceTableSplitCells"),icon:"table-split-cells",onSetup:e.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:n("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:n("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:n("mceTableDeleteRow"),icon:"table-delete-row",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:n("mceTableRowProps"),icon:"table-row-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:n("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:n("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:n("mceTableDeleteCol"),icon:"table-delete-column",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:n("mceTableCutRow"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:n("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:n("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:n("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:n("mceInsertTable"),icon:"table"})},addToolbars:function(t){var e=function(t){return t.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(t);0<e.length&&t.ui.registry.addContextToolbar("table",{predicate:function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},items:e,scope:"node",position:"node"})}},Qf={addMenuItems:function(t,e){function n(e){return function(){return t.execCommand(e)}}function r(e){var n=e.numRows,r=e.numColumns;t.undoManager.transact((function(){na(t,r,n)})),t.addVisual()}var o={text:"Table properties",onSetup:e.onSetupTable,onAction:n("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:e.onSetupTable,onAction:n("mceTableDelete")},u=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:n("mceTableInsertRowBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:n("mceTableInsertRowAfter"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:n("mceTableDeleteRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:n("mceTableRowProps"),onSetup:e.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:n("mceTableCutRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:n("mceTableCopyRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:n("mceTablePasteRowBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:n("mceTablePasteRowAfter"),onSetup:e.onSetupCellOrRow}],c={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return u}},a=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:n("mceTableInsertColBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:n("mceTableInsertColAfter"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:n("mceTableDeleteCol"),onSetup:e.onSetupCellOrRow}],l={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return a}},f=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:n("mceTableCellProps"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:n("mceTableMergeCells"),onSetup:e.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:n("mceTableSplitCells"),onSetup:e.onSetupUnmergeable}],s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return f}};!1===function(t){return t.getParam("table_grid",!0,"boolean")}(t)?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:n("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:n("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",c),t.ui.registry.addNestedMenuItem("column",l),t.ui.registry.addNestedMenuItem("cell",s),t.ui.registry.addContextMenu("table",{update:function(){return e.resetTargets(),e.targets().fold((function(){return""}),(function(t){return"caption"===te(t.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}},Zf=function(t,e,n,r){return{insertTable:function(e,n){return na(t,e,n)},setClipboardRows:function(t){return function(t,e){var n=b(t,oe.fromDom);e.set(Mt.from(n))}(t,e)},getClipboardRows:function(){return function(t){return t.get().fold((function(){}),(function(t){return b(t,(function(t){return t.dom()}))}))}(e)},resizeHandler:n,selectionTargets:r}};function ts(t){var e=Xf(t),n=$f(t,e),o=Ol(t),i=Kf(t,o.lazyResize,n),u=Nc(t,o.lazyWire),c=r(Mt.none());return la.registerCommands(t,u,i,e,c),kr.registerEvents(t,e,u,i),Qf.addMenuItems(t,n),Jf.addButtons(t,n),Jf.addToolbars(t),t.on("PreInit",(function(){t.serializer.addTempAttr(Sr.firstSelected()),t.serializer.addTempAttr(Sr.lastSelected())})),Cc(t)&&t.on("keydown",(function(e){ql.handle(e,t,u,o.lazyWire)})),t.on("remove",(function(){o.destroy(),i.destroy()})),Zf(t,c,o,n)}!function(){Wt.add("table",ts)}()}(window);