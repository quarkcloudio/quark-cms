!function(e){"use strict";function n(){}function r(e){return function(){return e}}function t(){return p}var o,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=0,s=function(e,n,r){e.plugins.table?e.plugins.table.insertTable(n,r):function(e,n,r){e.undoManager.transact((function(){var t,o;e.insertContent(function(e,n){var r,t,o;for(o='<table data-mce-id="mce" style="width: 100%">',o+="<tbody>",t=0;t<n;t++){for(o+="<tr>",r=0;r<e;r++)o+="<td><br></td>";o+="</tr>"}return o+="</tbody>",o+"</table>"}(n,r)),(t=function(e){return e.dom.select("*[data-mce-id]")[0]}(e)).removeAttribute("data-mce-id"),o=e.dom.select("td,th",t),e.selection.setCursorLocation(o[0],0)}))}(e,n,r)},c=function(e,n,r){var t,o;o=(t=e.editorUpload.blobCache).create(function(e){var n=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++u+String(n)}("mceu"),r,n),t.add(o),e.insertContent(e.dom.createHTML("img",{src:o.blobUri()}))},a=tinymce.util.Tools.resolve("tinymce.util.Promise"),f=function(n){return new a((function(r){var t=new e.FileReader;t.onloadend=function(){r(t.result.split(",")[1])},t.readAsDataURL(n)}))},d=tinymce.util.Tools.resolve("tinymce.Env"),l=tinymce.util.Tools.resolve("tinymce.util.Delay"),m=function(n){return new a((function(r){var t=e.document.createElement("input");t.type="file",t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.opacity="0.001",e.document.body.appendChild(t),t.addEventListener("change",(function(e){r(Array.prototype.slice.call(e.target.files))}));var o=function(e){function i(){r([]),t.parentNode.removeChild(t)}d.os.isAndroid()&&"remove"!==e.type?l.setEditorTimeout(n,i,0):i(),n.off("focusin remove",o)};n.on("focusin remove",o),t.click()}))},v=function(e){e.ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){m(e).then((function(n){if(0<n.length){var r=n[0];f(r).then((function(n){c(e,n,r)}))}}))}}),e.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){s(e,2,2)}})},g=r(!1),h=r(!0),p=(o={fold:function(e,n){return e()},is:g,isSome:g,isNone:h,getOr:N,getOrThunk:O,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:N,orThunk:O,map:t,each:n,bind:t,exists:g,forall:h,filter:t,equals:b,equals_:b,toArray:function(){return[]},toString:r("none()")},Object.freeze&&Object.freeze(o),o);function b(e){return e.isNone()}function O(e){return e()}function N(e){return e}function E(e){return function(n){return function(e){if(null===e)return"null";var n=typeof e;return"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n}(n)===e}}var w=function(e){function n(){return i}function t(n){return n(e)}var o=r(e),i={fold:function(n,r){return r(e)},is:function(n){return e===n},isSome:h,isNone:g,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(n){return w(n(e))},each:function(n){n(e)},bind:t,exists:t,forall:t,filter:function(n){return n(e)?i:p},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(n){return n.is(e)},equals_:function(n,r){return n.fold(g,(function(n){return r(e,n)}))}};return i},T={some:w,none:t,from:function(e){return null===e||void 0===e?p:w(e)}},y=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:r(e)}},S={fromHtml:function(n,r){var t=(r||e.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw e.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return y(t.childNodes[0])},fromTag:function(n,r){var t=(r||e.document).createElement(n);return y(t)},fromText:function(n,r){var t=(r||e.document).createTextNode(n);return y(t)},fromDom:y,fromPoint:function(e,n,r){var t=e.dom();return T.from(t.elementFromPoint(n,r)).map(y)}},x=(e.Node.ATTRIBUTE_NODE,e.Node.CDATA_SECTION_NODE,e.Node.COMMENT_NODE,e.Node.DOCUMENT_NODE,e.Node.DOCUMENT_TYPE_NODE,e.Node.DOCUMENT_FRAGMENT_NODE,e.Node.ELEMENT_NODE),k=(e.Node.TEXT_NODE,e.Node.PROCESSING_INSTRUCTION_NODE,e.Node.ENTITY_REFERENCE_NODE,e.Node.ENTITY_NODE,e.Node.NOTATION_NODE,"undefined"!=typeof e.window?e.window:Function("return this;")(),E("string")),C=E("object"),D=E("array"),_=E("boolean"),A=E("undefined"),R=E("function");Array.prototype.slice;function M(e,n,r,t,o){return e(r,t)?T.some(r):R(o)&&o(r)?T.none():n(r,t,o)}function I(e,n){var r=function(e,n){for(var r=0;r<e.length;r++){var t=e[r];if(t.test(n))return t}}(e,n);if(!r)return{major:0,minor:0};function t(e){return Number(n.replace(r,"$"+e))}return W(t(1),t(2))}function q(e,n){return function(){return n===e}}function L(e,n){return function(){return n===e}}function P(e,n){var r=String(n).toLowerCase();return function(e,n){for(var r=0,t=e.length;r<t;r++){var o=e[r];if(n(o,r))return T.some(o)}return T.none()}(e,(function(e){return e.search(r)}))}function F(e,n){return-1!==e.indexOf(n)}function U(e){return function(n){return F(n,e)}}function B(e,n){var r=e.dom();if(r.nodeType!==de)return!1;var t=r;if(void 0!==t.matches)return t.matches(n);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(n);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(n);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function j(e,n,t){for(var o=e.dom(),i=R(t)?t:r(!1);o.parentNode;){o=o.parentNode;var u=S.fromDom(o);if(n(u))return T.some(u);if(i(u))break}return T.none()}function H(e,n,r){return j(e,(function(e){return B(e,n)}),r)}R(Array.from)&&Array.from;var X,z=function(e){function n(){return r}var r=e;return{get:n,set:function(e){r=e},clone:function(){return z(n())}}},G=function(){return W(0,0)},W=function(e,n){return{major:e,minor:n}},Y={nu:W,detect:function(e,n){var r=String(n).toLowerCase();return 0===e.length?G():I(e,r)},unknown:G},$="Firefox",V=function(e){var n=e.current;return{current:n,version:e.version,isEdge:q("Edge",n),isChrome:q("Chrome",n),isIE:q("IE",n),isOpera:q("Opera",n),isFirefox:q($,n),isSafari:q("Safari",n)}},J={unknown:function(){return V({current:void 0,version:Y.unknown()})},nu:V,edge:r("Edge"),chrome:r("Chrome"),ie:r("IE"),opera:r("Opera"),firefox:r($),safari:r("Safari")},K="Windows",Q="Android",Z="Solaris",ee="FreeBSD",ne="ChromeOS",re=function(e){var n=e.current;return{current:n,version:e.version,isWindows:L(K,n),isiOS:L("iOS",n),isAndroid:L(Q,n),isOSX:L("OSX",n),isLinux:L("Linux",n),isSolaris:L(Z,n),isFreeBSD:L(ee,n),isChromeOS:L(ne,n)}},te={unknown:function(){return re({current:void 0,version:Y.unknown()})},nu:re,windows:r(K),ios:r("iOS"),android:r(Q),linux:r("Linux"),osx:r("OSX"),solaris:r(Z),freebsd:r(ee),chromeos:r(ne)},oe=function(e,n){return P(e,n).map((function(e){var r=Y.detect(e.versionRegexes,n);return{current:e.name,version:r}}))},ie=function(e,n){return P(e,n).map((function(e){var r=Y.detect(e.versionRegexes,n);return{current:e.name,version:r}}))},ue=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return F(e,"edge/")&&F(e,"chrome")&&F(e,"safari")&&F(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ue],search:function(e){return F(e,"chrome")&&!F(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return F(e,"msie")||F(e,"trident")}},{name:"Opera",versionRegexes:[ue,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:U("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:U("firefox")},{name:"Safari",versionRegexes:[ue,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(F(e,"safari")||F(e,"mobile/"))&&F(e,"applewebkit")}}],ce=[{name:"Windows",search:U("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return F(e,"iphone")||F(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:U("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:U("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:U("linux"),versionRegexes:[]},{name:"Solaris",search:U("sunos"),versionRegexes:[]},{name:"FreeBSD",search:U("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:U("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],ae={browsers:r(se),oses:r(ce)},fe=z(function(e,n){var t=ae.browsers(),o=ae.oses(),i=oe(t,e).fold(J.unknown,J.nu),u=ie(o,e).fold(te.unknown,te.nu);return{browser:i,os:u,deviceType:function(e,n,t,o){var i=e.isiOS()&&!0===/ipad/i.test(t),u=e.isiOS()&&!i,s=e.isiOS()||e.isAndroid(),c=s||o("(pointer:coarse)"),a=i||!u&&s&&o("(min-device-width:768px)"),f=u||s&&!a,d=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(t),l=!f&&!a&&!d;return{isiPad:r(i),isiPhone:r(u),isTablet:r(a),isPhone:r(f),isTouch:r(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(d),isDesktop:r(l)}}(u,i,e,n)}}(e.navigator.userAgent,(function(n){return e.window.matchMedia(n).matches}))),de=x,le=(fe.get().browser.isIE(),{getToolbarItemsOr:(X=k,function(e,n,r){return function(e,n){if(!n(e))throw new Error("Default value doesn't match requested type.")}(r,X),function(e,n){if(D(e)||C(e))throw new Error("expected a string but found: "+e);return A(e)?n:_(e)?!1===e?"":n:e}(e.getParam(n,r),r)})}),me=function(e){return le.getToolbarItemsOr(e,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")},ve=function(e){return le.getToolbarItemsOr(e,"quickbars_insert_toolbar","quickimage quicktable")},ge=function(e){return le.getToolbarItemsOr(e,"quickbars_image_toolbar","alignleft aligncenter alignright")},he=function(e){var n=ve(e);0<n.trim().length&&e.ui.registry.addContextToolbar("quickblock",{predicate:function(n){function r(n){return n.dom()===e.getBody()}var t=S.fromDom(n),o=e.schema.getTextBlockElements();return function(e,n,r){return M(B,H,e,n,r)}(t,"table",r).fold((function(){return function(e,n,r){return M((function(e,n){return n(e)}),j,e,n,r)}(t,(function(n){return function(e){return e.dom().nodeName.toLowerCase()}(n)in o&&e.dom.isEmpty(n.dom())}),r).isSome()}),(function(){return!1}))},items:n,position:"line",scope:"editor"})},pe=function(e){function n(e){return"IMG"===e.nodeName||"FIGURE"===e.nodeName&&/image/i.test(e.className)}var r=ge(e);0<r.trim().length&&e.ui.registry.addContextToolbar("imageselection",{predicate:n,items:r,position:"node"});var t=me(e);0<t.trim().length&&e.ui.registry.addContextToolbar("textselection",{predicate:function(r){return!n(r)&&!e.selection.isCollapsed()&&function(n){return"false"!==e.dom.getContentEditableParent(n)}(r)},items:t,position:"selection",scope:"editor"})};!function(){i.add("quickbars",(function(e){v(e),he(e),pe(e)}))}()}(window);