!function(n){"use strict";var t=function(){return(t=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function e(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e}function r(){}function o(n){return n}var i=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(t.apply(null,e))}},u=function(n){return function(){return n}};function c(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}function a(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!n.apply(null,t)}}function f(n){return function(){throw new Error(n)}}function s(n){return n()}function l(){return p}var d,m=u(!1),g=u(!0),p=(d={fold:function(n,t){return n()},is:m,isSome:m,isNone:g,getOr:y,getOrThunk:h,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:u(null),getOrUndefined:u(void 0),or:y,orThunk:h,map:l,each:r,bind:l,exists:m,forall:g,filter:l,equals:v,equals_:v,toArray:function(){return[]},toString:u("none()")},Object.freeze&&Object.freeze(d),d);function v(n){return n.isNone()}function h(n){return n()}function y(n){return n}function b(n,t){return Cn(n,(function(n,e){return{k:e,v:t(n,e)}}))}function x(n,t){return Mn(n,t)&&void 0!==n[t]&&null!==n[t]}function w(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}}(n,t);if(!e)return{major:0,minor:0};function r(n){return Number(t.replace(e,"$"+n))}return Fn(r(1),r(2))}function S(n,t){return function(){return t===n}}function T(n,t){return function(){return t===n}}function O(n){return function(t){return function(n){if(null===n)return"null";var t=typeof n;return"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(t)===n}}function k(n,t){return-1<function(n,t){return rt.call(n,t)}(n,t)}function E(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return!0;return!1}function C(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e)}function D(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e}function _(n,t,e){return function(n,t){for(var e=n.length-1;0<=e;e--)t(n[e],e)}(n,(function(n){e=t(e,n)})),e}function M(n,t,e){return C(n,(function(n){e=t(e,n)})),e}function I(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return Tn.some(o)}return Tn.none()}function A(n,t){for(var e=0,r=n.length;e<r;e++)if(t(n[e],e))return Tn.some(e);return Tn.none()}function F(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!Qn(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);ot.apply(t,n[e])}return t}function R(n,t){return F(it(n,t))}function B(n,t){for(var e=0,r=n.length;e<r;++e)if(!0!==t(n[e],e))return!1;return!0}function V(n){var t=et.call(n,0);return t.reverse(),t}function N(n,t){return D(n,(function(n){return!k(t,n)}))}function j(n){return[n]}function H(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return Tn.none()}function P(n,t){var e=String(t).toLowerCase();return I(n,(function(n){return n.search(e)}))}function z(n,t){return-1!==n.indexOf(t)}function L(n){return function(t){return z(t,n)}}function G(){return dt.get()}function U(n,t){Lt(n,n.element(),t,{})}function $(n,t,e){Lt(n,n.element(),t,e)}function W(n){U(n,At())}function X(n,t,e){Lt(n,t,e,{})}function q(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}}function Y(n){return n.dom().nodeName.toLowerCase()}function K(n){return function(t){return function(n){return n.dom().nodeType}(t)===n}}function J(n){var t=Yt(n)?n.dom().parentNode:n.dom();return void 0!==t&&null!==t&&t.ownerDocument.body.contains(t)}function Q(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(n.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+t.length+" arguments");var r={};return C(n,(function(n,e){r[n]=u(t[e])})),r}}function Z(n){return n.slice(0).sort()}function nn(n,t){if(!Qn(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");C(t,(function(t){if(!Kn(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")}))}function tn(n,t){var e=n.concat(t);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return nn("required",n),nn("optional",t),function(n){var t=Z(n);I(t,(function(n,e){return e<t.length-1&&n===t[e+1]})).each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))}(e),function(r){var o=On(r);B(n,(function(n){return k(o,n)}))||function(n,t){throw new Error("All required keys ("+Z(n).join(", ")+") were not specified. Specified keys were: "+Z(t).join(", ")+".")}(n,o);var i=D(o,(function(n){return!k(e,n)}));0<i.length&&function(n){throw new Error("Unsupported keys for object: "+Z(n).join(", "))}(i);var c={};return C(n,(function(n){c[n]=u(r[n])})),C(t,(function(n){c[n]=u(Object.prototype.hasOwnProperty.call(r,n)?Tn.some(r[n]):Tn.none())})),c}}function en(n,t){var e=n.dom();if(e.nodeType!==Qt)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}function rn(n){return n.nodeType!==Qt&&n.nodeType!==Zt||0===n.childElementCount}function on(t,e){var r=void 0===e?n.document:e.dom();return rn(r)?[]:it(r.querySelectorAll(t),Ut.fromDom)}function un(t,e){var r=void 0===e?n.document:e.dom();return rn(r)?Tn.none():Tn.from(r.querySelector(t)).map(Ut.fromDom)}function cn(n,t){return n.dom()===t.dom()}function an(n){return Ut.fromDom(n.dom().ownerDocument)}function fn(n){return Tn.from(n.dom().parentNode).map(Ut.fromDom)}function sn(n,t){var e=n.dom().childNodes;return Tn.from(e[t]).map(Ut.fromDom)}function ln(n,t){fn(n).each((function(e){e.dom().insertBefore(t.dom(),n.dom())}))}function dn(n,t){(function(n){return Tn.from(n.dom().nextSibling).map(Ut.fromDom)})(n).fold((function(){fn(n).each((function(n){te(n,t)}))}),(function(n){ln(n,t)}))}function mn(n,t){(function(n){return sn(n,0)})(n).fold((function(){te(n,t)}),(function(e){n.dom().insertBefore(t.dom(),e.dom())}))}function gn(n,t){C(t,(function(t){te(n,t)}))}function pn(n){n.dom().textContent="",C(ne(n),(function(n){ee(n)}))}function vn(n,t){te(n.element(),t.element())}function hn(n,t){var e=n.components();!function(n){C(n.components(),(function(n){return ee(n.element())})),pn(n.element()),n.syncComponents()}(n);var r=N(e,t);C(r,(function(t){re(t),n.getSystem().removeFromWorld(t)})),C(t,(function(t){t.getSystem().isConnected()?vn(n,t):(n.getSystem().addToWorld(t),vn(n,t),J(n.element())&&oe(t)),n.syncComponents()}))}function yn(n){var t=fn(n.element()).bind((function(t){return n.getSystem().getByDom(t).toOption()}));!function(n){re(n),ee(n.element()),n.getSystem().removeFromWorld(n)}(n),t.each((function(n){n.syncComponents()}))}function bn(n){return function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)le.call(i,u)&&(r[u]=n(r[u],i[u]))}return r}}var xn,wn,Sn=function(n){function t(){return o}function e(t){return t(n)}var r=u(n),o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:g,isNone:m,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:t,orThunk:t,map:function(t){return Sn(t(n))},each:function(t){t(n)},bind:e,exists:e,forall:e,filter:function(t){return t(n)?o:p},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(m,(function(t){return e(n,t)}))}};return o},Tn={some:Sn,none:l,from:function(n){return null===n||void 0===n?p:Sn(n)}},On=Object.keys,kn=Object.hasOwnProperty,En=function(n,t){for(var e=On(n),r=0,o=e.length;r<o;r++){var i=e[r];t(n[i],i)}},Cn=function(n,t){var e={};return En(n,(function(n,r){var o=t(n,r);e[o.k]=o.v})),e},Dn=function(n,t){var e=[];return En(n,(function(n,r){e.push(t(n,r))})),e},_n=function(n,t){return Mn(n,t)?Tn.from(n[t]):Tn.none()},Mn=function(n,t){return kn.call(n,t)},In=function(n){function t(){return e}var e=n;return{get:t,set:function(n){e=n},clone:function(){return In(t())}}},An=function(){return Fn(0,0)},Fn=function(n,t){return{major:n,minor:t}},Rn={nu:Fn,detect:function(n,t){var e=String(t).toLowerCase();return 0===n.length?An():w(n,e)},unknown:An},Bn="Edge",Vn="Chrome",Nn="Opera",jn="Firefox",Hn="Safari",Pn=function(n){var t=n.current;return{current:t,version:n.version,isEdge:S(Bn,t),isChrome:S(Vn,t),isIE:S("IE",t),isOpera:S(Nn,t),isFirefox:S(jn,t),isSafari:S(Hn,t)}},zn={unknown:function(){return Pn({current:void 0,version:Rn.unknown()})},nu:Pn,edge:u(Bn),chrome:u(Vn),ie:u("IE"),opera:u(Nn),firefox:u(jn),safari:u(Hn)},Ln="Windows",Gn="Android",Un="Linux",$n="Solaris",Wn="FreeBSD",Xn="ChromeOS",qn=function(n){var t=n.current;return{current:t,version:n.version,isWindows:T(Ln,t),isiOS:T("iOS",t),isAndroid:T(Gn,t),isOSX:T("OSX",t),isLinux:T(Un,t),isSolaris:T($n,t),isFreeBSD:T(Wn,t),isChromeOS:T(Xn,t)}},Yn={unknown:function(){return qn({current:void 0,version:Rn.unknown()})},nu:qn,windows:u(Ln),ios:u("iOS"),android:u(Gn),linux:u(Un),osx:u("OSX"),solaris:u($n),freebsd:u(Wn),chromeos:u(Xn)},Kn=O("string"),Jn=O("object"),Qn=O("array"),Zn=O("boolean"),nt=O("function"),tt=O("number"),et=Array.prototype.slice,rt=Array.prototype.indexOf,ot=Array.prototype.push,it=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},ut=(nt(Array.from)&&Array.from,function(n,t){return P(n,t).map((function(n){var e=Rn.detect(n.versionRegexes,t);return{current:n.name,version:e}}))}),ct=function(n,t){return P(n,t).map((function(n){var e=Rn.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},at=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ft=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return z(n,"edge/")&&z(n,"chrome")&&z(n,"safari")&&z(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,at],search:function(n){return z(n,"chrome")&&!z(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return z(n,"msie")||z(n,"trident")}},{name:"Opera",versionRegexes:[at,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:L("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:L("firefox")},{name:"Safari",versionRegexes:[at,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(z(n,"safari")||z(n,"mobile/"))&&z(n,"applewebkit")}}],st=[{name:"Windows",search:L("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return z(n,"iphone")||z(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:L("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:L("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:L("linux"),versionRegexes:[]},{name:"Solaris",search:L("sunos"),versionRegexes:[]},{name:"FreeBSD",search:L("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:L("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],lt={browsers:u(ft),oses:u(st)},dt=In(function(n,t){var e=lt.browsers(),r=lt.oses(),o=ut(e,n).fold(zn.unknown,zn.nu),i=ct(r,n).fold(Yn.unknown,Yn.nu);return{browser:o,os:i,deviceType:function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!o,c=n.isiOS()||n.isAndroid(),a=c||r("(pointer:coarse)"),f=o||!i&&c&&r("(min-device-width:768px)"),s=i||c&&!f,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),d=!s&&!f&&!l;return{isiPad:u(o),isiPhone:u(i),isTablet:u(f),isPhone:u(s),isTouch:u(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:u(l),isDesktop:u(d)}}(i,o,n,t)}}(n.navigator.userAgent,(function(t){return n.window.matchMedia(t).matches}))),mt=u("touchstart"),gt=u("touchmove"),pt=u("touchend"),vt=u("mousedown"),ht=u("mousemove"),yt=u("mouseup"),bt=u("mouseover"),xt=u("keydown"),wt=u("keyup"),St=u("input"),Tt=u("change"),Ot=u("click"),kt=u("transitionend"),Et=u("selectstart"),Ct={tap:u("alloy.tap")},Dt=u("alloy.focus"),_t=u("alloy.blur.post"),Mt=u("alloy.paste.post"),It=u("alloy.receive"),At=u("alloy.execute"),Ft=u("alloy.focus.item"),Rt=Ct.tap,Bt=u("alloy.longpress"),Vt=u("alloy.system.init"),Nt=u("alloy.system.attached"),jt=u("alloy.system.detached"),Ht=u("alloy.focusmanager.shifted"),Pt=u("alloy.highlight"),zt=u("alloy.dehighlight"),Lt=function(n,e,r,o){var i=t({target:e},o);n.getSystem().triggerEvent(r,e,b(i,u))},Gt=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:u(n)}},Ut={fromHtml:function(t,e){var r=(e||n.document).createElement("div");if(r.innerHTML=t,!r.hasChildNodes()||1<r.childNodes.length)throw n.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Gt(r.childNodes[0])},fromTag:function(t,e){var r=(e||n.document).createElement(t);return Gt(r)},fromText:function(t,e){var r=(e||n.document).createTextNode(t);return Gt(r)},fromDom:Gt,fromPoint:function(n,t,e){var r=n.dom();return Tn.from(r.elementFromPoint(t,e)).map(Gt)}},$t=(n.Node.ATTRIBUTE_NODE,n.Node.CDATA_SECTION_NODE,n.Node.COMMENT_NODE,n.Node.DOCUMENT_NODE),Wt=(n.Node.DOCUMENT_TYPE_NODE,n.Node.DOCUMENT_FRAGMENT_NODE,n.Node.ELEMENT_NODE),Xt=n.Node.TEXT_NODE,qt=(n.Node.PROCESSING_INSTRUCTION_NODE,n.Node.ENTITY_REFERENCE_NODE,n.Node.ENTITY_NODE,n.Node.NOTATION_NODE,"undefined"!=typeof n.window?n.window:Function("return this;")(),K(Wt)),Yt=K(Xt),Kt=q((function(){return Jt(Ut.fromDom(n.document))})),Jt=function(n){var t=n.dom().body;if(null===t||void 0===t)throw new Error("Body is not available yet");return Ut.fromDom(t)},Qt=Wt,Zt=$t,ne=(G().browser.isIE(),function(n){return it(n.dom().childNodes,Ut.fromDom)}),te=(Q("element","offset"),function(n,t){n.dom().appendChild(t.dom())}),ee=function(n){var t=n.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},re=function(n){U(n,jt());var t=n.components();C(t,re)},oe=function(n){var t=n.components();C(t,oe),U(n,Nt())},ie=function(n,t,e){n.getSystem().addToWorld(t),e(n.element(),t.element()),J(n.element())&&oe(t),n.syncComponents()},ue=function(n,t,e){e(n,t.element());var r=ne(t.element());C(r,(function(n){t.getByDom(n).each(oe)}))},ce=function(n){return{is:function(t){return n===t},isValue:g,isError:m,getOr:u(n),getOrThunk:u(n),getOrDie:u(n),or:function(t){return ce(n)},orThunk:function(t){return ce(n)},fold:function(t,e){return e(n)},map:function(t){return ce(t(n))},mapError:function(t){return ce(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOption:function(){return Tn.some(n)}}},ae=function(n){return{is:m,isValue:m,isError:g,getOr:o,getOrThunk:function(n){return n()},getOrDie:function(){return f(String(n))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(t,e){return t(n)},map:function(t){return ae(n)},mapError:function(t){return ae(t(n))},each:r,bind:function(t){return ae(n)},exists:m,forall:g,toOption:Tn.none}},fe={value:ce,error:ae,fromOption:function(n,t){return n.fold((function(){return ae(t)}),ce)}},se=function(t){if(!Qn(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],r={};return C(t,(function(o,i){var u=On(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!Qn(a))throw new Error("case arguments must be an array");e.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(n){var t=On(n);if(e.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+t.join(","));if(!B(e,(function(n){return k(t,n)})))throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+e.join(", "));return n[c].apply(null,o)},log:function(t){n.console.log(t,{constructors:e,constructor:c,params:o})}}}})),r},le=Object.prototype.hasOwnProperty,de=bn((function(n,t){return Jn(n)&&Jn(t)?de(n,t):t})),me=bn((function(n,t){return t}));function ge(n,t,e){return n.stype===xn.Error?t(n.serror):e(n.svalue)}function pe(n){return{stype:xn.Value,svalue:n}}function ve(n){return{stype:xn.Error,serror:n}}function he(n){return Hr.defaultedThunk(u(n))}function ye(n,t){var e;return(e={})[n]=t,e}function be(n,t){return function(n,t){var e={};return En(n,(function(n,r){k(t,r)||(e[r]=n)})),e}(n,t)}function xe(n,t){return ye(n,t)}function we(n){return function(n){var t={};return C(n,(function(n){t[n.key]=n.value})),t}(n)}function Se(n,t){var e=function(n){var t=[],e=[];return C(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}(n);return 0<e.errors.length?function(n){return fe.error(F(n))}(e.errors):function(n,t){return 0===n.length?fe.value(t):fe.value(de(t,me.apply(void 0,n)))}(e.values,t)}function Te(n){return i(Rr,F)(n)}function Oe(n){return Jn(n)&&100<On(n).length?" removed due to size":JSON.stringify(n,null,2)}function ke(n,t){return Rr([{path:n,getErrorInfo:t}])}function Ee(n,t,e){return _n(t,e).fold((function(){return function(n,t,e){return ke(n,(function(){return'Could not find valid *strict* value for "'+t+'" in '+Oe(e)}))}(n,e,t)}),Ar)}function Ce(n,t,e){var r=_n(n,t).fold((function(){return e(n)}),o);return Ar(r)}function De(n,t,e,r){return e.fold((function(e,o,i,c){function a(t){var i=c.extract(n.concat([e]),r,t);return Nr(i,(function(n){return ye(o,r(n))}))}function f(t){return t.fold((function(){var n=ye(o,r(Tn.none()));return Ar(n)}),(function(t){var i=c.extract(n.concat([e]),r,t);return Nr(i,(function(n){return ye(o,r(Tn.some(n)))}))}))}return i.fold((function(){return Br(Ee(n,t,e),a)}),(function(n){return Br(Ce(t,e,n),a)}),(function(){return Br(function(n,t){return Ar(_n(n,t))}(t,e),f)}),(function(n){return Br(function(n,t,e){var r=_n(n,t).map((function(t){return!0===t?e(n):t}));return Ar(r)}(t,e,n),f)}),(function(n){var r=n(t),o=Nr(Ce(t,e,u({})),(function(n){return de(r,n)}));return Br(o,a)}))}),(function(n,e){var o=e(t);return Ar(ye(n,r(o)))}))}function _e(n){return{extract:function(t,e,r){return Vr(n(r,e),(function(n){return function(n,t){return ke(n,(function(){return t}))}(t,n)}))},toString:function(){return"val"}}}function Me(n){var t=Xr(n),e=_(n,(function(n,t){return t.fold((function(t){return de(n,xe(t,!0))}),u(n))}),{});return{extract:function(n,r,o){var i=Zn(o)?[]:function(n){var t=On(n);return D(t,(function(t){return x(n,t)}))}(o),u=D(i,(function(n){return!x(e,n)}));return 0===u.length?t.extract(n,r,o):function(n,t){return ke(n,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))}(n,u)},toString:t.toString}}function Ie(n,t){function e(t,e){return function(n){return{extract:function(t,e,r){var o=it(r,(function(r,o){return n.extract(t.concat(["["+o+"]"]),e,r)}));return $r(o)},toString:function(){return"array("+n.toString()+")"}}}(_e(n)).extract(t,o,e)}return{extract:function(n,r,o){var i=On(o),u=e(n,i);return Br(u,(function(e){var i=it(e,(function(n){return Wr.field(n,n,Pr(),t)}));return Xr(i).extract(n,r,o)}))},toString:function(){return"setOf("+t.toString()+")"}}}function Ae(n,t,e,r,o){return _n(r,o).fold((function(){return function(n,t,e){return ke(n,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Oe(t)}))}(n,r,o)}),(function(r){return r.extract(n.concat(["branch: "+o]),t,e)}))}function Fe(n,t){return{extract:function(e,r,o){return _n(o,n).fold((function(){return function(n,t){return ke(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))}(e,n)}),(function(n){return Ae(e,r,o,t,n)}))},toString:function(){return"chooseOn("+n+"). Possible values: "+On(t)}}}function Re(n){return _e((function(t){return n(t).fold(Rr,Ar)}))}function Be(n,t){return Ie((function(t){return Mr(n(t))}),t)}function Ve(n,t,e){return Ir(function(n,t,e,r){var o=t.extract([n],e,r);return jr(o,(function(n){return{input:r,errors:n}}))}(n,t,o,e))}function Ne(n){return n.fold((function(n){throw new Error(Qr(n))}),o)}function je(n,t,e){return Ne(Ve(n,t,e))}function He(n,t){return Fe(n,b(t,Xr))}function Pe(n){return Kr(n,n,Pr(),qr())}function ze(n,t){return Kr(n,n,Pr(),t)}function Le(n,t){return Kr(n,n,Pr(),Xr(t))}function Ge(n){return Kr(n,n,zr(),qr())}function Ue(n,t){return Kr(n,n,zr(),t)}function $e(n,t){return Ue(n,Xr(t))}function We(n,t){return Ue(n,Me(t))}function Xe(n,t){return Kr(n,n,he(t),qr())}function qe(n,t,e){return Kr(n,n,he(t),e)}function Ye(n,t){return Yr(n,t)}function Ke(n,t){return cn(n.element(),t.event().target())}function Je(n){if(!x(n,"can")&&!x(n,"abort")&&!x(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return je("Extracting event.handler",Me([Xe("can",u(!0)),Xe("abort",u(!1)),Xe("run",r)]),n)}function Qe(n){var t=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return M(n,(function(n,r){return n&&t(r).apply(void 0,e)}),!0)}}(n,(function(n){return n.can})),e=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return M(n,(function(n,r){return n||t(r).apply(void 0,e)}),!1)}}(n,(function(n){return n.abort}));return Je({can:t,abort:e,run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];C(n,(function(n){n.run.apply(void 0,t)}))}})}function Ze(n){return we(n)}function nr(n,t){return{key:n,value:Je({abort:t})}}function tr(n,t){return{key:n,value:Je({run:t})}}function er(n,t,e){return{key:n,value:Je({run:function(n,r){t.apply(void 0,[n,r].concat(e))}})}}function rr(n){return function(t){return{key:n,value:Je({run:function(n,e){Ke(n,e)&&t(n,e)}})}}}function or(n,t,e){return function(n,t){return tr(n,(function(e,r){e.getSystem().getByUid(t).each((function(t){!function(n,t,e,r){n.getSystem().triggerEvent(e,t,r.event())}(t,t.element(),n,r)}))}))}(n,t.partUids[e])}function ir(n){return tr(n,(function(n,t){t.cut()}))}function ur(n,t){var e=n.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:uo(i)}},n}function cr(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}}function ar(n,t,e){return oo((function(r,o){e(r,n,t)}))}function fr(n,t,e){return function(n,t,e){var r=e.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:uo(u.slice(0,1).concat(u.slice(3)))}},n}((function(r){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var c=[r].concat(o);return r.config({name:u(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)}),(function(n){var e=Array.prototype.slice.call(c,1);return t.apply(void 0,[r,n.config,n.state].concat(e))}))}),e,t)}function sr(n){return{key:n,value:void 0}}function lr(n){var t=je("Creating behaviour: "+n.name,lo,n);return function(n,t,e,r,o,i){var u=Me(n),c=$e(t,[We("config",n)]);return co(u,c,t,e,r,o,i)}(t.fields,t.name,t.active,t.apis,t.extra,t.state)}function dr(t,e,r){if(!(Kn(r)||Zn(r)||tt(r)))throw n.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,r+"")}function mr(n,t,e){dr(n.dom(),t,e)}function gr(n,t){var e=n.dom();En(t,(function(n,t){dr(e,t,n)}))}function pr(n,t){var e=n.dom().getAttribute(t);return null===e?void 0:e}function vr(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)}function hr(n,t){n.dom().removeAttribute(t)}function yr(n,t){var e=pr(n,t);return void 0===e||""===e?[]:e.split(" ")}function br(n){return void 0!==n.dom().classList}function xr(n,t){return function(n,t,e){var r=yr(n,t).concat([e]);return mr(n,t,r.join(" ")),!0}(n,"class",t)}function wr(n,t){return function(n,t,e){var r=D(yr(n,t),(function(n){return n!==e}));return 0<r.length?mr(n,t,r.join(" ")):hr(n,t),!1}(n,"class",t)}function Sr(n,t){br(n)?n.dom().classList.add(t):xr(n,t)}function Tr(n){0===(br(n)?n.dom().classList:function(n){return yr(n,"class")}(n)).length&&hr(n,"class")}function Or(n,t){br(n)?n.dom().classList.remove(t):wr(n,t),Tr(n)}function kr(n,t){return br(n)&&n.dom().classList.contains(t)}function Er(n,t,e){Or(n,e),Sr(n,t)}(wn=xn=xn||{})[wn.Error=0]="Error",wn[wn.Value=1]="Value";var Cr,Dr,_r,Mr=function(n){return n.fold(ve,pe)},Ir=function(n){return ge(n,fe.error,fe.value)},Ar=pe,Fr=function(n){var t=[],e=[];return C(n,(function(n){ge(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},Rr=ve,Br=function(n,t){return n.stype===xn.Value?t(n.svalue):n},Vr=function(n,t){return n.stype===xn.Error?t(n.serror):n},Nr=function(n,t){return n.stype===xn.Value?{stype:xn.Value,svalue:t(n.svalue)}:n},jr=function(n,t){return n.stype===xn.Error?{stype:xn.Error,serror:t(n.serror)}:n},Hr=se([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Pr=Hr.strict,zr=Hr.asOption,Lr=Hr.defaultedThunk,Gr=(Hr.asDefaultedOptionThunk,Hr.mergeWithThunk),Ur=(se([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,t){var e=Fr(n);return 0<e.errors.length?Te(e.errors):function(n,t){return 0<n.length?Ar(de(t,me.apply(void 0,n))):Ar(t)}(e.values,t)}),$r=function(n){var t=Fr(n);return 0<t.errors.length?Te(t.errors):Ar(t.values)},Wr=se([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Xr=function(n){return{extract:function(t,e,r){return function(n,t,e,r){var o=it(e,(function(e){return De(n,t,e,r)}));return Ur(o,{})}(t,r,n,e)},toString:function(){return"obj{\n"+it(n,(function(n){return n.fold((function(n,t,e,r){return n+" -> "+r.toString()}),(function(n,t){return"state("+n+")"}))})).join("\n")+"}"}}},qr=u(_e(Ar)),Yr=Wr.state,Kr=Wr.field,Jr=_e(Ar),Qr=function(n){return"Errors: \n"+function(n){var t=10<n.length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n;return it(t,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))}(n.errors).join("\n")+"\n\nInput object: "+Oe(n.input)},Zr=u(Jr),no=(Cr=nt,Dr="function",_e((function(n){var t=typeof n;return Cr(n)?Ar(n):Rr("Expected type: "+Dr+" but got: "+t)}))),to=function(n,t,e){return t(n).orThunk((function(){return e(n)?Tn.none():function(n,t,e){for(var r=n.dom(),o=nt(e)?e:u(!1);r.parentNode;){r=r.parentNode;var i=Ut.fromDom(r),c=t(i);if(c.isSome())return c;if(o(i))break}return Tn.none()}(n,t,e)}))},eo=rr(Nt()),ro=rr(jt()),oo=rr(Vt()),io=(_r=At(),function(n){return tr(_r,n)}),uo=function(n){return it(n,(function(n){return function(n,t){return function(n,t,e){return""===t||!(n.length<t.length)&&n.substr(e,e+t.length)===t}(n,t,n.length-t.length)}(n,"/*")?n.substring(0,n.length-"/*".length):n}))},co=function(n,e,r,o,i,u,a){function f(n){return x(n,r)?n[r]():Tn.none()}var s=b(i,(function(n,t){return fr(r,n,t)})),l=b(u,(function(n,t){return ur(n,t)})),d=t(t(t({},l),s),{revoke:c(sr,r),config:function(t){var e=je(r+"-config",n,t);return{key:r,value:{config:e,me:d,configAsRaw:q((function(){return je(r+"-config",n,t)})),initialConfig:t,state:a}}},schema:function(){return e},exhibit:function(n,t){return f(n).bind((function(n){return _n(o,"exhibit").map((function(e){return e(t,n.config,n.state)}))})).getOr(cr({}))},name:function(){return r},handlers:function(n){return f(n).map((function(n){return _n(o,"events").getOr((function(){return{}}))(n.config,n.state)})).getOr({})}});return d},ao={init:function(){return fo({readState:function(){return"No State required"}})}},fo=function(n){return n},so=function(n){return we(n)},lo=Me([Pe("fields"),Pe("name"),Xe("active",{}),Xe("apis",{}),Xe("state",ao),Xe("extra",{})]),mo=Me([Pe("branchKey"),Pe("branches"),Pe("name"),Xe("active",{}),Xe("apis",{}),Xe("state",ao),Xe("extra",{})]),go=u(void 0),po=Object.freeze({__proto__:null,toAlpha:function(n,t,e){Er(n.element(),t.alpha,t.omega)},toOmega:function(n,t,e){Er(n.element(),t.omega,t.alpha)},isAlpha:function(n,t,e){return kr(n.element(),t.alpha)},isOmega:function(n,t,e){return kr(n.element(),t.omega)},clear:function(n,t,e){Or(n.element(),t.alpha),Or(n.element(),t.omega)}}),vo=[Pe("alpha"),Pe("omega")],ho=lr({fields:vo,name:"swapping",apis:po});function yo(n,t,e,r,o){return n(e,r)?Tn.some(e):nt(o)&&o(e)?Tn.none():t(e,r,o)}function bo(n,t,e){for(var r=n.dom(),o=nt(e)?e:u(!1);r.parentNode;){r=r.parentNode;var i=Ut.fromDom(r);if(t(i))return Tn.some(i);if(o(i))break}return Tn.none()}function xo(n){n.dom().focus()}function wo(n){n.dom().blur()}function So(t){var e=void 0!==t?t.dom():n.document;return Tn.from(e.activeElement).map(Ut.fromDom)}function To(n){return So(an(n)).filter((function(t){return n.dom().contains(t.dom())}))}function Oo(n){return n.dom().innerHTML}function ko(t,e){var r=an(t).dom(),o=Ut.fromDom(r.createDocumentFragment()),i=function(t,e){var r=(e||n.document).createElement("div");return r.innerHTML=t,ne(Ut.fromDom(r))}(e,r);gn(o,i),pn(t),te(t,o)}function Eo(n){return function(n,t){return Ut.fromDom(n.dom().cloneNode(t))}(n,!1)}function Co(n){return function(n){var t=Ut.fromTag("div"),e=Ut.fromDom(n.dom().cloneNode(!0));return te(t,e),Oo(t)}(Eo(n))}function Do(n){return Co(n)}var _o,Mo,Io=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ao=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Fo=function(t){var e=n.document.createElement("a");e.target="_blank",e.href=t.href,e.rel="noreferrer noopener";var r=n.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,n.window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.document.body.appendChild(e),e.dispatchEvent(r),n.document.body.removeChild(e)},Ro={formatChanged:u("formatChanged"),orientationChanged:u("orientationChanged"),dropupDismissed:u("dropupDismissed")},Bo=Object.freeze({__proto__:null,events:function(n){return Ze([tr(It(),(function(t,e){var r=n.channels,o=On(r),i=e,u=function(n,t){return t.universal()?n:D(n,(function(n){return k(t.channels(),n)}))}(o,i);C(u,(function(n){var e=r[n],o=e.schema,u=je("channel["+n+"] data\nReceiver: "+Do(t.element()),o,i.data());e.onReceive(t,u)}))}))])}}),Vo="unknown";function No(t,e,r){switch(_n(ai.get(),t).orThunk((function(){var n=On(ai.get());return H(n,(function(n){return-1<t.indexOf(n)?Tn.some(ai.get()[n]):Tn.none()}))})).getOr(_o.NORMAL)){case _o.NORMAL:return r(si());case _o.LOGGING:var o=function(t,e){var r=[],o=(new Date).getTime();return{logEventCut:function(n,t,e){r.push({outcome:"cut",target:t,purpose:e})},logEventStopped:function(n,t,e){r.push({outcome:"stopped",target:t,purpose:e})},logNoParent:function(n,t,e){r.push({outcome:"no-parent",target:t,purpose:e})},logEventNoHandlers:function(n,t){r.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,e){r.push({outcome:"response",purpose:e,target:t})},write:function(){var i=(new Date).getTime();k(["mousemove","mouseover","mouseout",Vt()],t)||n.console.log(t,{event:t,time:i-o,target:e.dom(),sequence:it(r,(function(n){return k(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+Do(n.target)+")":n.outcome}))})}}}(t,e),i=r(o);return o.write(),i;case _o.STOP:return!0}}function jo(n,t,e){return No(n,t,e)}function Ho(n,t,e){return function(){var n=new Error;if(void 0!==n.stack){var t=n.stack.split("\n");I(t,(function(n){return 0<n.indexOf("alloy")&&!E(fi,(function(t){return-1<n.indexOf(t)}))})).getOr(Vo)}}(),Kr(t,t,e,Re((function(n){return fe.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)}))})))}function Po(n){return Ho(0,n,he(r))}function zo(n){return Ho(0,n,he(Tn.none))}function Lo(n){return Ho(0,n,Pr())}function Go(n){return Ho(0,n,Pr())}function Uo(n,t){return Ye(n,u(t))}function $o(n){return Ye(n,o)}function Wo(n,t,e){var r=t.aria;r.update(n,r,e.get())}function Xo(n,t,e){t.toggleClass.each((function(t){e.get()?Sr(n.element(),t):Or(n.element(),t)}))}function qo(n,t,e){yi(n,t,e,!e.get())}function Yo(n,t,e){e.set(!0),Xo(n,t,e),Wo(n,t,e)}function Ko(n,t,e){e.set(!1),Xo(n,t,e),Wo(n,t,e)}function Jo(n,t,e){yi(n,t,e,t.selected)}function Qo(){function n(n,t){t.stop(),W(n)}return[tr(Ot(),n),tr(Rt(),n),ir(mt()),ir(vt())]}function Zo(n,t){t.ignore||(xo(n.element()),t.onFocus(n))}function ni(n){return void 0!==n.style&&nt(n.style.getPropertyValue)}function ti(t,e,r){if(!Kn(r))throw n.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);ni(t)&&t.style.setProperty(e,r)}function ei(n,t){var e=n.dom();En(t,(function(n,t){ti(e,t,n)}))}function ri(t,e){var r=t.dom(),o=n.window.getComputedStyle(r).getPropertyValue(e),i=""!==o||J(t)?o:Ri(r,e);return null===i?void 0:i}function oi(n,t){var e=n.dom(),r=Ri(e,t);return Tn.from(r).filter((function(n){return 0<n.length}))}function ii(n,t){!function(n,t){ni(n)&&n.style.removeProperty(t)}(n.dom(),t),vr(n,"style")&&""===function(n){return n.replace(/^\s+|\s+$/g,"")}(pr(n,"style"))&&hr(n,"style")}function ui(n){return n.dom().offsetWidth}(Mo=_o=_o||{})[Mo.STOP=0]="STOP",Mo[Mo.NORMAL=1]="NORMAL",Mo[Mo.LOGGING=2]="LOGGING";var ci,ai=In({}),fi=["alloy/data/Fields","alloy/debugging/Debugging"],si=u({logEventCut:r,logEventStopped:r,logNoParent:r,logEventNoHandlers:r,logEventResponse:r,write:r}),li=u([Pe("menu"),Pe("selectedMenu")]),di=u([Pe("item"),Pe("selectedItem")]),mi=(u(Xr(di().concat(li()))),u(Xr(di()))),gi=Le("initSize",[Pe("numColumns"),Pe("numRows")]),pi=u(gi),vi=[ze("channels",Be(fe.value,Me([Lo("onReceive"),Xe("schema",Zr())])))],hi=lr({fields:vi,name:"receiving",active:Bo}),yi=function(n,t,e,r){(r?Yo:Ko)(n,t,e)},bi=Object.freeze({__proto__:null,onLoad:Jo,toggle:qo,isOn:function(n,t,e){return e.get()},on:Yo,off:Ko,set:yi}),xi=Object.freeze({__proto__:null,exhibit:function(){return cr({})},events:function(n,t){var e=function(n,t,e){return io((function(r){e(r,n,t)}))}(n,t,qo),r=ar(n,t,Jo);return Ze(F([n.toggleOnExecute?[e]:[],[r]]))}}),wi=function(n,t,e){mr(n.element(),"aria-expanded",e)},Si=[Xe("selected",!1),Ge("toggleClass"),Xe("toggleOnExecute",!0),qe("aria",{mode:"none"},He("mode",{pressed:[Xe("syncWithExpanded",!1),Uo("update",(function(n,t,e){mr(n.element(),"aria-pressed",e),t.syncWithExpanded&&wi(n,t,e)}))],checked:[Uo("update",(function(n,t,e){mr(n.element(),"aria-checked",e)}))],expanded:[Uo("update",wi)],selected:[Uo("update",(function(n,t,e){mr(n.element(),"aria-selected",e)}))],none:[Uo("update",r)]}))],Ti=lr({fields:Si,name:"toggling",active:xi,apis:bi,state:(ci=!1,{init:function(){var n=In(ci);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(ci)},readState:function(){return n.get()}}}})}),Oi=function(n,t){return hi.config({channels:xe(Ro.formatChanged(),{onReceive:function(e,r){r.command===n&&t(e,r.state)}})})},ki=function(n){return hi.config({channels:xe(Ro.orientationChanged(),{onReceive:n})})},Ei=function(n,t){return{key:n,value:{onReceive:t}}},Ci="tinymce-mobile",Di={resolve:function(n){return Ci+"-"+n},prefix:u(Ci)},_i=Object.freeze({__proto__:null,focus:Zo,blur:function(n,t){t.ignore||wo(n.element())},isFocused:function(n){return function(n){var t=an(n).dom();return n.dom()===t.activeElement}(n.element())}}),Mi=Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return cr(e)},events:function(n){return Ze([tr(Dt(),(function(t,e){Zo(t,n),e.stop()}))].concat(n.stopMousedown?[tr(vt(),(function(n,t){t.event().prevent()}))]:[]))}}),Ii=[Po("onFocus"),Xe("stopMousedown",!1),Xe("ignore",!1)],Ai=lr({fields:Ii,name:"focusing",active:Mi,apis:_i}),Fi=function(n,t,e){var r=n.dom();ti(r,t,e)},Ri=function(n,t){return ni(n)?n.style.getPropertyValue(t):""};function Bi(n,t){function e(e){var r=t(e);if(r<=0||null===r){var o=ri(e,n);return parseFloat(o)||0}return r}function r(n,t){return M(t,(function(t,e){var r=ri(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o}),0)}return{set:function(t,e){if(!tt(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom();ni(r)&&(r.style[n]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(n,t,e){var o=r(n,e);return o<t?t-o:0}}}function Vi(n){return fu.get(n)}function Ni(n,t,e){return D(function(n,t){for(var e=nt(t)?t:m,r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=Ut.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o}(n,e),t)}function ji(n,t){return D(function(n){return fn(n).map(ne).map((function(t){return D(t,(function(t){return!cn(n,t)}))})).getOr([])}(n),t)}function Hi(n,t){return on(t,n)}function Pi(n){return un(n)}function zi(n,t,e){return bo(n,(function(n){return en(n,t)}),e)}function Li(n,t){return un(t,n)}function Gi(n,t,e){return yo(en,zi,n,t,e)}function Ui(n,t,e){var r=V(n.slice(0,t)),o=V(n.slice(t+1));return I(r.concat(o),e)}function $i(n,t,e){var r=V(n.slice(0,t));return I(r,e)}function Wi(n,t,e){var r=n.slice(0,t),o=n.slice(t+1);return I(o.concat(r),e)}function Xi(n,t,e){var r=n.slice(t+1);return I(r,e)}function qi(n){return function(t){var e=t.raw();return k(n,e.which)}}function Yi(n){return function(t){return B(n,(function(n){return n(t)}))}}function Ki(n){return!0===n.raw().shiftKey}function Ji(n){return!0===n.raw().ctrlKey}function Qi(n,t){return{matches:n,classification:t}}function Zi(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t}function nu(n,t,e,r){var o=n+t;return r<o?e:o<e?r:o}function tu(n,t,e){return Math.min(Math.max(n,t),e)}function eu(n,t,e,r){var o=Hi(n.element(),"."+t.highlightClass);C(o,(function(e){E(r,(function(n){return n.element()===e}))||(Or(e,t.highlightClass),n.getSystem().getByDom(e).each((function(e){t.onDehighlight(n,e),U(e,zt())})))}))}function ru(n,t,e,r){eu(n,t,0,[r]),lu(n,t,e,r)||(Sr(r.element(),t.highlightClass),t.onHighlight(n,r),U(r,Pt()))}function ou(n,t,e,r){var o=Hi(n.element(),"."+t.itemClass);return A(o,(function(n){return kr(n,t.highlightClass)})).bind((function(t){var e=nu(t,r,0,o.length-1);return n.getSystem().getByDom(o[e]).toOption()}))}function iu(n,t,e){t.exists((function(n){return e.exists((function(t){return cn(t,n)}))}))||$(n,Ht(),{prevFocus:t,newFocus:e})}function uu(){function n(n){return To(n.element())}return{get:n,set:function(t,e){var r=n(t);t.getSystem().triggerFocus(e,t.element());var o=n(t);iu(t,r,o)}}}var cu,au,fu=Bi("height",(function(n){var t=n.dom();return J(n)?t.getBoundingClientRect().height:t.offsetHeight})),su=a(Ki),lu=function(n,t,e,r){return kr(r.element(),t.highlightClass)},du=function(n,t,e,r){var o=Hi(n.element(),"."+t.itemClass);return Tn.from(o[r]).fold((function(){return fe.error("No element found with index "+r)}),n.getSystem().getByDom)},mu=function(n,t,e){return Li(n.element(),"."+t.itemClass).bind((function(t){return n.getSystem().getByDom(t).toOption()}))},gu=function(n,t,e){var r=Hi(n.element(),"."+t.itemClass);return(0<r.length?Tn.some(r[r.length-1]):Tn.none()).bind((function(t){return n.getSystem().getByDom(t).toOption()}))},pu=function(n,t,e){var r=Hi(n.element(),"."+t.itemClass);return Zi(it(r,(function(t){return n.getSystem().getByDom(t).toOption()})))},vu=Object.freeze({__proto__:null,dehighlightAll:function(n,t,e){return eu(n,t,0,[])},dehighlight:function(n,t,e,r){lu(n,t,e,r)&&(Or(r.element(),t.highlightClass),t.onDehighlight(n,r),U(r,zt()))},highlight:ru,highlightFirst:function(n,t,e){mu(n,t).each((function(r){ru(n,t,e,r)}))},highlightLast:function(n,t,e){gu(n,t).each((function(r){ru(n,t,e,r)}))},highlightAt:function(n,t,e,r){du(n,t,e,r).fold((function(n){throw new Error(n)}),(function(r){ru(n,t,e,r)}))},highlightBy:function(n,t,e,r){var o=pu(n,t);I(o,r).each((function(r){ru(n,t,e,r)}))},isHighlighted:lu,getHighlighted:function(n,t,e){return Li(n.element(),"."+t.highlightClass).bind((function(t){return n.getSystem().getByDom(t).toOption()}))},getFirst:mu,getLast:gu,getPrevious:function(n,t,e){return ou(n,t,0,-1)},getNext:function(n,t,e){return ou(n,t,0,1)},getCandidates:pu}),hu=[Pe("highlightClass"),Pe("itemClass"),Po("onHighlight"),Po("onDehighlight")],yu=lr({fields:hu,name:"highlighting",apis:vu});function bu(n,t,e,r,o){function i(n,t,e,r,o){return function(n,t){return I(n,(function(n){return n.matches(t)})).map((function(n){return n.classification}))}(e(n,t,r,o),t.event()).bind((function(e){return e(n,t,r,o)}))}var u={schema:function(){return n.concat([Xe("focusManager",uu()),qe("focusInside","onFocus",Re((function(n){return k(["onFocus","onEnterOrSpace","onApi"],n)?fe.value(n):fe.error("Invalid value for focusInside")}))),Uo("handler",u),Uo("state",t),Uo("sendFocusIn",o)])},processKey:i,toEvents:function(n,t){var u=n.focusInside!==cu.OnFocusMode?Tn.none():o(n).map((function(e){return tr(Dt(),(function(r,o){e(r,n,t),o.stop()}))}));return Ze(u.toArray().concat([tr(xt(),(function(r,u){i(r,u,e,n,t).fold((function(){!function(e,r){var i=qi([32].concat([13]))(r.event());n.focusInside===cu.OnEnterOrSpaceMode&&i&&Ke(e,r)&&o(n).each((function(o){o(e,n,t),r.stop()}))}(r,u)}),(function(n){u.stop()}))})),tr(wt(),(function(e,o){i(e,o,r,n,t).each((function(n){o.stop()}))}))]))}};return u}function xu(n){function t(n,t){var e=n.visibilitySelector.bind((function(n){return Gi(t,n)})).getOr(t);return 0<Vi(e)}function e(n,e,r){(function(n,e){var r=Hi(n.element(),e.selector),o=D(r,(function(n){return t(e,n)}));return Tn.from(o[e.firstTabstop])})(n,e).each((function(t){e.focusManager.set(n,t)}))}function r(n,e,r,o,i){return i(e,r,(function(n){return function(n,e){return t(n,e)&&n.useTabstopAt(e)}(o,n)})).fold((function(){return o.cyclic?Tn.some(!0):Tn.none()}),(function(t){return o.focusManager.set(n,t),Tn.some(!0)}))}function o(n,t,e,o){var i=Hi(n.element(),e.selector);return function(n,t){return t.focusManager.get(n).bind((function(n){return Gi(n,t.selector)}))}(n,e).bind((function(t){return A(i,c(cn,t)).bind((function(t){return r(n,i,t,e,o)}))}))}var i=[Ge("onEscape"),Ge("onEnter"),Xe("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Xe("firstTabstop",0),Xe("useTabstopAt",u(!0)),Ge("visibilitySelector")].concat([n]),a=u([Qi(Yi([Ki,qi([9])]),(function(n,t,e){var r=e.cyclic?Ui:$i;return o(n,0,e,r)})),Qi(qi([9]),(function(n,t,e){var r=e.cyclic?Wi:Xi;return o(n,0,e,r)})),Qi(qi([27]),(function(n,t,e){return e.onEscape.bind((function(e){return e(n,t)}))})),Qi(Yi([su,qi([13])]),(function(n,t,e){return e.onEnter.bind((function(e){return e(n,t)}))}))]),f=u([]);return bu(i,ao.init,a,f,(function(){return Tn.some(e)}))}function wu(n){return"input"===Y(n)&&"radio"!==pr(n,"type")||"textarea"===Y(n)}function Su(n,t,e){return wu(e)&&qi([32])(t.event())?Tn.none():function(n,t,e){return X(n,e,At()),Tn.some(!0)}(n,0,e)}function Tu(n,t){return Tn.some(!0)}function Ou(n,t,e){return e.execute(n,t,n.element())}function ku(){var n=In(Tn.none());return fo({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows()),numColumns:String(n.numColumns())}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set(Tn.some({numRows:u(t),numColumns:u(e)}))},getNumRows:function(){return n.get().map((function(n){return n.numRows()}))},getNumColumns:function(){return n.get().map((function(n){return n.numColumns()}))}})}function Eu(n,t){return function(e){return"rtl"===zc(e)?t:n}}function Cu(n){return function(t,e,r,o){var i=n(t.element());return Lc(i,t,e,r,o)}}function Du(n,t){var e=Eu(n,t);return Cu(e)}function _u(n,t){var e=Eu(t,n);return Cu(e)}function Mu(n){return function(t,e,r,o){return Lc(n,t,e,r,o)}}function Iu(n){return!function(n){return n.offsetWidth<=0&&n.offsetHeight<=0}(n.dom())}function Au(n,t,e){var r=Hi(n,e);return function(n,t){return A(n,t).map((function(t){return{index:u(t),candidates:u(n)}}))}(D(r,Iu),(function(n){return cn(n,t)}))}function Fu(n,t){return A(n,(function(n){return cn(t,n)}))}function Ru(n,t,e,r){return r(Math.floor(t/e),t%e).bind((function(t){var r=t.row()*e+t.column();return 0<=r&&r<n.length?Tn.some(n[r]):Tn.none()}))}function Bu(n,t,e,r,o){return Ru(n,t,r,(function(t,i){var c=t===e-1?n.length-t*r:r,a=nu(i,o,0,c-1);return Tn.some({row:u(t),column:u(a)})}))}function Vu(n,t,e,r,o){return Ru(n,t,r,(function(t,i){var c=nu(t,o,0,e-1),a=c===e-1?n.length-c*r:r,f=tu(i,0,a-1);return Tn.some({row:u(c),column:u(f)})}))}function Nu(n,t,e){Li(n.element(),t.selector).each((function(e){t.focusManager.set(n,e)}))}function ju(n){return function(t,e,r,o){return Au(t,e,r.selector).bind((function(t){return n(t.candidates(),t.index(),o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))}))}}function Hu(n,t,e){return e.captureTab?Tn.some(!0):Tn.none()}function Pu(n,t,e,r){var o=function(n,t,e){var i=nu(t,r,0,e.length-1);return i===n?Tn.none():function(n){return"button"===Y(n)&&"disabled"===pr(n,"disabled")}(e[i])?o(n,i,e):Tn.from(e[i])};return Au(n,e,t).bind((function(n){var t=n.index(),e=n.candidates();return o(t,t,e)}))}function zu(n,t,e){return function(n,t){return t.focusManager.get(n).bind((function(n){return Gi(n,t.selector)}))}(n,e).bind((function(r){return e.execute(n,t,r)}))}function Lu(n,t,e){t.getInitial(n).orThunk((function(){return Li(n.element(),t.selector)})).each((function(e){t.focusManager.set(n,e)}))}function Gu(n,t,e){return Pu(n,e.selector,t,-1)}function Uu(n,t,e){return Pu(n,e.selector,t,1)}function $u(n){return function(t,e,r,o){return n(t,e,r,o).bind((function(){return r.executeOnMove?zu(t,e,r):Tn.some(!0)}))}}function Wu(n,t,e){return e.onEscape(n,t)}function Xu(n,t,e){return Tn.from(n[t]).bind((function(n){return Tn.from(n[e]).map((function(n){return ra({rowIndex:t,columnIndex:e,cell:n})}))}))}function qu(n,t,e,r){var o=n[t].length,i=nu(e,r,0,o-1);return Xu(n,t,i)}function Yu(n,t,e,r){var o=nu(e,r,0,n.length-1),i=n[o].length,u=tu(t,0,i-1);return Xu(n,o,u)}function Ku(n,t,e,r){var o=n[t].length,i=tu(e+r,0,o-1);return Xu(n,t,i)}function Ju(n,t,e,r){var o=tu(e+r,0,n.length-1),i=n[o].length,u=tu(t,0,i-1);return Xu(n,o,u)}function Qu(n,t,e){t.previousSelector(n).orThunk((function(){var e=t.selectors;return Li(n.element(),e.cell)})).each((function(e){t.focusManager.set(n,e)}))}function Zu(n,t){return function(e,r,o){var i=o.cycles?n:t;return Gi(r,o.selectors.row).bind((function(n){var t=Hi(n,o.selectors.cell);return Fu(t,r).bind((function(t){var r=Hi(e,o.selectors.row);return Fu(r,n).bind((function(n){var e=function(n,t){return it(n,(function(n){return Hi(n,t.selectors.cell)}))}(r,o);return i(e,n,t).map((function(n){return n.cell()}))}))}))}))}}function nc(n,t,e){return e.focusManager.get(n).bind((function(r){return e.execute(n,t,r)}))}function tc(n,t,e){Li(n.element(),t.selector).each((function(e){t.focusManager.set(n,e)}))}function ec(n,t,e){return Pu(n,e.selector,t,-1)}function rc(n,t,e){return Pu(n,e.selector,t,1)}function oc(n,t){return function(n,t,e){return qe(n,t,Xr(e))}(n,{},it(t,(function(t){return function(n,t){return Kr(n,n,zr(),_e((function(e){return Rr("The field: "+n+" is forbidden. "+t)})))}(t.name(),"Cannot configure "+t.name()+" for "+n)})).concat([Ye("dump",o)]))}function ic(n){return n.dump}function uc(n,e){return t(t({},n.dump),so(e))}function cc(n){return Mn(n,"uiType")}function ac(n,t,e,r){return cc(e)&&e.uiType===_a?function(n,t,e,r){return n.exists((function(n){return n!==e.owner}))?Ma.single(!0,u(e)):_n(r,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+On(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(n){return n.replace()}))}(n,0,e,r):Ma.single(!1,u(e))}function fc(n,t,e,r){var o=b(r,(function(n,t){return function(n,t){var e=!1;return{name:u(n),required:function(){return t.fold((function(n,t){return n}),(function(n,t){return n}))},used:function(){return e},replace:function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+n);return e=!0,t}}}(t,n)})),i=function(n,t,e,r){return R(e,(function(e){return Ia(n,t,e,r)}))}(n,t,e,o);return En(o,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),i}function sc(n){var t=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++Ba+String(t)}function lc(n){function t(n){return n.name}return n.fold(t,t,t,t)}function dc(n,t){return function(e){var r=je("Converting part type",t,e);return n(r)}}function mc(n,t,e,r){return de(t.defaults(n,e,r),e,{uid:n.partUids[t.name]},t.overrides(n,e,r))}function gc(n,e){var r={};return C(e,(function(e){(function(n){return n.fold(Tn.some,Tn.none,Tn.some,Tn.some)})(e).each((function(e){var o=Qa(n,e.pname);r[e.name]=function(r){var i=je("Part: "+e.name+" in "+n,Xr(e.schema),r);return t(t({},o),{config:r,validated:i})}}))})),r}function pc(n,t,e){return function(n,t,e){var r={},o={};return C(e,(function(n){n.fold((function(n){r[n.pname]=Aa(!0,(function(t,e,r){return n.factory.sketch(mc(t,n,e,r))}))}),(function(n){var e=t.parts[n.name];o[n.name]=u(n.factory.sketch(mc(t,n,e[Ja()]),e))}),(function(n){r[n.pname]=Aa(!1,(function(t,e,r){return n.factory.sketch(mc(t,n,e,r))}))}),(function(n){r[n.pname]=Fa(!0,(function(t,e,r){var o=t[n.name];return it(o,(function(e){return n.factory.sketch(de(n.defaults(t,e,r),e,n.overrides(t,e)))}))}))}))})),{internals:u(r),externals:u(o)}}(0,t,e)}function vc(n,t,e){return fc(Tn.some(n),t,t.components,e)}function hc(n,t,e){var r=t.partUids[e];return n.getSystem().getByUid(r).toOption()}function yc(n,t,e){return hc(n,t,e).getOrDie("Could not find part: "+e)}function bc(n,t){var e=function(n){return it(n,lc)}(t);return we(it(e,(function(t){return{key:t,value:n+"-"+t}})))}function xc(n){return Kr("partUids","partUids",Gr((function(t){return bc(t.uid,n)})),Zr())}function wc(n){return xe(Za,n)}function Sc(n){return function(n,t){var e=t.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:uo(i.slice(1))}},n}((function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return n.apply(void 0,[t.getApis()].concat([t].concat(e)))}),n)}function Tc(n){return sc(n)}function Oc(n,t,e,r,o){var i=function(n,t){return(0<n.length?[Le("parts",n)]:[]).concat([Pe("uid"),Xe("dom",{}),Xe("components",[]),$o("originalSpec"),Xe("debug.sketcher",{})]).concat(t)}(r,o);return je(n+" [SpecSchema]",Me(i.concat(t)),e)}function kc(n,t,e,r,o){var i=cf(o),u=function(n){return R(n,(function(n){return n.fold(Tn.none,Tn.some,Tn.none,Tn.none).map((function(n){return Le(n.name,n.schema.concat([$o(Ja())]))})).toArray()}))}(e),c=xc(e),a=Oc(n,t,i,u,[c]),f=pc(0,a,e);return r(a,vc(n,a,f.internals()),i,f.externals())}(au=cu=cu||{}).OnFocusMode="onFocus",au.OnEnterOrSpaceMode="onEnterOrSpace",au.OnApiMode="onApi";var Ec,Cc,Dc,_c,Mc,Ic,Ac,Fc,Rc,Bc,Vc=xu(Ye("cyclic",u(!1))),Nc=xu(Ye("cyclic",u(!0))),jc=[Xe("execute",Su),Xe("useSpace",!1),Xe("useEnter",!0),Xe("useControlEnter",!1),Xe("useDown",!1)],Hc=bu(jc,ao.init,(function(n,t,e,r){var o=e.useSpace&&!wu(n.element())?[32]:[],i=e.useEnter?[13]:[],u=e.useDown?[40]:[],c=o.concat(i).concat(u);return[Qi(qi(c),Ou)].concat(e.useControlEnter?[Qi(Yi([Ji,qi([13])]),Ou)]:[])}),(function(n,t,e,r){return e.useSpace&&!wu(n.element())?[Qi(qi([32]),Tu)]:[]}),(function(){return Tn.none()})),Pc=Object.freeze({__proto__:null,flatgrid:ku,init:function(n){return n.state(n)}}),zc=function(n){return"rtl"===ri(n,"direction")?"rtl":"ltr"},Lc=function(n,t,e,r,o){return r.focusManager.get(t).bind((function(e){return n(t.element(),e,r,o)})).map((function(n){return r.focusManager.set(t,n),!0}))},Gc=Mu,Uc=Mu,$c=Mu,Wc=[Pe("selector"),Xe("execute",Su),zo("onEscape"),Xe("captureTab",!1),pi()],Xc=ju((function(n,t,e,r){return Bu(n,t,e,r,-1)})),qc=ju((function(n,t,e,r){return Bu(n,t,e,r,1)})),Yc=ju((function(n,t,e,r){return Vu(n,t,e,r,-1)})),Kc=ju((function(n,t,e,r){return Vu(n,t,e,r,1)})),Jc=u([Qi(qi([37]),Du(Xc,qc)),Qi(qi([39]),_u(Xc,qc)),Qi(qi([38]),Gc(Yc)),Qi(qi([40]),Uc(Kc)),Qi(Yi([Ki,qi([9])]),Hu),Qi(Yi([su,qi([9])]),Hu),Qi(qi([27]),(function(n,t,e){return e.onEscape(n,t)})),Qi(qi([32].concat([13])),(function(n,t,e,r){return function(n,t){return t.focusManager.get(n).bind((function(n){return Gi(n,t.selector)}))}(n,e).bind((function(r){return e.execute(n,t,r)}))}))]),Qc=u([Qi(qi([32]),Tu)]),Zc=bu(Wc,ku,Jc,Qc,(function(){return Tn.some(Nu)})),na=[Pe("selector"),Xe("getInitial",Tn.none),Xe("execute",Su),zo("onEscape"),Xe("executeOnMove",!1),Xe("allowVertical",!0)],ta=u([Qi(qi([32]),Tu)]),ea=bu(na,ao.init,(function(n,t,e,r){var o=[37].concat(e.allowVertical?[38]:[]),i=[39].concat(e.allowVertical?[40]:[]);return[Qi(qi(o),$u(Du(Gu,Uu))),Qi(qi(i),$u(_u(Gu,Uu))),Qi(qi([13]),zu),Qi(qi([32]),zu),Qi(qi([27]),Wu)]}),ta,(function(){return Tn.some(Lu)})),ra=tn(["rowIndex","columnIndex","cell"],[]),oa=[Le("selectors",[Pe("row"),Pe("cell")]),Xe("cycles",!0),Xe("previousSelector",Tn.none),Xe("execute",Su)],ia=Zu((function(n,t,e){return qu(n,t,e,-1)}),(function(n,t,e){return Ku(n,t,e,-1)})),ua=Zu((function(n,t,e){return qu(n,t,e,1)}),(function(n,t,e){return Ku(n,t,e,1)})),ca=Zu((function(n,t,e){return Yu(n,e,t,-1)}),(function(n,t,e){return Ju(n,e,t,-1)})),aa=Zu((function(n,t,e){return Yu(n,e,t,1)}),(function(n,t,e){return Ju(n,e,t,1)})),fa=u([Qi(qi([37]),Du(ia,ua)),Qi(qi([39]),_u(ia,ua)),Qi(qi([38]),Gc(ca)),Qi(qi([40]),Uc(aa)),Qi(qi([32].concat([13])),(function(n,t,e){return To(n.element()).bind((function(r){return e.execute(n,t,r)}))}))]),sa=u([Qi(qi([32]),Tu)]),la=bu(oa,ao.init,fa,sa,(function(){return Tn.some(Qu)})),da=[Pe("selector"),Xe("execute",Su),Xe("moveOnTab",!1)],ma=u([Qi(qi([38]),$c(ec)),Qi(qi([40]),$c(rc)),Qi(Yi([Ki,qi([9])]),(function(n,t,e,r){return e.moveOnTab?$c(ec)(n,t,e,r):Tn.none()})),Qi(Yi([su,qi([9])]),(function(n,t,e,r){return e.moveOnTab?$c(rc)(n,t,e,r):Tn.none()})),Qi(qi([13]),nc),Qi(qi([32]),nc)]),ga=u([Qi(qi([32]),Tu)]),pa=bu(da,ao.init,ma,ga,(function(){return Tn.some(tc)})),va=[zo("onSpace"),zo("onEnter"),zo("onShiftEnter"),zo("onLeft"),zo("onRight"),zo("onTab"),zo("onShiftTab"),zo("onUp"),zo("onDown"),zo("onEscape"),Xe("stopSpaceKeyup",!1),Ge("focusIn")],ha=bu(va,ao.init,(function(n,t,e){return[Qi(qi([32]),e.onSpace),Qi(Yi([su,qi([13])]),e.onEnter),Qi(Yi([Ki,qi([13])]),e.onShiftEnter),Qi(Yi([Ki,qi([9])]),e.onShiftTab),Qi(Yi([su,qi([9])]),e.onTab),Qi(qi([38]),e.onUp),Qi(qi([40]),e.onDown),Qi(qi([37]),e.onLeft),Qi(qi([39]),e.onRight),Qi(qi([32]),e.onSpace),Qi(qi([27]),e.onEscape)]}),(function(n,t,e){return e.stopSpaceKeyup?[Qi(qi([32]),Tu)]:[]}),(function(n){return n.focusIn})),ya=Vc.schema(),ba=Nc.schema(),xa=ea.schema(),wa=Zc.schema(),Sa=la.schema(),Ta=Hc.schema(),Oa=pa.schema(),ka=ha.schema(),Ea=(Bc=je("Creating behaviour: "+(Rc={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:ya,cyclic:ba,flow:xa,flatgrid:wa,matrix:Sa,execution:Ta,menu:Oa,special:ka}),name:"keying",active:{events:function(n,t){return n.handler.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold((function(){n.getSystem().triggerFocus(n.element(),n.element())}),(function(r){r(n,t,e)}))},setGridSize:function(t,e,r,o,i){!function(n){return x(n,"setGridSize")}(r)?n.console.error("Layout does not support setGridSize"):r.setGridSize(o,i)}},state:Pc}).name,mo,Rc),Ec=He(Bc.branchKey,Bc.branches),Cc=Bc.name,Dc=Bc.active,_c=Bc.apis,Mc=Bc.extra,Ic=Bc.state,Fc=$e(Cc,[Ue("config",Ac=Ec)]),co(Ac,Fc,Cc,Dc,_c,Mc,Ic)),Ca=oc,Da=uc,_a="placeholder",Ma=se([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Ia=function(n,e,r,i){return ac(n,0,r,i).fold((function(o,u){var c=cc(r)?u(e,r.config,r.validated):u(e),a=_n(c,"components").getOr([]),f=R(a,(function(t){return Ia(n,e,t,i)}));return[t(t({},c),{components:f})]}),(function(n,t){if(cc(r)){var i=t(e,r.config,r.validated);return r.validated.preprocess.getOr(o)(i)}return t(e)}))},Aa=Ma.single,Fa=Ma.multiple,Ra=u(_a),Ba=0,Va=se([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Na=Xe("factory",{sketch:o}),ja=Xe("schema",[]),Ha=Pe("name"),Pa=Kr("pname","pname",Lr((function(n){return"<alloy."+sc(n.name)+">"})),Zr()),za=Ye("schema",(function(){return[Ge("preprocess")]})),La=Xe("defaults",u({})),Ga=Xe("overrides",u({})),Ua=Xr([Na,ja,Ha,Pa,La,Ga]),$a=Xr([Na,ja,Ha,La,Ga]),Wa=Xr([Na,ja,Ha,Pa,La,Ga]),Xa=Xr([Na,za,Ha,Pe("unit"),Pa,La,Ga]),qa=dc(Va.required,Ua),Ya=(dc(Va.external,$a),dc(Va.optional,Wa)),Ka=dc(Va.group,Xa),Ja=u("entirety"),Qa=function(n,t){return{uiType:Ra(),owner:n,name:t}},Za=sc("alloy-premade"),nf=u("alloy-id-"),tf=u("data-alloy-id"),ef=nf(),rf=tf(),of=function(n,t){Object.defineProperty(n.dom(),rf,{value:t,writable:!0})},uf=function(n){var t=qt(n)?n.dom()[rf]:null;return Tn.from(t)},cf=function(n){return function(n){return Mn(n,"uid")}(n)?n:t(t({},n),{uid:Tc("uid")})};function af(n){var e=je("Sketcher for "+n.name,Fs,n),r=b(e.apis,Sc),o=b(e.extraApis,(function(n,t){return ur(n,t)}));return t(t({name:u(e.name),configFields:u(e.configFields),sketch:function(n){return function(n,t,e,r){var o=cf(r);return e(Oc(n,t,o,[],[]),o)}(e.name,e.configFields,e.factory,n)}},r),o)}function ff(n){var e=je("Sketcher for "+n.name,Rs,n),r=gc(e.name,e.partFields),o=b(e.apis,Sc),i=b(e.extraApis,(function(n,t){return ur(n,t)}));return t(t({name:u(e.name),partFields:u(e.partFields),configFields:u(e.configFields),sketch:function(n){return kc(e.name,e.configFields,e.partFields,e.factory,n)},parts:u(r)},o),i)}function sf(n){var e=Ut.fromHtml(n),r=ne(e),o=function(n){var e=void 0!==n.dom().attributes?n.dom().attributes:[];return M(e,(function(n,e){var r;return"class"===e.name?n:t(t({},n),((r={})[e.name]=e.value,r))}),{})}(e),i=function(n){return Array.prototype.slice.call(n.dom().classList,0)}(e),u=0===r.length?{}:{innerHtml:Oo(e)};return t({tag:Y(e),classes:i,attributes:o},u)}function lf(n){return{dom:Ns(n)}}function df(n){return so([Ti.config({toggleClass:Di.resolve("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Oi(n,(function(n,t){(t?Ti.on:Ti.off)(n)}))])}function mf(n,t){var e=t.ui.registry.getAll().icons;return Tn.from(e[n]).fold((function(){return Ns('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')}),(function(n){return Ns('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")}))}function gf(n){return Ya({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold((function(){return{}}),(function(n){return{events:Ze([er(mt(),(function(t,e,r){return n(t,r)}),[t]),er(vt(),(function(t,e,r){return n(t,r)}),[t]),er(ht(),(function(t,e,r){r.mouseIsDown.get()&&n(t,r)}),[t])])}}))}})}function pf(n,t,e){t.store.manager.onLoad(n,t,e)}function vf(n,t,e){t.store.manager.onUnload(n,t,e)}function hf(){var n=In(null);return fo({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})}function yf(){var n=In({}),e=In({});return fo({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:e.get()}},lookup:function(t){return _n(n.get(),t).orThunk((function(){return _n(e.get(),t)}))},update:function(r){var o=n.get(),i=e.get(),u={},c={};C(r,(function(n){u[n.value]=n,_n(n,"meta").each((function(t){_n(t,"text").each((function(t){c[t]=n}))}))})),n.set(t(t({},o),u)),e.set(t(t({},i),c))},clear:function(){n.set({}),e.set({})}})}function bf(n,t,e,r){var o=t.store;e.update([r]),o.setValue(n,r),t.onSetValue(n,r)}function xf(n,t){rl.set(n,t)}function wf(n){return rl.get(n)}function Sf(n){var t=n.event().raw();if(function(n){return-1!==n.type.indexOf("touch")}(t)){var e=t;return void 0!==e.touches&&1===e.touches.length?Tn.some(e.touches[0]).map((function(n){return il(n.clientX,n.clientY)})):Tn.none()}var r=t;return void 0!==r.clientX?Tn.some(r).map((function(n){return il(n.clientX,n.clientY)})):Tn.none()}function Tf(n){return n.model.minX}function Of(n){return n.model.minY}function kf(n){return n.model.minX-1}function Ef(n){return n.model.minY-1}function Cf(n){return n.model.maxX}function Df(n){return n.model.maxY}function _f(n){return n.model.maxX+1}function Mf(n){return n.model.maxY+1}function If(n,t,e){return t(n)-e(n)}function Af(n){return If(n,Cf,Tf)}function Ff(n){return If(n,Df,Of)}function Rf(n){return Af(n)/2}function Bf(n){return Ff(n)/2}function Vf(n){return n.stepSize}function Nf(n){return n.snapToGrid}function jf(n){return n.snapStart}function Hf(n){return n.rounded}function Pf(n,t){return void 0!==n[t+"-edge"]}function zf(n){return Pf(n,"left")}function Lf(n){return Pf(n,"right")}function Gf(n){return Pf(n,"top")}function Uf(n){return Pf(n,"bottom")}function $f(n){return n.model.value.get()}function Wf(n){return{x:u(n)}}function Xf(n){return{y:u(n)}}function qf(n,t){return{x:u(n),y:u(t)}}function Yf(n,t){$(n,ul(),{value:t})}function Kf(n,t,e,r){return n<t?n:e<n?e:n===t?t-1:Math.max(t,n-r)}function Jf(n,t,e,r){return e<n?n:n<t?t:n===e?e+1:Math.min(e,n+r)}function Qf(n,t,e){return Math.max(t,Math.min(e,n))}function Zf(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=f?t-1:t,p=s?e+1:e;if(o<l)return g;if(d<o)return p;var v=function(n,t,e){return Math.min(e,Math.max(n,t))-t}(o,l,d),h=Qf(v/m*r+t,g,p);return u&&t<=h&&h<=e?function(n,t,e,r,o){return o.fold((function(){var o=n-t,i=Math.round(o/r)*r;return Qf(t+i,t-1,e+1)}),(function(t){var o=(n-t)%r,i=Math.round(o/r),u=Math.floor((n-t)/r),c=Math.floor((e-t)/r),a=t+Math.min(c,u+i)*r;return Math.max(t,a)}))}(h,t,e,i,c):a?Math.round(h):h}function ns(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge;return o<t?i?0:f:e<o?u?c:s:(o-t)/r*a}function ts(n){return n.element().dom().getBoundingClientRect()}function es(n,t){return n[t]}function rs(n){var t=ts(n);return es(t,cl)}function os(n){var t=ts(n);return es(t,"right")}function is(n){var t=ts(n);return es(t,"top")}function us(n){var t=ts(n);return es(t,"bottom")}function cs(n){var t=ts(n);return es(t,"width")}function as(n){var t=ts(n);return es(t,"height")}function fs(n,t,e){return(n+t)/2-e}function ss(n,t){var e=ts(n),r=ts(t),o=es(e,cl),i=es(e,"right"),u=es(r,cl);return fs(o,i,u)}function ls(n,t){var e=ts(n),r=ts(t),o=es(e,"top"),i=es(e,"bottom"),u=es(r,"top");return fs(o,i,u)}function ds(n,t){$(n,ul(),{value:t})}function ms(n){return{x:u(n)}}function gs(n,t,e){var r={min:Tf(t),max:Cf(t),range:Af(t),value:e,step:Vf(t),snap:Nf(t),snapStart:jf(t),rounded:Hf(t),hasMinEdge:zf(t),hasMaxEdge:Lf(t),minBound:rs(n),maxBound:os(n),screenRange:cs(n)};return Zf(r)}function ps(n){return function(t,e){return function(n,t,e){var r=(0<n?Jf:Kf)($f(e).x(),Tf(e),Cf(e),Vf(e));return ds(t,ms(r)),Tn.some(r)}(n,t,e).map((function(){return!0}))}}function vs(n,t,e,r,o,i){var u=function(n,t,e,r,o){var i=cs(n),u=r.bind((function(t){return Tn.some(ss(t,n))})).getOr(0),c=o.bind((function(t){return Tn.some(ss(t,n))})).getOr(i),a={min:Tf(t),max:Cf(t),range:Af(t),value:e,hasMinEdge:zf(t),hasMaxEdge:Lf(t),minBound:rs(n),minOffset:0,maxBound:os(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:c};return ns(a)}(t,i,e,r,o);return rs(t)-rs(n)+u}function hs(n,t){$(n,ul(),{value:t})}function ys(n){return{y:u(n)}}function bs(n,t,e){var r={min:Of(t),max:Df(t),range:Ff(t),value:e,step:Vf(t),snap:Nf(t),snapStart:jf(t),rounded:Hf(t),hasMinEdge:Gf(t),hasMaxEdge:Uf(t),minBound:is(n),maxBound:us(n),screenRange:as(n)};return Zf(r)}function xs(n){return function(t,e){return function(n,t,e){var r=(0<n?Jf:Kf)($f(e).y(),Of(e),Df(e),Vf(e));return hs(t,ys(r)),Tn.some(r)}(n,t,e).map((function(){return!0}))}}function ws(n,t,e,r,o,i){var u=function(n,t,e,r,o){var i=as(n),u=r.bind((function(t){return Tn.some(ls(t,n))})).getOr(0),c=o.bind((function(t){return Tn.some(ls(t,n))})).getOr(i),a={min:Of(t),max:Df(t),range:Ff(t),value:e,hasMinEdge:Gf(t),hasMaxEdge:Uf(t),minBound:is(n),minOffset:0,maxBound:us(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:c};return ns(a)}(t,i,e,r,o);return is(t)-is(n)+u}function Ss(n,t){$(n,ul(),{value:t})}function Ts(n,t){return{x:u(n),y:u(t)}}function Os(n,t){return function(e,r){return function(n,t,e,r){var o=0<n?Jf:Kf,i=t?$f(r).x():o($f(r).x(),Tf(r),Cf(r),Vf(r)),u=t?o($f(r).y(),Of(r),Df(r),Vf(r)):$f(r).y();return Ss(e,Ts(i,u)),Tn.some(i)}(n,t,e,r).map((function(){return!0}))}}function ks(n,t,e,r){return Hs.forToolbar(t,(function(){var r=e();n.setContextToolbar([{label:t+" group",items:r}])}),{},r)}function Es(n){return[function(n){function t(n){return n<0?"black":360<n?"white":"hsl("+n+", 100%, 50%)"}return Dl.sketch({dom:Ns('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[Dl.parts()["left-edge"](lf('<div class="${prefix}-hue-slider-black"></div>')),Dl.parts().spectrum({dom:Ns('<div class="${prefix}-slider-gradient-container"></div>'),components:[lf('<div class="${prefix}-slider-gradient"></div>')],behaviours:so([Ti.config({toggleClass:Di.resolve("thumb-active")})])}),Dl.parts()["right-edge"](lf('<div class="${prefix}-hue-slider-white"></div>')),Dl.parts().thumb({dom:Ns('<div class="${prefix}-slider-thumb"></div>'),behaviours:so([Ti.config({toggleClass:Di.resolve("thumb-active")})])})],onChange:function(e,r,o){var i=t(o.x());Fi(r.element(),"background-color",i),n.onChange(e,r,i)},onDragStart:function(n,t){Ti.on(t)},onDragEnd:function(n,t){Ti.off(t)},onInit:function(n,e,r,o){var i=t(o.x());Fi(e.element(),"background-color",i)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:function(){return n.getInitialValue()}}}},sliderBehaviours:so([ki(Dl.refresh)])})}(n)]}function Cs(n,t){return(qt(t)?Tn.some(t):fn(t).filter(qt)).map((function(t){return function(n,t,e){return yo((function(n,t){return t(n)}),bo,n,t,e)}(t,(function(n){return oi(n,"font-size").isSome()}),n).bind((function(n){return oi(n,"font-size")})).getOrThunk((function(){return ri(t,"font-size")}))})).getOr("")}function Ds(n){var t=n.selection.getStart(),e=Ut.fromDom(t),r=Ut.fromDom(n.getBody()),o=Cs((function(n){return cn(r,n)}),e);return I(Al,(function(n){return o===n})).getOr("medium")}function _s(n){return[lf('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),function(n){return Il({onChange:n.onChange,sizes:Rl,category:"font",getInitialValue:n.getInitialValue})}(n),lf('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]}function Ms(n){var e=function(n){return void 0!==n.uid}(n)&&x(n,"uid")?n.uid:Tc("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOption()},asSpec:function(){return t(t({},n),{uid:e})}}}var Is,As,Fs=Me([Pe("name"),Pe("factory"),Pe("configFields"),Xe("apis",{}),Xe("extraApis",{})]),Rs=Me([Pe("name"),Pe("factory"),Pe("configFields"),Pe("partFields"),Xe("apis",{}),Xe("extraApis",{})]),Bs=af({name:"Button",factory:function(n){function e(t){return _n(n.dom,"attributes").bind((function(n){return _n(n,t)}))}var r=function(n){return Ze(F([n.map((function(n){return io((function(t,e){n(t),e.stop()}))})).toArray(),Qo()]))}(n.action),o=n.dom.tag;return{uid:n.uid,dom:n.dom,components:n.components,events:r,behaviours:Da(n.buttonBehaviours,[Ai.config({}),Ea.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==o)return{role:e("role").getOr("button")};var n=e("type").getOr("button"),r=e("role").map((function(n){return{role:n}})).getOr({});return t({type:n},r)}()},eventOrder:n.eventOrder}},configFields:[Xe("uid",void 0),Pe("dom"),Xe("components",[]),Ca("buttonBehaviours",[Ai,Ea]),Ge("action"),Ge("role"),Xe("eventOrder",{})]}),Vs=lr({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return Ze([nr(Et(),u(!0))])},exhibit:function(){return cr({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Ns=function(n){var t=function(n,t){return n.replace(/\$\{([^{}]*)\}/g,(function(n,e){var r=t[e];return function(n){var t=typeof n;return"string"==t||"number"==t}(r)?r.toString():n}))}(n,{prefix:Di.prefix()});return sf(t)},js=function(n,t,e,r){return Bs.sketch({dom:mf(n,r),action:t,buttonBehaviours:de(so([Vs.config({})]),e)})},Hs={forToolbar:js,forToolbarCommand:function(n,t){return js(t,(function(){n.execCommand(t)}),{},n)},forToolbarStateAction:function(n,t,e,r){var o=df(e);return js(t,r,o,n)},forToolbarStateCommand:function(n,t){var e=df(t);return js(t,(function(){n.execCommand(t)}),e,n)},getToolbarIconButton:mf},Ps=Ya({schema:[Pe("dom")],name:"label"}),zs=gf("top-left"),Ls=gf("top"),Gs=gf("top-right"),Us=gf("right"),$s=gf("bottom-right"),Ws=gf("bottom"),Xs=gf("bottom-left"),qs=[Ps,gf("left"),Us,Ls,Ws,zs,Gs,Xs,$s,qa({name:"thumb",defaults:u({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Ze([or(mt(),n,"spectrum"),or(gt(),n,"spectrum"),or(pt(),n,"spectrum"),or(vt(),n,"spectrum"),or(ht(),n,"spectrum"),or(yt(),n,"spectrum")])}}}),qa({schema:[Ye("mouseIsDown",(function(){return In(!1)}))],name:"spectrum",overrides:function(n){function t(t,r){return e.getValueFromEvent(r).map((function(r){return e.setValueFrom(t,n,r)}))}var e=n.model.manager;return{behaviours:so([Ea.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),Ai.config({})]),events:Ze([tr(mt(),t),tr(gt(),t),tr(vt(),t),tr(ht(),(function(e,r){n.mouseIsDown.get()&&t(e,r)}))])}}})],Ys=Object.freeze({__proto__:null,onLoad:pf,onUnload:vf,setValue:function(n,t,e,r){t.store.manager.setValue(n,t,e,r)},getValue:function(n,t,e){return t.store.manager.getValue(n,t,e)},getState:function(n,t,e){return e}}),Ks=Object.freeze({__proto__:null,events:function(n,t){var e=n.resetOnDom?[eo((function(e,r){pf(e,n,t)})),ro((function(e,r){vf(e,n,t)}))]:[ar(n,t,pf)];return Ze(e)}}),Js=Object.freeze({__proto__:null,memory:hf,dataset:yf,manual:function(){return fo({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),Qs=[Ge("initialValue"),Pe("getFallbackEntry"),Pe("getDataKey"),Pe("setValue"),Uo("manager",{setValue:bf,getValue:function(n,t,e){var r=t.store,o=r.getDataKey(n);return e.lookup(o).fold((function(){return r.getFallbackEntry(o)}),(function(n){return n}))},onLoad:function(n,t,e){t.store.initialValue.each((function(r){bf(n,t,e,r)}))},onUnload:function(n,t,e){e.clear()},state:yf})],Zs=[Pe("getValue"),Xe("setValue",r),Ge("initialValue"),Uo("manager",{setValue:function(n,t,e,r){t.store.setValue(n,r),t.onSetValue(n,r)},getValue:function(n,t,e){return t.store.getValue(n)},onLoad:function(n,t,e){t.store.initialValue.each((function(e){t.store.setValue(n,e)}))},onUnload:r,state:ao.init})],nl=[Ge("initialValue"),Uo("manager",{setValue:function(n,t,e,r){e.set(r),t.onSetValue(n,r)},getValue:function(n,t,e){return e.get()},onLoad:function(n,t,e){t.store.initialValue.each((function(n){e.isNotSet()&&e.set(n)}))},onUnload:function(n,t,e){e.clear()},state:hf})],tl=[qe("store",{mode:"memory"},He("mode",{memory:nl,manual:Zs,dataset:Qs})),Po("onSetValue"),Xe("resetOnDom",!1)],el=lr({fields:tl,name:"representing",active:Ks,apis:Ys,extra:{setValueFrom:function(n,t){var e=el.getValue(t);el.setValue(n,e)}},state:Js}),rl=Bi("width",(function(n){return n.dom().offsetWidth})),ol=function(n,t){return{left:u(n),top:u(t),translate:function(e,r){return ol(n+e,t+r)}}},il=ol,ul=u("slider.change.value"),cl="left",al=ps(-1),fl=ps(1),sl=Tn.none,ll=Tn.none,dl={"top-left":Tn.none(),top:Tn.none(),"top-right":Tn.none(),right:Tn.some((function(n,t){Yf(n,Wf(_f(t)))})),"bottom-right":Tn.none(),bottom:Tn.none(),"bottom-left":Tn.none(),left:Tn.some((function(n,t){Yf(n,Wf(kf(t)))}))},ml=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=gs(n,t,e),o=ms(r);return ds(n,o),r},setToMin:function(n,t){var e=Tf(t);ds(n,ms(e))},setToMax:function(n,t){var e=Cf(t);ds(n,ms(e))},findValueOfOffset:gs,getValueFromEvent:function(n){return Sf(n).map((function(n){return n.left()}))},findPositionOfValue:vs,setPositionFromValue:function(n,t,e,r){var o=$f(e),i=vs(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),e),u=wf(t.element())/2;Fi(t.element(),"left",i-u+"px")},onLeft:al,onRight:fl,onUp:sl,onDown:ll,edgeActions:dl}),gl=Tn.none,pl=Tn.none,vl=xs(-1),hl=xs(1),yl={"top-left":Tn.none(),top:Tn.some((function(n,t){Yf(n,Xf(Ef(t)))})),"top-right":Tn.none(),right:Tn.none(),"bottom-right":Tn.none(),bottom:Tn.some((function(n,t){Yf(n,Xf(Mf(t)))})),"bottom-left":Tn.none(),left:Tn.none()},bl=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=bs(n,t,e),o=ys(r);return hs(n,o),r},setToMin:function(n,t){var e=Of(t);hs(n,ys(e))},setToMax:function(n,t){var e=Df(t);hs(n,ys(e))},findValueOfOffset:bs,getValueFromEvent:function(n){return Sf(n).map((function(n){return n.top()}))},findPositionOfValue:ws,setPositionFromValue:function(n,t,e,r){var o=$f(e),i=ws(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),e),u=Vi(t.element())/2;Fi(t.element(),"top",i-u+"px")},onLeft:gl,onRight:pl,onUp:vl,onDown:hl,edgeActions:yl}),xl=Os(-1,!1),wl=Os(1,!1),Sl=Os(-1,!0),Tl=Os(1,!0),Ol={"top-left":Tn.some((function(n,t){Yf(n,qf(kf(t),Ef(t)))})),top:Tn.some((function(n,t){Yf(n,qf(Rf(t),Ef(t)))})),"top-right":Tn.some((function(n,t){Yf(n,qf(_f(t),Ef(t)))})),right:Tn.some((function(n,t){Yf(n,qf(_f(t),Bf(t)))})),"bottom-right":Tn.some((function(n,t){Yf(n,qf(_f(t),Mf(t)))})),bottom:Tn.some((function(n,t){Yf(n,qf(Rf(t),Mf(t)))})),"bottom-left":Tn.some((function(n,t){Yf(n,qf(kf(t),Mf(t)))})),left:Tn.some((function(n,t){Yf(n,qf(kf(t),Bf(t)))}))},kl=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=gs(n,t,e.left()),o=bs(n,t,e.top()),i=Ts(r,o);return Ss(n,i),i},setToMin:function(n,t){var e=Tf(t),r=Of(t);Ss(n,Ts(e,r))},setToMax:function(n,t){var e=Cf(t),r=Df(t);Ss(n,Ts(e,r))},getValueFromEvent:function(n){return Sf(n)},setPositionFromValue:function(n,t,e,r){var o=$f(e),i=vs(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),e),u=ws(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),e),c=wf(t.element())/2,a=Vi(t.element())/2;Fi(t.element(),"left",i-c+"px"),Fi(t.element(),"top",u-a+"px")},onLeft:xl,onRight:wl,onUp:Sl,onDown:Tl,edgeActions:Ol}),El=[Xe("stepSize",1),Xe("onChange",r),Xe("onChoose",r),Xe("onInit",r),Xe("onDragStart",r),Xe("onDragEnd",r),Xe("snapToGrid",!1),Xe("rounded",!0),Ge("snapStart"),ze("model",He("mode",{x:[Xe("minX",0),Xe("maxX",100),Ye("value",(function(n){return In(n.mode.minX)})),Pe("getInitialValue"),Uo("manager",ml)],y:[Xe("minY",0),Xe("maxY",100),Ye("value",(function(n){return In(n.mode.minY)})),Pe("getInitialValue"),Uo("manager",bl)],xy:[Xe("minX",0),Xe("maxX",100),Xe("minY",0),Xe("maxY",100),Ye("value",(function(n){return In({x:u(n.mode.minX),y:u(n.mode.minY)})})),Pe("getInitialValue"),Uo("manager",kl)]})),oc("sliderBehaviours",[Ea,el]),Ye("mouseIsDown",(function(){return In(!1)}))],Cl=u("mouse.released"),Dl=ff({name:"Slider",configFields:El,partFields:qs,factory:function(n,t,e,r){function o(t){return yc(t,n,"thumb")}function i(t){return yc(t,n,"spectrum")}function c(t){return hc(t,n,"left-edge")}function a(t){return hc(t,n,"right-edge")}function f(t){return hc(t,n,"top-edge")}function s(t){return hc(t,n,"bottom-edge")}function l(t,e){y.setPositionFromValue(t,e,n,{getLeftEdge:c,getRightEdge:a,getTopEdge:f,getBottomEdge:s,getSpectrum:i})}function d(t,e){h.value.set(e);var r=o(t);return l(t,r),n.onChange(t,r,e),Tn.some(!0)}function m(t){var e=n.mouseIsDown.get();n.mouseIsDown.set(!1),e&&hc(t,n,"thumb").each((function(e){var r=h.value.get();n.onChoose(t,e,r)}))}function g(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,o(t))}function p(t,e){e.stop(),n.onDragEnd(t,o(t)),m(t)}var v,h=n.model,y=h.manager;return{uid:n.uid,dom:n.dom,components:t,behaviours:uc(n.sliderBehaviours,[Ea.config({mode:"special",focusIn:function(t){return hc(t,n,"spectrum").map(Ea.focusIn).map(u(!0))}}),el.config({store:{mode:"manual",getValue:function(n){return h.value.get()}}}),hi.config({channels:(v={},v[Cl()]={onReceive:m},v)})]),events:Ze([tr(ul(),(function(n,t){d(n,t.event().value())})),eo((function(t,e){var r=h.getInitialValue();h.value.set(r);var u=o(t);l(t,u);var c=i(t);n.onInit(t,u,c,h.value.get())})),tr(mt(),g),tr(pt(),p),tr(vt(),g),tr(yt(),p)]),apis:{resetToMin:function(t){y.setToMin(t,n)},resetToMax:function(t){y.setToMax(t,n)},changeValue:d,refresh:l},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),_l=function(n,t){var e={onChange:function(n,e,r){t.undoManager.transact((function(){t.formatter.apply("forecolor",{value:r}),t.nodeChanged()}))},getInitialValue:function(){return-1}};return ks(n,"color-levels",(function(){return Es(e)}),t)},Ml=Me([Pe("getInitialValue"),Pe("onChange"),Pe("category"),Pe("sizes")]),Il=function(n){var t=je("SizeSlider",Ml,n);return Dl.sketch({dom:{tag:"div",classes:[Di.resolve("slider-"+t.category+"-size-container"),Di.resolve("slider"),Di.resolve("slider-size-container")]},onChange:function(n,e,r){var o=r.x();!function(n){return 0<=n&&n<t.sizes.length}(o)||t.onChange(o)},onDragStart:function(n,t){Ti.on(t)},onDragEnd:function(n,t){Ti.off(t)},model:{mode:"x",minX:0,maxX:t.sizes.length-1,getInitialValue:function(){return{x:function(){return t.getInitialValue()}}}},stepSize:1,snapToGrid:!0,sliderBehaviours:so([ki(Dl.refresh)]),components:[Dl.parts().spectrum({dom:Ns('<div class="${prefix}-slider-size-container"></div>'),components:[lf('<div class="${prefix}-slider-size-line"></div>')]}),Dl.parts().thumb({dom:Ns('<div class="${prefix}-slider-thumb"></div>'),behaviours:so([Ti.config({toggleClass:Di.resolve("thumb-active")})])})]})},Al=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],Fl={candidates:u(Al),get:function(n){return function(n){return A(Al,(function(t){return t===n}))}(Ds(n)).getOr(2)},apply:function(n,t){(function(n){return Tn.from(Al[n])})(t).each((function(t){!function(n,t){Ds(n)!==t&&n.execCommand("fontSize",!1,t)}(n,t)}))}},Rl=Fl.candidates(),Bl=window.Promise?window.Promise:(Is=Vl.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(t){n.setTimeout(t,1)},As=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)},Vl.prototype["catch"]=function(n){return this.then(null,n)},Vl.prototype.then=function(n,t){var e=this;return new Vl((function(r,o){jl.call(e,new Ll(n,t,r,o))}))},Vl.all=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=Array.prototype.slice.call(1===n.length&&As(n[0])?n[0]:n);return new Vl((function(n,t){if(0===e.length)return n([]);var r=e.length;function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,(function(n){o(i,n)}),t)}e[i]=u,0==--r&&n(e)}catch(v){t(v)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},Vl.resolve=function(n){return n&&"object"==typeof n&&n.constructor===Vl?n:new Vl((function(t){t(n)}))},Vl.reject=function(n){return new Vl((function(t,e){e(n)}))},Vl.race=function(n){return new Vl((function(t,e){for(var r=0,o=n;r<o.length;r++)o[r].then(t,e)}))},Vl);function Vl(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Gl(n,Nl(Hl,this),Nl(Pl,this))}function Nl(n,t){return function(){return n.apply(t,arguments)}}function jl(n){var t=this;null!==this._state?Is((function(){var e=t._state?n.onFulfilled:n.onRejected;if(null!==e){var r;try{r=e(t._value)}catch(s){return void n.reject(s)}n.resolve(r)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function Hl(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void Gl(Nl(t,n),Nl(Hl,this),Nl(Pl,this))}this._state=!0,this._value=n,zl.call(this)}catch(s){Pl.call(this,s)}}function Pl(n){this._state=!1,this._value=n,zl.call(this)}function zl(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];jl.call(this,e)}this._deferreds=[]}function Ll(n,t,e,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=r}function Gl(n,t,e){var r=!1;try{n((function(n){r||(r=!0,t(n))}),(function(n){r||(r=!0,e(n))}))}catch(f){if(r)return;r=!0,e(f)}}function Ul(t){return function(t){return new Bl((function(e){var r=new n.FileReader;r.onloadend=function(){e(r.result)},r.readAsDataURL(t)}))}(t).then((function(n){return n.split(",")[1]}))}function $l(n,t){(function(n){return Ul(n)})(t).then((function(e){n.undoManager.transact((function(){var r=n.editorUpload.blobCache,o=r.create(sc("mceu"),t,e);r.add(o);var i=n.dom.createHTML("img",{src:o.blobUri()});n.insertContent(i)}))}))}function Wl(n){var t=Ms({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:Ze([ir(Ot()),tr(Tt(),(function(t,e){(function(n){var t=n.event(),e=t.raw().target.files||t.raw().dataTransfer.files;return Tn.from(e[0])})(e).each((function(t){$l(n,t)}))}))])});return Bs.sketch({dom:Hs.getToolbarIconButton("image",n),components:[t.asSpec()],action:function(n){t.get(n).element().dom().click()}})}function Xl(n){return n.dom().textContent}function ql(n){return 0<n.length}function Yl(n){return void 0===n||null===n?"":n}function Kl(n,t,e){return e.text.toOption().filter(ql).fold((function(){return function(n){return pr(n,"href")===Xl(n)}(n)?Tn.some(t):Tn.none()}),Tn.some)}function Jl(n,t){var e=t.selection.getRng();n(),t.selection.setRng(e)}function Ql(n){return n.dom().value}function Zl(n,t){if(void 0===t)throw new Error("Value.set was undefined");n.dom().value=t}function nd(n){return t(t({},function(n){return so([Ai.config({onFocus:n.selectOnFocus?function(n){var t=n.element(),e=Ql(t);t.dom().setSelectionRange(0,e.length)}:r})])}(n)),uc(n.inputBehaviours,[el.config({store:t(t({mode:"manual"},n.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return Ql(n.element())},setValue:function(n,t){Ql(n.element())!==t&&Zl(n.element(),t)}}),onSetValue:n.onSetValue})]))}function td(n,t){var e=Ms(sm.sketch({inputAttributes:{placeholder:gm.translate(t)},onSetValue:function(n,t){U(n,St())},inputBehaviours:so([um.config({find:Tn.some}),mm.config({}),Ea.config({mode:"execution"})]),selectOnFocus:!1})),r=Ms(Bs.sketch({dom:Ns('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var t=e.get(n);el.setValue(t,"")}}));return{name:n,spec:cm.sketch({dom:Ns('<div class="${prefix}-input-container"></div>'),components:[e.asSpec(),r.asSpec()],containerBehaviours:so([Ti.config({toggleClass:Di.resolve("input-container-empty")}),um.config({find:function(n){return Tn.some(e.get(n))}}),rm("input-clearing",[tr(St(),(function(n){var t=e.get(n);(0<el.getValue(t).length?Ti.off:Ti.on)(n)}))])])})}}function ed(n,t,e){t.disabled&&vm(n,t)}function rd(n,t){return!0===t.useNative&&k(pm,Y(n.element()))}function od(n){mr(n.element(),"disabled","disabled")}function id(n){hr(n.element(),"disabled")}function ud(n){mr(n.element(),"aria-disabled","true")}function cd(n){mr(n.element(),"aria-disabled","false")}function ad(n,t,e){t.disableClass.each((function(t){Or(n.element(),t)})),(rd(n,t)?id:cd)(n),t.onEnabled(n)}function fd(n,t){return rd(n,t)?function(n){return vr(n.element(),"disabled")}(n):function(n){return"true"===pr(n.element(),"aria-disabled")}(n)}function sd(n){return"<alloy.field."+n+">"}function ld(){function n(){t.get().each((function(n){n.destroy()}))}var t=In(Tn.none());return{clear:function(){n(),t.set(Tn.none())},isSet:function(){return t.get().isSome()},set:function(e){n(),t.set(Tn.some(e))},run:function(n){t.get().each(n)}}}function dd(){var n=In(Tn.none());return{clear:function(){n.set(Tn.none())},set:function(t){n.set(Tn.some(t))},isSet:function(){return n.get().isSome()},on:function(t){n.get().each(t)}}}function md(n){function t(n,t,e){return Bs.sketch({dom:Ns('<span class="${prefix}-icon-'+t+' ${prefix}-icon"></span>'),action:function(t){$(t,o,{direction:n})},buttonBehaviours:so([xm.config({disableClass:Di.resolve("toolbar-navigation-disabled"),disabled:!e})])})}function e(n,t){var e=Hi(n.element(),"."+Di.resolve("serialised-dialog-screen"));Li(n.element(),"."+Di.resolve("serialised-dialog-chain")).each((function(n){0<=u.state.currentScreen.get()+t&&u.state.currentScreen.get()+t<e.length&&(oi(n,"left").each((function(r){var o=parseInt(r,10),i=wf(e[0]);Fi(n,"left",o-t*i+"px")})),u.state.currentScreen.set(u.state.currentScreen.get()+t))}))}function r(n){var t=Hi(n.element(),"input");Tn.from(t[u.state.currentScreen.get()]).each((function(t){n.getSystem().getByDom(t).each((function(t){!function(n,t){n.getSystem().triggerFocus(t,n.element())}(n,t.element())}))}));var e=a.get(n);yu.highlightAt(e,u.state.currentScreen.get())}var o="navigateEvent",i=Xr([Pe("fields"),Xe("maxFieldIndex",n.fields.length-1),Pe("onExecute"),Pe("getInitialValue"),Ye("state",(function(){return{dialogSwipeState:dd(),currentScreen:In(0)}}))]),u=je("SerialisedDialog",i,n),c=Ms(Tm((function(n){return{dom:Ns('<div class="${prefix}-serialised-dialog"></div>'),components:[cm.sketch({dom:Ns('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:it(u.fields,(function(e,r){return r<=u.maxFieldIndex?cm.sketch({dom:Ns('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[t(-1,"previous",0<r),n.field(e.name,e.spec),t(1,"next",r<u.maxFieldIndex)]}):n.field(e.name,e.spec)}))})],formBehaviours:so([ki((function(n,t){!function(n,t){Li(n.element(),"."+Di.resolve("serialised-dialog-chain")).each((function(n){Fi(n,"left",-u.state.currentScreen.get()*t.width+"px")}))}(n,t)})),Ea.config({mode:"special",focusIn:function(n){r(n)},onTab:function(n){return e(n,1),Tn.some(!0)},onShiftTab:function(n){return e(n,-1),Tn.some(!0)}}),rm("form-events",[eo((function(n,t){u.state.currentScreen.set(0),u.state.dialogSwipeState.clear();var e=a.get(n);yu.highlightFirst(e),u.getInitialValue(n).each((function(t){el.setValue(n,t)}))})),io(u.onExecute),tr(kt(),(function(n,t){"left"===t.event().raw().propertyName&&r(n)})),tr(o,(function(n,t){var r=t.event().direction();e(n,r)}))])])}}))),a=Ms({dom:Ns('<div class="${prefix}-dot-container"></div>'),behaviours:so([yu.config({highlightClass:Di.resolve("dot-active"),itemClass:Di.resolve("dot-item")})]),components:R(u.fields,(function(n,t){return t<=u.maxFieldIndex?[lf('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]}))});return{dom:Ns('<div class="${prefix}-serializer-wrapper"></div>'),components:[c.asSpec(),a.asSpec()],behaviours:so([Ea.config({mode:"special",focusIn:function(n){var t=c.get(n);Ea.focusIn(t)}}),rm("serializer-wrapper-events",[tr(mt(),(function(n,t){var e=t.event();u.state.dialogSwipeState.set(Om(e.raw().touches[0].clientX))})),tr(gt(),(function(n,t){var e=t.event();u.state.dialogSwipeState.on((function(n){t.event().prevent(),u.state.dialogSwipeState.set(km(n,e.raw().touches[0].clientX))}))})),tr(pt(),(function(n){u.state.dialogSwipeState.on((function(t){var r=c.get(n),o=-1*Em(t);e(r,o)}))}))])])}}function gd(n){function t(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+Do(n().element())+" is not in context.":""))}}return{debugInfo:u("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:u(!1)}}function pd(n,t){var e={};return En(n,(function(n,r){En(n,(function(n,o){var i=_n(e,o).getOr([]);e[o]=i.concat([t(r,n)])}))})),e}function vd(n,t,e,r){try{var o=function(n,t){var e=et.call(n,0);return e.sort(t),e}(e,(function(e,o){var i=e[t](),u=o[t](),c=r.indexOf(i),a=r.indexOf(u);if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return c<a?-1:a<c?1:0}));return fe.value(o)}catch(s){return fe.error([s])}}function hd(n){return n.cHandler}function yd(n,t){return{name:u(n),handler:u(t)}}function bd(n,e,r){var o=t(t({},r),function(n,t){var e={};return C(n,(function(n){e[n.name()]=n.handlers(t)})),e}(e,n));return pd(o,yd)}function xd(n){var t=function(n){return nt(n)?{can:u(!0),abort:u(!1),run:n}:n}(n);return function(n,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[n,e].concat(r);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}}function wd(n,t,e){var r=t[e];return r?vd("Event: "+e,"name",n,r).map((function(n){var t=it(n,(function(n){return n.handler()}));return Qe(t)})):function(n,t){return fe.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(it(t,(function(n){return n.name()})),null,2)])}(e,n)}function Sd(n){return Ve("custom.definition",Xr([Kr("dom","dom",Pr(),Xr([Pe("tag"),Xe("styles",{}),Xe("classes",[]),Xe("attributes",{}),Ge("value"),Ge("innerHtml")])),Pe("components"),Pe("uid"),Xe("events",{}),Xe("apis",{}),Kr("eventOrder","eventOrder",function(n){return Hr.mergeWithThunk(u(n))}({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),Zr()),Ge("domModification")]),n)}function Td(n,t){C(t,(function(t){Sr(n,t)}))}function Od(n,t){C(t,(function(t){Or(n,t)}))}function kd(n,t){return function(n,t){var e=it(t,(function(n){return $e(n.name(),[Pe("config"),Xe("state",ao)])})),r=Ve("component.behaviours",Xr(e),n.behaviours).fold((function(t){throw new Error(Qr(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}));return{list:t,data:b(r,(function(n){var t=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return t}}))}}(n,t)}function Ed(n){var t=function(n){var t=_n(n,"behaviours").getOr({}),e=D(On(t),(function(n){return void 0!==t[n]}));return it(e,(function(n){return t[n].me}))}(n);return kd(n,t)}function Cd(n,e,r){var o=function(n){return t(t({},n.dom),{uid:n.uid,domChildren:it(n.components,(function(n){return n.element()}))})}(n),i=function(n){return n.domModification.fold((function(){return cr({})}),cr)}(n),u={"alloy.base.modification":i};return function(n,e){return t(t({},n),{attributes:t(t({},n.attributes),e.attributes),styles:t(t({},n.styles),e.styles),classes:n.classes.concat(e.classes)})}(o,0<e.length?function(n,e,r,o){var i=t({},e);function u(n){return _(n,(function(n,e){return t(t({},e.modification),n)}),{})}C(r,(function(t){i[t.name()]=t.exhibit(n,o)}));var c=pd(i,(function(n,t){return{name:n,modification:t}})),a=_(c.classes,(function(n,t){return t.modification.concat(n)}),[]),f=u(c.attributes),s=u(c.styles);return cr({classes:a,attributes:f,styles:s})}(r,u,e,o):i)}function Dd(n,t,e){var r={"alloy.base.behaviour":function(n){return n.events}(n)};return function(n,t,e,r){var o=bd(n,e,r);return Rm(o,t)}(e,n.eventOrder,t,r).getOrDie()}function _d(n){function t(){return l}var e=In(Am),r=Ne(Sd(n)),o=Ed(n),i=function(n){return n.list}(o),c=function(n){return n.data}(o),a=function(n){var t=Ut.fromTag(n.tag);gr(t,n.attributes),Td(t,n.classes),ei(t,n.styles),n.innerHtml.each((function(n){return ko(t,n)}));var e=n.domChildren;return gn(t,e),n.value.each((function(n){Zl(t,n)})),n.uid,of(t,n.uid),t}(Cd(r,i,c)),f=Dd(r,i,c),s=In(r.components),l={getSystem:e.get,config:function(t){var e=c;return(nt(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return nt(c[n.name()])},spec:u(n),readState:function(n){return c[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},getApis:function(){return r.apis},connect:function(n){e.set(n)},disconnect:function(){e.set(gd(t))},element:u(a),syncComponents:function(){var n=ne(a),t=R(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));s.set(t)},components:s.get,events:u(f)};return l}function Md(n){var r=Im(n),o=r.events,i=e(r,["events"]),u=function(n){var t=_n(n,"components").getOr([]);return it(t,Nm)}(i),c=t(t({},i),{events:t(t({},Mm),o),components:u});return fe.value(_d(c))}function Id(n){var t=Ut.fromText(n);return Bm({element:t})}function Ad(n){(To(n.element()).isNone()||Ai.isFocused(n))&&(Ai.isFocused(n)||Ai.focus(n),$(n,Hm,{item:n}))}function Fd(n){$(n,Pm,{item:n})}function Rd(n,t){var e=an(t),o=So(e).bind((function(n){function e(t){return cn(n,t)}return e(t)?Tn.some(t):function(n,t){var e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=Ut.fromDom(n.childNodes[r]);if(t(o))return Tn.some(o);var i=e(n.childNodes[r]);if(i.isSome())return i}return Tn.none()};return e(n.dom())}(t,e)})),i=n(t);return o.each((function(n){So(e).filter((function(t){return cn(t,n)})).fold((function(){xo(n)}),r)})),i}function Bd(n,t,e,r){var o=n.getSystem().build(r);ie(n,o,e)}function Vd(n,t,e,r){var o=Qm(n);I(o,(function(n){return cn(r.element(),n.element())})).each(yn)}function Nd(n,t,e,r,o){var i=Qm(n);return Tn.from(i[r]).map((function(t){return Vd(n,0,0,t),o.each((function(t){Bd(n,0,(function(n,t){!function(n,t,e){sn(n,e).fold((function(){te(n,t)}),(function(n){ln(n,t)}))}(n,t,r)}),t)})),t}))}function jd(n,t){var e={};En(n,(function(n,t){C(n,(function(n){e[n]=t}))}));var r=t,o=function(n){return Cn(n,(function(n,t){return{k:n,v:t}}))}(t),i=b(o,(function(n,t){return[t].concat(ng(e,r,o,t))}));return b(e,(function(n){return _n(i,n).getOr([n])}))}function Hd(n,t,e,r){return _n(t.routes,r.start).bind((function(n){return _n(n,r.destination)}))}function Pd(n,t,e){(function(n,t,e){return ug(n,t).bind((function(r){return ig(n,t,e,r)}))})(n,t,e).each((function(e){var r=e.transition;Or(n.element(),r.transitionClass),hr(n.element(),t.destinationAttr)}))}function zd(n,t,e,r){Pd(n,t,e),vr(n.element(),t.stateAttr)&&pr(n.element(),t.stateAttr)!==r&&t.onFinish(n,r),mr(n.element(),t.stateAttr,r)}function Ld(n){return _n(n,"format").getOr(n.title)}function Gd(n){return x(n,"items")?function(n){var t=de(be(n,["items"]),{menu:!0}),e=vg(n.items);return{item:t,menus:de(e.menus,xe(n.title,e.items)),expansions:de(e.expansions,xe(n.title,n.title))}}(n):{item:n,menus:{},expansions:{}}}function Ud(n){var t=n.replace(/\|/g," ").trim();return 0<t.length?t.split(/\s+/):[]}function $d(n){var t=void 0!==n.toolbar?n.toolbar:xg;return Qn(t)?wg(t):Ud(t)}function Wd(n){function t(){n.stopPropagation()}function e(){n.preventDefault()}var r=Ut.fromDom(n.target),o=i(e,t);return function(n,t,e,r,o,i,c){return{target:u(n),x:u(t),y:u(e),stop:r,prevent:o,kill:i,raw:u(c)}}(r,n.clientX,n.clientY,t,e,o,n)}function Xd(n,t,e,r,o){var i=function(n,t){return function(e){n(e)&&t(Wd(e))}}(e,r);return n.dom().addEventListener(t,i,o),{unbind:c(Og,n,t,i,o)}}function qd(n,t,e){return function(n,t,e,r){return Xd(n,t,e,r,!1)}(n,t,kg,e)}function Yd(n,t,e){return function(n,t,e,r){return Xd(n,t,e,r,!0)}(n,t,kg,e)}function Kd(n){var t=n.matchMedia("(orientation: portrait)").matches;return{isPortrait:u(t)}}var Jd,Qd,Zd=function(n){var t=Ut.fromDom(n.selection.getStart());return Gi(t,"a")},nm={getInfo:function(n){return Zd(n).fold((function(){return function(n){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:Tn.none()}}(n)}),(function(n){return function(n){var t=Xl(n),e=pr(n,"href"),r=pr(n,"title"),o=pr(n,"target");return{url:Yl(e),text:t!==e?Yl(t):"",title:Yl(r),target:Yl(o),link:Tn.some(n)}}(n)}))},applyInfo:function(n,t){t.url.toOption().filter(ql).fold((function(){!function(n,t){t.link.bind(o).each((function(t){n.execCommand("unlink")}))}(n,t)}),(function(e){var r=function(n,t){var e={};return e.href=n,t.title.toOption().filter(ql).each((function(n){e.title=n})),t.target.toOption().filter(ql).each((function(n){e.target=n})),e}(e,t);t.link.bind(o).fold((function(){var o=t.text.toOption().filter(ql).getOr(e);n.insertContent(n.dom.createHTML("a",r,n.dom.encode(o)))}),(function(n){var o=Kl(n,e,t);gr(n,r),o.each((function(t){!function(n,t){n.dom().textContent=t}(n,t)}))}))}))},query:Zd},tm=G(),em=function(n,t){(tm.os.isAndroid()?Jl:s)(t,n)},rm=function(n,t){return{key:n,value:{config:{},me:function(n,t){var e=Ze(t);return lr({fields:[Pe("enabled")],name:n,active:{events:u(e)}})}(n,t),configAsRaw:u({}),initialConfig:{},state:ao}}},om=Object.freeze({__proto__:null,getCurrent:function(n,t,e){return t.find(n)}}),im=[Pe("find")],um=lr({fields:im,name:"composing",apis:om}),cm=af({name:"Container",factory:function(n){var r=n.dom,o=r.attributes,i=e(r,["attributes"]);return{uid:n.uid,dom:t({tag:"div",attributes:t({role:"presentation"},o)},i),components:n.components,behaviours:ic(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[Xe("components",[]),oc("containerBehaviours",[]),Xe("events",{}),Xe("domModification",{}),Xe("eventOrder",{})]}),am=af({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:Da(n.dataBehaviours,[el.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),um.config({find:Tn.some})]),events:Ze([eo((function(t,e){el.setValue(t,n.getInitialValue())}))])}},configFields:[Pe("uid"),Pe("dom"),Pe("getInitialValue"),Ca("dataBehaviours",[el,um])]}),fm=u([Ge("data"),Xe("inputAttributes",{}),Xe("inputStyles",{}),Xe("tag","input"),Xe("inputClasses",[]),Po("onSetValue"),Xe("styles",{}),Xe("eventOrder",{}),oc("inputBehaviours",[el,Ai]),Xe("selectOnFocus",!0)]),sm=af({name:"Input",configFields:fm(),factory:function(n,e){return{uid:n.uid,dom:function(n){return{tag:n.tag,attributes:t({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}}(n),components:[],behaviours:nd(n),eventOrder:n.eventOrder}}}),lm=Object.freeze({__proto__:null,exhibit:function(n,t){return cr({attributes:we([{key:t.tabAttr,value:"true"}])})}}),dm=[Xe("tabAttr","data-alloy-tabstop")],mm=lr({fields:dm,name:"tabstopping",active:lm}),gm=tinymce.util.Tools.resolve("tinymce.util.I18n"),pm=["input","button","textarea","select"],vm=function(n,t,e){t.disableClass.each((function(t){Sr(n.element(),t)})),(rd(n,t)?od:ud)(n),t.onDisabled(n)},hm=Object.freeze({__proto__:null,enable:ad,disable:vm,isDisabled:fd,onLoad:ed,set:function(n,t,e,r){(r?vm:ad)(n,t,e)}}),ym=Object.freeze({__proto__:null,exhibit:function(n,t){return cr({classes:t.disabled?t.disableClass.map(j).getOr([]):[]})},events:function(n,t){return Ze([nr(At(),(function(t,e){return fd(t,n)})),ar(n,t,ed)])}}),bm=[Xe("disabled",!1),Xe("useNative",!0),Ge("disableClass"),Po("onDisabled"),Po("onEnabled")],xm=lr({fields:bm,name:"disabling",active:ym,apis:hm}),wm=[oc("formBehaviours",[el])],Sm=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:uc(n.formBehaviours,[el.config({store:{mode:"manual",getValue:function(t){var e=function(n,t){var e=n.getSystem();return b(t.partUids,(function(n,t){return u(e.getByUid(n))}))}(t,n);return b(e,(function(n,t){return n().bind((function(n){return function(n,t){return n.fold((function(){return fe.error(t)}),fe.value)}(um.getCurrent(n),new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Do(n.element())))})).map(el.getValue)}))},setValue:function(t,e){En(e,(function(e,r){hc(t,n,r).each((function(n){um.getCurrent(n).each((function(n){el.setValue(n,e)}))}))}))}}})]),apis:{getField:function(t,e){return hc(t,n,e).bind(um.getCurrent)}}}},Tm=(Sc((function(n,t,e){return n.getField(t,e)})),function(n){var t,e=(t=[],{field:function(n,e){return t.push(n),function(n,t,e){return{uiType:Ra(),owner:n,name:t,config:e,validated:{}}}("form",sd(n),e)},record:function(){return t}}),r=n(e),o=e.record(),i=it(o,(function(n){return qa({name:n,pname:sd(n)})}));return kc("form",wm,i,Sm,r)}),Om=function(n){return{xValue:n,points:[]}},km=function(n,t){if(t===n.xValue)return n;var e=0<t-n.xValue?1:-1,r={direction:e,xValue:t};return{xValue:t,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===e?n.points.slice(0,n.points.length-1):n.points).concat([r])}},Em=function(n){if(0===n.points.length)return 0;var t=n.points[0].direction,e=n.points[n.points.length-1].direction;return-1===t&&-1===e?-1:1===t&&1===e?1:0},Cm=q((function(n,t){return[{label:"the link group",items:[md({fields:[td("url","Type or paste URL"),td("text","Link text"),td("title","Link title"),td("target","Link target"),function(n){return{name:n,spec:am.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return Tn.none()}})}}("link")],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return Tn.some(nm.getInfo(t))},onExecute:function(e){var r=el.getValue(e);nm.applyInfo(t,r),n.restoreToolbar(),t.focus()}})]}]})),Dm=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],_m=Ze([(Jd=Dt(),Qd=function(t,e){var r=e.event().originator(),o=e.event().target();return!function(n,t,e){return cn(t,n.element())&&!cn(t,e)}(t,r,o)||(n.console.warn(Dt()+" did not get interpreted by the desired target. \nOriginator: "+Do(r)+"\nTarget: "+Do(o)+"\nCheck the "+Dt()+" event handlers"),!1)},{key:Jd,value:Je({can:Qd})})]),Mm=Object.freeze({__proto__:null,events:_m}),Im=o,Am=gd(),Fm=function(n,t){return function(n,t){return{cHandler:n,purpose:u(t)}}(c.apply(void 0,[n.handler].concat(t)),n.purpose())},Rm=function(n,t){var e=Dn(n,(function(n,e){return(1===n.length?fe.value(n[0].handler()):wd(n,t,e)).map((function(r){var o=xd(r),i=1<n.length?D(t[e],(function(t){return E(n,(function(n){return n.name()===t}))})).join(" > "):n[0].name();return xe(e,function(n,t){return{handler:n,purpose:u(t)}}(o,i))}))}));return Se(e,{})},Bm=function(n){var t=je("external.component",Me([Pe("element"),Ge("uid")]),n),e=In(gd());t.uid.each((function(n){of(t.element,n)}));var o={getSystem:e.get,config:Tn.none,hasConfigured:u(!1),connect:function(n){e.set(n)},disconnect:function(){e.set(gd((function(){return o})))},getApis:function(){return{}},element:u(t.element),spec:u(n),readState:u("No state"),syncComponents:r,components:u([]),events:u({})};return wc(o)},Vm=Tc,Nm=function(n){return function(n){return _n(n,Za)}(n).fold((function(){var e=n.hasOwnProperty("uid")?n:t({uid:Vm("")},n);return Md(e).getOrDie()}),(function(n){return n}))},jm=wc,Hm="alloy.item-hover",Pm="alloy.item-focus",zm=u(Hm),Lm=u(Pm),Gm=[Pe("data"),Pe("components"),Pe("dom"),Xe("hasSubmenu",!1),Ge("toggling"),Ca("itemBehaviours",[Ti,Ai,Ea,el]),Xe("ignoreFocus",!1),Xe("domModification",{}),Uo("builder",(function(n){return{dom:n.dom,domModification:t(t({},n.domModification),{attributes:t(t(t({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Da(n.itemBehaviours,[n.toggling.fold(Ti.revoke,(function(n){return Ti.config(t({aria:{mode:"checked"}},n))})),Ai.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Fd(n)}}),Ea.config({mode:"execution"}),el.config({store:{mode:"memory",initialValue:n.data}}),rm("item-type-events",function(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),o=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,c=i.length;u<c;u++,o++)r[o]=i[u];return r}(Qo(),[tr(bt(),Ad),tr(Ft(),Ai.focus)]))]),components:n.components,eventOrder:n.eventOrder}})),Xe("eventOrder",{})],Um=[Pe("dom"),Pe("components"),Uo("builder",(function(n){return{dom:n.dom,components:n.components,events:Ze([function(n){return tr(n,(function(n,t){t.stop()}))}(Ft())])}}))],$m=u([qa({name:"widget",overrides:function(n){return{behaviours:so([el.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:function(){}}})])}}})]),Wm=[Pe("uid"),Pe("data"),Pe("components"),Pe("dom"),Xe("autofocus",!1),Xe("ignoreFocus",!1),Ca("widgetBehaviours",[el,Ai,Ea]),Xe("domModification",{}),xc($m()),Uo("builder",(function(n){function t(t){return hc(t,n,"widget").map((function(n){return Ea.focusIn(n),n}))}function e(t,e){return wu(e.event().target())||n.autofocus&&e.setSource(t.element()),Tn.none()}var r=pc(0,n,$m()),o=vc("item-widget",n,r.internals());return{dom:n.dom,components:o,domModification:n.domModification,events:Ze([io((function(n,e){t(n).each((function(n){e.stop()}))})),tr(bt(),Ad),tr(Ft(),(function(e,r){n.autofocus?t(e):Ai.focus(e)}))]),behaviours:Da(n.widgetBehaviours,[el.config({store:{mode:"memory",initialValue:n.data}}),Ai.config({ignore:n.ignoreFocus,onFocus:function(n){Fd(n)}}),Ea.config({mode:"special",focusIn:n.autofocus?function(n){t(n)}:go(),onLeft:e,onRight:e,onEscape:function(t,e){return Ai.isFocused(t)||n.autofocus?(n.autofocus&&e.setSource(t.element()),Tn.none()):(Ai.focus(t),Tn.some(!0))}})])}}))],Xm=He("type",{widget:Wm,item:Gm,separator:Um}),qm=u([Ka({factory:{sketch:function(n){var t=je("menu.spec item",Xm,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,e){return e.hasOwnProperty("uid")?e:t(t({},e),{uid:Tc("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Ym=u([Pe("value"),Pe("items"),Pe("dom"),Pe("components"),Xe("eventOrder",{}),oc("menuBehaviours",[yu,el,um,Ea]),qe("movement",{mode:"menu",moveOnTab:!0},He("mode",{grid:[pi(),Uo("config",(function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}}))],matrix:[Uo("config",(function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}})),Pe("rowSelector")],menu:[Xe("moveOnTab",!0),Uo("config",(function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}}))]})),ze("markers",mi()),Xe("fakeFocus",!1),Xe("focusManager",uu()),Po("onHighlight")]),Km=u("alloy.menu-focus"),Jm=ff({name:"Menu",configFields:Ym(),partFields:qm(),factory:function(n,t,e,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:uc(n.menuBehaviours,[yu.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),el.config({store:{mode:"memory",initialValue:n.value}}),um.config({find:Tn.some}),Ea.config(n.movement.config(n,n.movement))]),events:Ze([tr(Lm(),(function(n,t){var e=t.event();n.getSystem().getByDom(e.target()).each((function(e){yu.highlight(n,e),t.stop(),$(n,Km(),{menu:n,item:e})}))})),tr(zm(),(function(n,t){var e=t.event().item();yu.highlight(n,e)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Qm=function(n,t){return n.components()},Zm=lr({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,t,e,r){Bd(n,0,te,r)},prepend:function(n,t,e,r){Bd(n,0,mn,r)},remove:Vd,replaceAt:Nd,replaceBy:function(n,t,e,r,o){var i=Qm(n);return A(i,r).bind((function(t){return Nd(n,0,0,t,o)}))},set:function(n,t,e,r){Rd((function(){var t=it(r,n.getSystem().build);hn(n,t)}),n.element())},contents:Qm})}),ng=function(n,t,e,r){return _n(e,r).bind((function(r){return _n(n,r).bind((function(r){var o=ng(n,t,e,r);return Tn.some([r].concat(o))}))})).getOr([])},tg=function(n){return"prepared"===n.type?Tn.some(n.menu):Tn.none()},eg={init:function(){function n(n){return function(n,t){for(var e=On(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];if(t(u,i,n))return Tn.some(u)}return Tn.none()}(e.get(),(function(t,e){return t===n}))}var e=In({}),r=In({}),o=In({}),i=In(Tn.none()),u=In({}),c=function(n){return a(n).bind(tg)},a=function(n){return _n(r.get(),n)},f=function(n){return _n(e.get(),n)};return{setMenuBuilt:function(n,e){var o;r.set(t(t({},r.get()),((o={})[n]={type:"prepared",menu:e},o)))},setContents:function(n,t,c,a){i.set(Tn.some(n)),e.set(c),r.set(t),u.set(a);var f=jd(a,c);o.set(f)},expand:function(n){return _n(e.get(),n).map((function(t){var e=_n(o.get(),n).getOr([]);return[t].concat(e)}))},refresh:function(n){return _n(o.get(),n)},collapse:function(n){return _n(o.get(),n).bind((function(n){return 1<n.length?Tn.some(n.slice(1)):Tn.none()}))},lookupMenu:a,lookupItem:f,otherMenus:function(n){var t=u.get();return N(On(t),n)},getPrimary:function(){return i.get().bind(c)},getMenus:function(){return r.get()},clear:function(){e.set({}),r.set({}),o.set({}),i.set(Tn.none())},isClear:function(){return i.get().isNone()},getTriggeringPath:function(t,e){var r=D(f(t).toArray(),(function(n){return c(n).isSome()}));return _n(o.get(),t).bind((function(t){var o=V(r.concat(t));return function(n){for(var t=[],e=0;e<n.length;e++){var r=n[e];if(!r.isSome())return Tn.none();t.push(r.getOrDie())}return Tn.some(t)}(R(o,(function(t,r){return function(t,e,r){return c(t).bind((function(o){return n(t).bind((function(n){return e(n).map((function(n){return{triggeredMenu:o,triggeringItem:n,triggeringPath:r}}))}))}))}(t,e,o.slice(0,r+1)).fold((function(){return i.get().is(t)?[]:[Tn.none()]}),(function(n){return[Tn.some(n)]}))})))}))}}},extractPreparedMenu:tg},rg=u("collapse-item"),og=af({name:"TieredMenu",configFields:[Go("onExecute"),Go("onEscape"),Lo("onOpenMenu"),Lo("onOpenSubmenu"),Po("onRepositionMenu"),Po("onCollapseMenu"),Xe("highlightImmediately",!0),Le("data",[Pe("primary"),Pe("menus"),Pe("expansions")]),Xe("fakeFocus",!1),Po("onHighlight"),Po("onHover"),Le("markers",[Pe("backgroundMenu")].concat(li()).concat(di())),Pe("dom"),Xe("navigateOnHover",!0),Xe("stayInDom",!1),oc("tmenuBehaviours",[Ea,yu,um,Zm]),Xe("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:function(n,e){function o(e,o,i){return b(i,(function(i,u){function c(){return Jm.sketch(t(t({dom:i.dom},i),{value:u,items:i.items,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?function(){function n(n){return yu.getHighlighted(n).map((function(n){return n.element()}))}return{get:n,set:function(t,e){var o=n(t);t.getSystem().getByDom(e).fold(r,(function(n){yu.highlight(t,n)}));var i=n(t);iu(t,o,i)}}}():uu()}))}return u===o?{type:"prepared",menu:e.getSystem().build(c())}:{type:"notbuilt",nbMenu:c}}))}function i(n){return el.getValue(n).value}function u(n,t){yu.highlight(n,t),yu.getHighlighted(t).orThunk((function(){return yu.getFirst(t)})).each((function(t){X(n,t.element(),Ft())}))}function c(n,t){return Zi(it(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?Tn.some(n.menu):Tn.none()}))})))}function a(t,e,r){var o=c(e,e.otherMenus(r));C(o,(function(e){Od(e.element(),[n.markers.backgroundMenu]),n.stayInDom||Zm.remove(t,e)}))}function f(t,e){var r=function(t){return m.get().getOrThunk((function(){var e={},r=Hi(t.element(),"."+n.markers.item),o=D(r,(function(n){return"true"===pr(n,"aria-haspopup")}));return C(o,(function(n){t.getSystem().getByDom(n).each((function(n){var t=i(n);e[t]=n}))})),m.set(Tn.some(e)),e}))}(t);En(r,(function(n,t){var r=k(e,t);mr(n.element(),"aria-expanded",r)}))}function s(t,e,r){return Tn.from(r[0]).bind((function(o){return e.lookupMenu(o).bind((function(o){if("notbuilt"===o.type)return Tn.none();var i=o.menu,f=c(e,r.slice(1));return C(f,(function(t){Sr(t.element(),n.markers.backgroundMenu)})),J(i.element())||Zm.append(t,jm(i)),Od(i.element(),[n.markers.backgroundMenu]),u(t,i),a(t,e,r),Tn.some(i)}))}))}var l,d,m=In(Tn.none()),g=eg.init(),p=function(t){return b(n.data.menus,(function(n,t){return R(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))};function v(t,e,r){void 0===r&&(r=l.HighlightSubmenu);var o=i(e);return g.expand(o).bind((function(o){return f(t,o),Tn.from(o[0]).bind((function(i){return g.lookupMenu(i).bind((function(u){var c=function(n,t,e){if("notbuilt"!==e.type)return e.menu;var r=n.getSystem().build(e.nbMenu());return g.setMenuBuilt(t,r),r}(t,i,u);return J(c.element())||Zm.append(t,jm(c)),n.onOpenSubmenu(t,e,c,V(o)),r===l.HighlightSubmenu?(yu.highlightFirst(c),s(t,g,o)):(yu.dehighlightAll(c),Tn.some(e))}))}))}))}function h(t,e){var r=i(e);return g.collapse(r).bind((function(r){return f(t,r),s(t,g,r).map((function(r){return n.onCollapseMenu(t,e,r),r}))}))}function y(t){return function(e,r){return Gi(r.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOption().bind((function(n){return t(e,n).map((function(){return!0}))}))}))}}function x(n){return yu.getHighlighted(n).bind(yu.getHighlighted)}(d=l=l||{})[d.HighlightSubmenu=0]="HighlightSubmenu",d[d.HighlightParent=1]="HighlightParent";var w=Ze([tr(Km(),(function(n,t){var e=t.event().item();g.lookupItem(i(e)).each((function(){var e=t.event().menu();yu.highlight(n,e);var r=i(t.event().item());g.refresh(r).each((function(t){return a(n,g,t)}))}))})),io((function(t,e){var r=e.event().target();t.getSystem().getByDom(r).each((function(e){0===i(e).indexOf("collapse-item")&&h(t,e),v(t,e,l.HighlightSubmenu).fold((function(){n.onExecute(t,e)}),(function(){}))}))})),eo((function(t,e){(function(t){var e=o(t,n.data.primary,n.data.menus),r=p();return g.setContents(n.data.primary,e,n.data.expansions,r),g.getPrimary()})(t).each((function(e){Zm.append(t,jm(e)),n.onOpenMenu(t,e),n.highlightImmediately&&u(t,e)}))}))].concat(n.navigateOnHover?[tr(zm(),(function(t,e){var r=e.event().item();!function(n,t){var e=i(t);g.refresh(e).bind((function(t){return f(n,t),s(n,g,t)}))}(t,r),v(t,r,l.HighlightParent),n.onHover(t,r)}))]:[])),S={collapseMenu:function(n){x(n).each((function(t){h(n,t)}))},highlightPrimary:function(n){g.getPrimary().each((function(t){u(n,t)}))},repositionMenus:function(t){g.getPrimary().bind((function(n){return x(t).bind((function(n){var t=i(n),e=function(n){return Dn(n,(function(n){return n}))}(g.getMenus()),r=Zi(it(e,eg.extractPreparedMenu));return g.getTriggeringPath(t,(function(n){return function(n,t,e){return H(t,(function(n){if(!n.getSystem().isConnected())return Tn.none();var t=yu.getCandidates(n);return I(t,(function(n){return i(n)===e}))}))}(0,r,n)}))})).map((function(t){return{primary:n,triggeringPath:t}}))})).fold((function(){(function(n){return Tn.from(n.components()[0]).filter((function(n){return"menu"===pr(n.element(),"role")}))})(t).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var r=e.primary,o=e.triggeringPath;n.onRepositionMenu(t,r,o)}))}};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:uc(n.tmenuBehaviours,[Ea.config({mode:"special",onRight:y((function(n,t){return wu(t.element())?Tn.none():v(n,t,l.HighlightSubmenu)})),onLeft:y((function(n,t){return wu(t.element())?Tn.none():h(n,t)})),onEscape:y((function(t,e){return h(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))})),focusIn:function(n,t){g.getPrimary().each((function(t){X(n,t.element(),Ft())}))}}),yu.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),um.config({find:function(n){return yu.getHighlighted(n)}}),Zm.config({})]),eventOrder:n.eventOrder,apis:S,events:w}},extraApis:{tieredData:function(n,t,e){return{primary:n,menus:t,expansions:e}},singleData:function(n,t){return{primary:n,menus:xe(n,t),expansions:{}}},collapseItem:function(n){return{value:sc(rg()),meta:{text:n}}}}}),ig=function(n,t,e,r){return Hd(0,t,0,r).bind((function(n){return n.transition.map((function(t){return{transition:t,route:n}}))}))},ug=function(n,t,e){var r=n.element();return vr(r,t.destinationAttr)?Tn.some({start:pr(n.element(),t.stateAttr),destination:pr(n.element(),t.destinationAttr)}):Tn.none()},cg=Object.freeze({__proto__:null,findRoute:Hd,disableTransition:Pd,getCurrentRoute:ug,jumpTo:zd,progressTo:function(n,t,e,r){!function(n,t){vr(n.element(),t.destinationAttr)&&(mr(n.element(),t.stateAttr,pr(n.element(),t.destinationAttr)),hr(n.element(),t.destinationAttr))}(n,t);var o=function(n,t,e,r){return{start:pr(n.element(),t.stateAttr),destination:r}}(n,t,0,r);ig(n,t,e,o).fold((function(){zd(n,t,e,r)}),(function(o){Pd(n,t,e);var i=o.transition;Sr(n.element(),i.transitionClass),mr(n.element(),t.destinationAttr,r)}))},getState:function(n,t,e){var r=n.element();return vr(r,t.stateAttr)?Tn.some(pr(r,t.stateAttr)):Tn.none()}}),ag=Object.freeze({__proto__:null,events:function(n,t){return Ze([tr(kt(),(function(e,r){var o=r.event().raw();ug(e,n).each((function(r){Hd(0,n,0,r).each((function(i){i.transition.each((function(i){o.propertyName===i.property&&(zd(e,n,t,r.destination),n.onTransition(e,r))}))}))}))})),eo((function(e,r){zd(e,n,t,n.initialState)}))])}}),fg=[Xe("destinationAttr","data-transitioning-destination"),Xe("stateAttr","data-transitioning-state"),Pe("initialState"),Po("onTransition"),Po("onFinish"),ze("routes",Be(fe.value,Be(fe.value,Me([We("transition",[Pe("property"),Pe("transitionClass")])]))))],sg=lr({fields:fg,name:"transitioning",active:ag,apis:cg,extra:{createRoutes:function(n){var t={};return En(n,(function(n,e){var r=e.split("<->");t[r[0]]=xe(r[1],n),t[r[1]]=xe(r[0],n)})),t},createBistate:function(n,t,e){return we([{key:n,value:xe(t,e)},{key:t,value:xe(n,e)}])},createTristate:function(n,t,e,r){return we([{key:n,value:we([{key:t,value:r},{key:e,value:r}])},{key:t,value:we([{key:n,value:r},{key:e,value:r}])},{key:e,value:we([{key:n,value:r},{key:t,value:r}])}])}}}),lg=Di.resolve("scrollable"),dg={register:function(n){Sr(n,lg)},deregister:function(n){Or(n,lg)},scrollable:u(lg)},mg=function(n,t,e,r,o){return{data:{value:n,text:t},type:"item",dom:{tag:"div",classes:o?[Di.resolve("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:Di.resolve("format-matches"),selected:e},itemBehaviours:so(o?[]:[Oi(n,(function(n,t){(t?Ti.on:Ti.off)(n)}))]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:t}}]}},gg=function(n,t,e,r){return{value:n,dom:{tag:"div"},components:[Bs.sketch({dom:{tag:"div",classes:[Di.resolve("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[Di.resolve("styles-collapse-icon")]}},Id(n)]:[Id(n)],action:function(n){if(r){var t=e().get(n);og.collapseMenu(t)}}}),{dom:{tag:"div",classes:[Di.resolve("styles-menu-items-container")]},components:[Jm.parts().items({})],behaviours:so([rm("adhoc-scrollable-menu",[eo((function(n,t){Fi(n.element(),"overflow-y","auto"),Fi(n.element(),"-webkit-overflow-scrolling","touch"),dg.register(n.element())})),ro((function(n){ii(n.element(),"overflow-y"),ii(n.element(),"-webkit-overflow-scrolling"),dg.deregister(n.element())}))])])}],items:t,menuBehaviours:so([sg.config({initialState:"after",routes:sg.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},pg=function(n){var t=function(n,t){var e=gg("Styles",[].concat(it(n.items,(function(t){return mg(Ld(t),t.title,t.isSelected(),t.getPreview(),x(n.expansions,Ld(t)))}))),t,!1),r=b(n.menus,(function(e,r){var o=it(e,(function(t){return mg(Ld(t),t.title,void 0!==t.isSelected&&t.isSelected(),void 0!==t.getPreview?t.getPreview():"",x(n.expansions,Ld(t)))}));return gg(r,o,t,!0)})),o=de(r,xe("styles",e));return{tmenu:og.tieredData("styles",o,n.expansions)}}(n.formats,(function(){return e})),e=Ms(og.sketch({dom:{tag:"div",classes:[Di.resolve("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(t,e){var r=el.getValue(e);return n.handle(e,r.value),Tn.none()},onEscape:function(){return Tn.none()},onOpenMenu:function(n,t){var e=wf(n.element());xf(t.element(),e),sg.jumpTo(t,"current")},onOpenSubmenu:function(n,t,e){var r=wf(n.element()),o=zi(t.element(),'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie();xf(e.element(),r),sg.progressTo(i,"before"),sg.jumpTo(e,"after"),sg.progressTo(e,"current")},onCollapseMenu:function(n,t,e){var r=zi(t.element(),'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie();sg.progressTo(o,"after"),sg.progressTo(e,"current")},navigateOnHover:!1,highlightImmediately:!0,data:t.tmenu,markers:{backgroundMenu:Di.resolve("styles-background-menu"),menu:Di.resolve("styles-menu"),selectedMenu:Di.resolve("styles-selected-menu"),item:Di.resolve("styles-item"),selectedItem:Di.resolve("styles-selected-item")}}));return e.asSpec()},vg=function(n){return _(n,(function(n,t){var e=Gd(t);return{menus:de(n.menus,e.menus),items:[e.item].concat(n.items),expansions:de(n.expansions,e.expansions)}}),{menus:{},expansions:{},items:[]})},hg={expand:vg},yg=function(n,t){function e(t){return function(){return n.formatter.match(t)}}function r(t){return function(){return n.formatter.getCssText(t)}}var o=_n(t,"style_formats").getOr(Dm),i=function(t){return it(t,(function(t){if(x(t,"items")){var o=i(t.items);return de(function(n){return de(n,{isSelected:u(!1),getPreview:u("")})}(t),{items:o})}return x(t,"format")?function(n){return de(n,{isSelected:e(n.format),getPreview:r(n.format)})}(t):function(t){var o=sc(t.title),i=de(t,{format:o,isSelected:e(o),getPreview:r(o)});return n.formatter.register(o,i),i}(t)}))};return i(o)},bg=function(n,t,e){var r=function(n,t){var e=function(t){return R(t,(function(t){return void 0===t.items?!x(t,"format")||n.formatter.canApply(t.format)?[t]:[]:0<e(t.items).length?[t]:[]}))},r=e(t);return hg.expand(r)}(n,t);return pg({formats:r,handle:function(t,r){n.undoManager.transact((function(){Ti.isOn(t)?n.formatter.remove(r):n.formatter.apply(r)})),e()}})},xg=["undo","bold","italic","link","image","bullist","styleselect"],wg=function(n){return R(n,(function(n){return Qn(n)?wg(n):Ud(n)}))},Sg=function(n,t){function e(n){return function(){return Hs.forToolbarCommand(t,n)}}function r(n){return function(){return Hs.forToolbarStateCommand(t,n)}}function o(n,e,r){return function(){return Hs.forToolbarStateAction(t,n,e,r)}}function i(){return bg(t,v,(function(){t.fire("scrollIntoView")}))}function u(n,e){return{isSupported:function(){var e=t.ui.registry.getAll().buttons;return n.forall((function(n){return x(e,n)}))},sketch:e}}var c=e("undo"),a=e("redo"),f=r("bold"),s=r("italic"),l=r("underline"),d=e("removeformat"),m=o("unlink","link",(function(){t.execCommand("unlink",null,!1)})),g=o("unordered-list","ul",(function(){t.execCommand("InsertUnorderedList",null,!1)})),p=o("ordered-list","ol",(function(){t.execCommand("InsertOrderedList",null,!1)})),v=yg(t,t.settings);return{undo:u(Tn.none(),c),redo:u(Tn.none(),a),bold:u(Tn.none(),f),italic:u(Tn.none(),s),underline:u(Tn.none(),l),removeformat:u(Tn.none(),d),link:u(Tn.none(),(function(){return function(n,t){return Hs.forToolbarStateAction(t,"link","link",(function(){var e=Cm(n,t);n.setContextToolbar(e),em(t,(function(){n.focusToolbar()})),nm.query(t).each((function(n){t.selection.select(n.dom())}))}))}(n,t)})),unlink:u(Tn.none(),m),image:u(Tn.none(),(function(){return Wl(t)})),bullist:u(Tn.some("bullist"),g),numlist:u(Tn.some("numlist"),p),fontsizeselect:u(Tn.none(),(function(){return function(n,t){var e={onChange:function(n){Fl.apply(t,n)},getInitialValue:function(){return Fl.get(t)}};return ks(n,"font-size",(function(){return _s(e)}),t)}(n,t)})),forecolor:u(Tn.none(),(function(){return _l(n,t)})),styleselect:u(Tn.none(),(function(){return Hs.forToolbar("style-formats",(function(e){t.fire("toReading"),n.dropup().appear(i,Ti.on,e)}),so([Ti.config({toggleClass:Di.resolve("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),hi.config({channels:we([Ei(Ro.orientationChanged(),Ti.off),Ei(Ro.dropupDismissed(),Ti.off)])})]),t)}))}},Tg=function(n,t){var e=$d(n),r={};return R(e,(function(n){var e=!x(r,n)&&x(t,n)&&t[n].isSupported()?[t[n].sketch()]:[];return r[n]=!0,e}))},Og=function(n,t,e,r){n.dom().removeEventListener(t,e,r)},kg=u(!0),Eg=tinymce.util.Tools.resolve("tinymce.util.Delay"),Cg=Kd,Dg=function(n,t){var e=Ut.fromDom(n),r=null,o=qd(e,"orientationchange",(function(){Eg.clearInterval(r);var e=Kd(n);t.onChange(e),i((function(){t.onReady(e)}))})),i=function(t){Eg.clearInterval(r);var e=n.innerHeight,o=0;r=Eg.setInterval((function(){e!==n.innerHeight?(Eg.clearInterval(r),t(Tn.some(n.innerHeight))):20<o&&(Eg.clearInterval(r),t(Tn.none())),o++}),50)};return{onAdjustment:i,destroy:function(){o.unbind()}}},_g=function(n){var t=G().os.isiOS(),e=Kd(n).isPortrait();return t&&!e?n.screen.height:n.screen.width};function Mg(n){var t=n.raw();return void 0===t.touches||1!==t.touches.length?Tn.none():Tn.some(t.touches[0])}function Ig(t){var e=In(Tn.none()),r=In(!1),o=function(t,e){var r=null;return{cancel:function(){null!==r&&(n.clearTimeout(r),r=null)},schedule:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r=n.setTimeout((function(){t.apply(null,o),r=null}),e)}}}((function(n){t.triggerEvent(Bt(),n),r.set(!0)}),400),i=we([{key:mt(),value:function(n){return Mg(n).each((function(t){o.cancel();var i={x:u(t.clientX),y:u(t.clientY),target:n.target};o.schedule(n),r.set(!1),e.set(Tn.some(i))})),Tn.none()}},{key:gt(),value:function(n){return o.cancel(),Mg(n).each((function(n){e.get().each((function(t){!function(n,t){var e=Math.abs(n.clientX-t.x()),r=Math.abs(n.clientY-t.y());return 5<e||5<r}(n,t)||e.set(Tn.none())}))})),Tn.none()}},{key:pt(),value:function(n){return o.cancel(),e.get().filter((function(t){return cn(t.target(),n.target())})).map((function(e){return r.get()?(n.prevent(),!1):t.triggerEvent(Rt(),n)}))}}]);return{fireIfReady:function(n,t){return _n(i,t).bind((function(t){return t(n)}))}}}var Ag=function(n){var t=Ig({triggerEvent:function(t,e){n.onTapContent(e)}});return{fireTouchstart:function(n){t.fireIfReady(n,"touchstart")},onTouchend:function(){return qd(n.body(),"touchend",(function(n){t.fireIfReady(n,"touchend")}))},onTouchmove:function(){return qd(n.body(),"touchmove",(function(n){t.fireIfReady(n,"touchmove")}))}}},Fg=6<=G().os.version.major,Rg=function(n,t,e){function o(n){return!cn(n.start(),n.finish())||n.soffset()!==n.foffset()}function i(){var r=n.doc().dom().hasFocus()&&n.getSelection().exists(o);e.getByDom(t).each(!0===(r||So(c).filter((function(n){return"input"===Y(n)})).exists((function(n){return n.dom().selectionStart!==n.dom().selectionEnd})))?Ti.on:Ti.off)}var u=Ag(n),c=an(t),a=[qd(n.body(),"touchstart",(function(t){n.onTouchContent(),u.fireTouchstart(t)})),u.onTouchmove(),u.onTouchend(),qd(t,"touchstart",(function(t){n.onTouchToolstrip()})),n.onToReading((function(){wo(n.body())})),n.onToEditing(r),n.onScrollToCursor((function(t){t.preventDefault(),n.getCursorBox().each((function(t){var e=n.win(),r=t.top()>e.innerHeight||t.bottom()>e.innerHeight?t.bottom()-e.innerHeight+50:0;0!=r&&e.scrollTo(e.pageXOffset,e.pageYOffset+r)}))}))].concat(1==Fg?[]:[qd(Ut.fromDom(n.win()),"blur",(function(){e.getByDom(t).each(Ti.off)})),qd(c,"select",i),qd(n.doc(),"selectionchange",i)]);return{destroy:function(){C(a,(function(n){n.unbind()}))}}},Bg=function(n,t){var e=parseInt(pr(n,t),10);return isNaN(e)?0:e};function Vg(n){return"img"===Y(n)?1:function(n){return lp.getOption(n)}(n).fold((function(){return ne(n).length}),(function(n){return n.length}))}function Ng(n,t,e){var r=n.document.createRange();return function(n,t){t.fold((function(t){n.setStartBefore(t.dom())}),(function(t,e){n.setStart(t.dom(),e)}),(function(t){n.setStartAfter(t.dom())}))}(r,t),function(n,t){t.fold((function(t){n.setEndBefore(t.dom())}),(function(t,e){n.setEnd(t.dom(),e)}),(function(t){n.setEndAfter(t.dom())}))}(r,e),r}function jg(n,t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(r.dom(),o),i}function Hg(n){return{left:u(n.left),top:u(n.top),right:u(n.right),bottom:u(n.bottom),width:u(n.width),height:u(n.height)}}function Pg(n,t,e){return t(Ut.fromDom(e.startContainer),e.startOffset,Ut.fromDom(e.endContainer),e.endOffset)}function zg(n,t){return function(n,t){var e=t.ltr();return e.collapsed?t.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return hp.rtl(Ut.fromDom(n.endContainer),n.endOffset,Ut.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return Pg(0,hp.ltr,e)})):Pg(0,hp.ltr,e)}(0,function(n,t){return t.match({domRange:function(n){return{ltr:u(n),rtl:Tn.none}},relative:function(t,e){return{ltr:q((function(){return Ng(n,t,e)})),rtl:q((function(){return Tn.some(Ng(n,e,t))}))}},exact:function(t,e,r,o){return{ltr:q((function(){return jg(n,t,e,r,o)})),rtl:q((function(){return Tn.some(jg(n,r,o,t,e))}))}}})}(n,t))}function Lg(n,t){var e=Y(n);return"input"===e?gp.after(n):k(["br","img"],e)?0===t?gp.before(n):gp.after(n):gp.on(n,t)}function Gg(n,t,e,r){var o=function(n,t,e,r){var o=an(n).dom().createRange();return o.setStart(n.dom(),t),o.setEnd(e.dom(),r),o}(n,t,e,r),i=cn(n,e)&&t===r;return o.collapsed&&!i}function Ug(n,t,e,r,o){!function(n,t){Tn.from(n.getSelection()).each((function(n){n.removeAllRanges(),n.addRange(t)}))}(n,jg(n,t,e,r,o))}function $g(n,t,e,r,o){!function(n,t){zg(n,t).match({ltr:function(t,e,r,o){Ug(n,t,e,r,o)},rtl:function(t,e,r,o){var u=n.getSelection();if(u.setBaseAndExtent)u.setBaseAndExtent(t.dom(),e,r.dom(),o);else if(u.extend)try{!function(n,t,e,r,o,i){t.collapse(e.dom(),r),t.extend(o.dom(),i)}(0,u,t,e,r,o)}catch(i){Ug(n,r,o,t,e)}else Ug(n,r,o,t,e)}})}(n,function(n,t,e,r){var o=Lg(n,t),i=Lg(e,r);return vp.relative(o,i)}(t,e,r,o))}function Wg(n){var t=Ut.fromDom(n.anchorNode),e=Ut.fromDom(n.focusNode);return Gg(t,n.anchorOffset,e,n.focusOffset)?Tn.some(dp.create(t,n.anchorOffset,e,n.focusOffset)):function(n){if(0<n.rangeCount){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return Tn.some(dp.create(Ut.fromDom(t.startContainer),t.startOffset,Ut.fromDom(e.endContainer),e.endOffset))}return Tn.none()}(n)}function Xg(n){return Tn.from(n.getSelection()).filter((function(n){return 0<n.rangeCount})).bind(Wg)}function qg(n,t){return function(n){var t=n.getClientRects(),e=0<t.length?t[0]:n.getBoundingClientRect();return 0<e.width||0<e.height?Tn.some(e).map(Hg):Tn.none()}(function(n,t){return zg(n,t).match({ltr:function(t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(t,e,r,o){var i=n.document.createRange();return i.setStart(r.dom(),o),i.setEnd(t.dom(),e),i}})}(n,t))}function Yg(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:u(2),height:n.height}}function Kg(n){return{left:u(n.left),top:u(n.top),right:u(n.right),bottom:u(n.bottom),width:u(n.width),height:u(n.height)}}function Jg(n,t){mr(n,xp,t)}function Qg(n){return{top:u(n.top()),bottom:u(n.top()+n.height())}}function Zg(n,t){var e=function(n){return Bg(n,xp)}(t),r=n.innerHeight;return r<e?Tn.some(e-r):Tn.none()}function np(n){return Tn.some(Ut.fromDom(n.dom().contentWindow.document.body))}function tp(n){return Tn.some(Ut.fromDom(n.dom().contentWindow.document))}function ep(n){return Tn.from(n.dom().contentWindow)}function rp(n){return ep(n).bind(Xg)}function op(n){return n.getFrame()}function ip(n,t){return function(e){return e[n].getOrThunk((function(){var n=op(e);return function(){return t(n)}}))()}}function up(n,t,e,r){return n[e].getOrThunk((function(){return function(n){return qd(t,r,n)}}))}function cp(n){return{left:u(n.left),top:u(n.top),right:u(n.right),bottom:u(n.bottom),width:u(n.width),height:u(n.height)}}function ap(t,e){var r=null;return{cancel:function(){null!==r&&(n.clearTimeout(r),r=null)},throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null!==r&&n.clearTimeout(r),r=n.setTimeout((function(){t.apply(null,o),r=null}),e)}}}function fp(n){return"true"===pr(n,Pp)?function(n){return 0<n.dom().scrollLeft||function(n){n.dom().scrollLeft=1;var t=0!==n.dom().scrollLeft;return n.dom().scrollLeft=0,t}(n)}(n):function(n){return 0<n.dom().scrollTop||function(n){n.dom().scrollTop=1;var t=0!==n.dom().scrollTop;return n.dom().scrollTop=0,t}(n)}(n)}var sp,lp=function(n,t){var e=function(t){return n(t)?Tn.from(t.dom().nodeValue):Tn.none()};return{get:function(r){if(!n(r))throw new Error("Can only get "+t+" value of a "+t+" node");return e(r).getOr("")},getOption:e,set:function(e,r){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom().nodeValue=r}}}(Yt,"text"),dp={create:Q("start","soffset","finish","foffset")},mp=se([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),gp={before:mp.before,on:mp.on,after:mp.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(o,o,o)}},pp=se([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),vp={domRange:pp.domRange,relative:pp.relative,exact:pp.exact,exactFromRange:function(n){return pp.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){return function(n){return Ut.fromDom(n.dom().ownerDocument.defaultView)}(function(n){return n.match({domRange:function(n){return Ut.fromDom(n.startContainer)},relative:function(n,t){return gp.getStart(n)},exact:function(n,t,e,r){return n}})}(n))},range:dp.create},hp=se([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),yp=(hp.ltr,hp.rtl,function(n){var t=n.getSelection();return void 0!==t&&0<t.rangeCount?function(n){if(n.collapsed){var t=Ut.fromDom(n.startContainer);return fn(t).bind((function(e){var r=vp.exact(t,n.startOffset,e,Vg(e));return qg(n.startContainer.ownerDocument.defaultView,r).map(Yg).map(j)})).getOr([])}return it(n.getClientRects(),Kg)}(t.getRangeAt(0)):[]}),bp=function(n){n.focus();var t=Ut.fromDom(n.document.body);(So().exists((function(n){return k(["input","textarea"],Y(n))}))?function(n){Eg.setTimeout((function(){n()}),0)}:s)((function(){So().each(wo),xo(t)}))},xp="data-"+Di.resolve("last-outer-height"),wp=function(n,t){var e=Ut.fromDom(t.document.body),r=qd(Ut.fromDom(n),"resize",(function(){Zg(n,e).each((function(n){(function(n){var t=yp(n);return 0<t.length?Tn.some(t[0]).map(Qg):Tn.none()})(t).each((function(e){var r=function(n,t,e){return t.top()>n.innerHeight||t.bottom()>n.innerHeight?Math.min(e,t.bottom()-n.innerHeight+50):0}(t,e,n);0!==r&&t.scrollTo(t.pageXOffset,t.pageYOffset+r)}))})),Jg(e,n.innerHeight)}));return Jg(e,n.innerHeight),{toEditing:function(){bp(t)},destroy:function(){r.unbind()}}},Sp={getBody:ip("getBody",np),getDoc:ip("getDoc",tp),getWin:ip("getWin",ep),getSelection:ip("getSelection",rp),getFrame:op,getActiveApi:function(n){var t=op(n);return np(t).bind((function(e){return tp(t).bind((function(r){return ep(t).map((function(o){var i=Ut.fromDom(r.dom().documentElement),a=n.getCursorBox.getOrThunk((function(){return function(){return function(n){return Xg(n).map((function(n){return vp.exact(n.start(),n.soffset(),n.finish(),n.foffset())}))}(o).bind((function(n){return qg(o,n).orThunk((function(){return function(n){return Xg(n).filter((function(n){return cn(n.start(),n.finish())&&n.soffset()===n.foffset()})).bind((function(n){var t=n.start().dom().getBoundingClientRect();return 0<t.width||0<t.height?Tn.some(t).map(cp):Tn.none()}))}(o)}))}))}})),f=n.setSelection.getOrThunk((function(){return function(n,t,e,r){$g(o,n,t,e,r)}})),s=n.clearSelection.getOrThunk((function(){return function(){!function(n){n.getSelection().removeAllRanges()}(o)}}));return{body:u(e),doc:u(r),win:u(o),html:u(i),getSelection:c(rp,t),setSelection:f,clearSelection:s,frame:u(t),onKeyup:up(n,r,"onKeyup","keyup"),onNodeChanged:up(n,r,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:a}}))}))}))}},Tp="data-ephox-mobile-fullscreen-style",Op="position:absolute!important;",kp="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Ep=G().os.isAndroid(),Cp=function(n,t){function e(n){return function(t){var e=pr(t,"style"),r=void 0===e?"no-styles":e.trim();r!==n&&(mr(t,Tp,r),mr(t,"style",n))}}var r=function(n,t,e){return Ni(n,(function(n){return en(n,t)}),e)}(n,"*"),o=R(r,(function(n){return function(n,t){return ji(n,(function(n){return en(n,t)}))}(n,"*")})),i=function(n){var t=ri(n,"background-color");return void 0!==t&&""!==t?"background-color:"+t+"!important":"background-color:rgb(255,255,255)!important;"}(t);C(o,e("display:none!important;")),C(r,e(Op+kp+i)),e((!0===Ep?"":Op)+kp+i)(n)},Dp=function(){var n=function(n){return on(n)}("["+Tp+"]");C(n,(function(n){var t=pr(n,Tp);"no-styles"!==t?mr(n,"style",t):hr(n,"style"),hr(n,Tp)}))},_p=function(){var n=Pi("head").getOrDie(),t=Pi('meta[name="viewport"]').getOrThunk((function(){var t=Ut.fromTag("meta");return mr(t,"name","viewport"),te(n,t),t})),e=pr(t,"content");return{maximize:function(){mr(t,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){void 0!==e&&null!==e&&0<e.length?mr(t,"content",e):mr(t,"content","user-scalable=yes")}}},Mp=function(n,t){var e=_p(),r=ld(),o=ld();return{enter:function(){t.hide(),Sr(n.container,Di.resolve("fullscreen-maximized")),Sr(n.container,Di.resolve("android-maximized")),e.maximize(),Sr(n.body,Di.resolve("android-scroll-reload")),r.set(wp(n.win,Sp.getWin(n.editor).getOrDie("no"))),Sp.getActiveApi(n.editor).each((function(t){Cp(n.container,t.body()),o.set(Rg(t,n.toolstrip,n.alloy))}))},exit:function(){e.restore(),t.show(),Or(n.container,Di.resolve("fullscreen-maximized")),Or(n.container,Di.resolve("android-maximized")),Dp(),Or(n.body,Di.resolve("android-scroll-reload")),o.clear(),r.clear()}}},Ip=function(t,e){var r=Ms(cm.sketch({dom:Ns('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:so([Ti.config({toggleClass:Di.resolve("mask-tap-icon-selected"),toggleOnExecute:!1})])})),o=function(t,e){var r=null;return{cancel:function(){null!==r&&(n.clearTimeout(r),r=null)},throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null===r&&(r=n.setTimeout((function(){t.apply(null,o),r=null}),e))}}}(t,200);return cm.sketch({dom:Ns('<div class="${prefix}-disabled-mask"></div>'),components:[cm.sketch({dom:Ns('<div class="${prefix}-content-container"></div>'),components:[Bs.sketch({dom:Ns('<div class="${prefix}-content-tap-section"></div>'),components:[r.asSpec()],action:function(n){o.throttle()},buttonBehaviours:so([Ti.config({toggleClass:Di.resolve("mask-tap-icon-selected")})])})]})]})},Ap=Xr([Le("editor",[Pe("getFrame"),Ge("getBody"),Ge("getDoc"),Ge("getWin"),Ge("getSelection"),Ge("setSelection"),Ge("clearSelection"),Ge("cursorSaver"),Ge("onKeyup"),Ge("onNodeChanged"),Ge("getCursorBox"),Pe("onDomChanged"),Xe("onTouchContent",r),Xe("onTapContent",r),Xe("onTouchToolstrip",r),Xe("onScrollToCursor",u({unbind:r})),Xe("onScrollToElement",u({unbind:r})),Xe("onToEditing",u({unbind:r})),Xe("onToReading",u({unbind:r})),Xe("onToolbarScrollStart",o)]),Pe("socket"),Pe("toolstrip"),Pe("dropup"),Pe("toolbar"),Pe("container"),Pe("alloy"),Ye("win",(function(n){return an(n.socket).dom().defaultView})),Ye("body",(function(n){return Ut.fromDom(n.socket.dom().ownerDocument.body)})),Xe("translate",o),Xe("setReadOnly",r),Xe("readOnlyOnInit",u(!0))]),Fp=function(n){var t=je("Getting AndroidWebapp schema",Ap,n);Fi(t.toolstrip,"width","100%");var e=Nm(Ip((function(){t.setReadOnly(t.readOnlyOnInit()),i.enter()}),t.translate));t.alloy.add(e);var o={show:function(){t.alloy.add(e)},hide:function(){t.alloy.remove(e)}};te(t.container,e.element());var i=Mp(t,o);return{setReadOnly:t.setReadOnly,refreshStructure:r,enter:i.enter,exit:i.exit,destroy:r}},Rp=u([Pe("dom"),Xe("shell",!0),oc("toolbarBehaviours",[Zm])]),Bp=u([Ya({name:"groups",overrides:function(){return{behaviours:so([Zm.config({})])}}})]),Vp=ff({name:"Toolbar",configFields:Rp(),partFields:Bp(),factory:function(t,e,r,o){var i=function(n){return t.shell?Tn.some(n):hc(n,t,"groups")},u=t.shell?{behaviours:[Zm.config({})],components:[]}:{behaviours:[],components:e};return{uid:t.uid,dom:t.dom,components:u.components,behaviours:uc(t.toolbarBehaviours,u.behaviours),apis:{setGroups:function(t,e){i(t).fold((function(){throw n.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){Zm.set(n,e)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),Np=u([Pe("items"),(sp=["itemSelector"],Le("markers",it(sp,Pe))),oc("tgroupBehaviours",[Ea])]),jp=u([Ka({name:"items",unit:"item"})]),Hp=ff({name:"ToolbarGroup",configFields:Np(),partFields:jp(),factory:function(n,t,e,r){return{uid:n.uid,dom:n.dom,components:t,behaviours:uc(n.tgroupBehaviours,[Ea.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),Pp="data-"+Di.resolve("horizontal-scroll"),zp={exclusive:function(n,t){return qd(n,"touchmove",(function(n){Gi(n.target(),t).filter(fp).fold((function(){n.raw().preventDefault()}),r)}))},markAsHorizontal:function(n){mr(n,Pp,"true")}};function Lp(){function n(n){var t=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:Ns('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+t+'"></div>'),tgroupBehaviours:so([rm("adhoc-scrollable-toolbar",!0===n.scrollable?[oo((function(n,t){Fi(n.element(),"overflow-x","auto"),zp.markAsHorizontal(n.element()),dg.register(n.element())}))]:[])]),components:[cm.sketch({components:[Hp.parts().items({})]})],markers:{itemSelector:"."+Di.resolve("toolbar-group-item")},items:n.items}}function t(){Vp.setGroups(e,o.get()),Ti.off(e)}var e=Nm(Vp.sketch({dom:Ns('<div class="${prefix}-toolbar"></div>'),components:[Vp.parts().groups({})],toolbarBehaviours:so([Ti.config({toggleClass:Di.resolve("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),Ea.config({mode:"cyclic"})]),shell:!0})),r=Nm(cm.sketch({dom:{classes:[Di.resolve("toolstrip")]},components:[jm(e)],containerBehaviours:so([Ti.config({toggleClass:Di.resolve("android-selection-context-toolbar"),toggleOnExecute:!1})])})),o=In([]);return{wrapper:u(r),toolbar:u(e),createGroups:function(t){return it(t,i(Hp.sketch,n))},setGroups:function(n){o.set(n),t()},setContextToolbar:function(n){Ti.on(e),Vp.setGroups(e,n)},restoreToolbar:function(){Ti.isOn(e)&&t()},refresh:function(){},focus:function(){Ea.focusIn(e)}}}function Gp(n,t){Zm.append(n,jm(t))}function Up(n,t){Zm.remove(n,t)}function $p(n,t){return t.getAnimationRoot.fold((function(){return n.element()}),(function(t){return t(n)}))}function Wp(n){return n.dimension.property}function Xp(n,t){return n.dimension.getDimension(t)}function qp(n,t){var e=$p(n,t);Od(e,[t.shrinkingClass,t.growingClass])}function Yp(n,t){Or(n.element(),t.openClass),Sr(n.element(),t.closedClass),Fi(n.element(),Wp(t),"0px"),ui(n.element())}function Kp(n,t){Or(n.element(),t.closedClass),Sr(n.element(),t.openClass),ii(n.element(),Wp(t))}function Jp(n,t,e,r){e.setCollapsed(),Fi(n.element(),Wp(t),Xp(t,n.element())),ui(n.element()),qp(n,t),Yp(n,t),t.onStartShrink(n),t.onShrunk(n)}function Qp(n,t,e,r){var o=r.getOrThunk((function(){return Xp(t,n.element())}));e.setCollapsed(),Fi(n.element(),Wp(t),o),ui(n.element());var i=$p(n,t);Or(i,t.growingClass),Sr(i,t.shrinkingClass),Yp(n,t),t.onStartShrink(n)}function Zp(n,t,e){var r=Xp(t,n.element());("0px"===r?Jp:Qp)(n,t,e,Tn.some(r))}function nv(n,t,e){var r=$p(n,t),o=kr(r,t.shrinkingClass),i=Xp(t,n.element());Kp(n,t);var u=Xp(t,n.element());(o?function(){Fi(n.element(),Wp(t),i),ui(n.element())}:function(){Yp(n,t)})(),Or(r,t.shrinkingClass),Sr(r,t.growingClass),Kp(n,t),Fi(n.element(),Wp(t),u),e.setExpanded(),t.onStartGrow(n)}function tv(n,t,e){var r=$p(n,t);return!0===kr(r,t.growingClass)}function ev(n,t,e){var r=$p(n,t);return!0===kr(r,t.shrinkingClass)}function rv(t,e){var o=Nm(cm.sketch({dom:{tag:"div",classes:[Di.resolve("dropup")]},components:[],containerBehaviours:so([Zm.config({}),vv.config({closedClass:Di.resolve("dropup-closed"),openClass:Di.resolve("dropup-open"),shrinkingClass:Di.resolve("dropup-shrinking"),growingClass:Di.resolve("dropup-growing"),dimension:{property:"height"},onShrunk:function(n){t(),e(),Zm.set(n,[])},onGrown:function(n){t(),e()}}),ki((function(n,t){i(r)}))])})),i=function(t){n.window.requestAnimationFrame((function(){t(),vv.shrink(o)}))};return{appear:function(t,e,r){!0===vv.hasShrunk(o)&&!1===vv.isTransitioning(o)&&n.window.requestAnimationFrame((function(){e(r),Zm.set(o,[t()]),vv.grow(o)}))},disappear:i,component:u(o),element:o.element}}function ov(n){return 8===n.raw().which&&!k(["input","textarea"],Y(n.target()))&&!function(n,t,e){return Gi(n,t,e).isSome()}(n.target(),'[contenteditable="true"]')}function iv(t,e){var r=je("Getting GUI events settings",yv,e),o=Ig(r),i=it(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return qd(t,n,(function(t){o.fireIfReady(t,n).each((function(n){n&&t.kill()})),r.triggerEvent(n,t)&&t.kill()}))})),u=In(Tn.none()),c=qd(t,"paste",(function(t){o.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),r.triggerEvent("paste",t)&&t.kill(),u.set(Tn.some(n.setTimeout((function(){r.triggerEvent(Mt(),t)}),0)))})),a=qd(t,"keydown",(function(n){r.triggerEvent("keydown",n)?n.kill():!0===r.stopBackspace&&ov(n)&&n.prevent()})),f=function(n,t){return hv?Yd(n,"focus",t):qd(n,"focusin",t)}(t,(function(n){r.triggerEvent("focusin",n)&&n.kill()})),s=In(Tn.none()),l=function(n,t){return hv?Yd(n,"blur",t):qd(n,"focusout",t)}(t,(function(t){r.triggerEvent("focusout",t)&&t.kill(),s.set(Tn.some(n.setTimeout((function(){r.triggerEvent(_t(),t)}),0)))}));return{unbind:function(){C(i,(function(n){n.unbind()})),a.unbind(),f.unbind(),l.unbind(),c.unbind(),u.get().each(n.clearTimeout),s.get().each(n.clearTimeout)}}}function uv(n,t){var e=_n(n,"target").map((function(n){return n()})).getOr(t);return In(e)}function cv(n,t,e,r,o,i){var c=n(t,r),a=function(n,t){var e=In(!1),r=In(!1);return{stop:function(){e.set(!0)},cut:function(){r.set(!0)},isStopped:e.get,isCut:r.get,event:u(n),setSource:t.set,getSource:t.get}}(e,o);return c.fold((function(){return i.logEventNoHandlers(t,r),bv.complete()}),(function(n){var e=n.descHandler();return hd(e)(a),a.isStopped()?(i.logEventStopped(t,n.element(),e.purpose()),bv.stopped()):a.isCut()?(i.logEventCut(t,n.element(),e.purpose()),bv.complete()):fn(n.element()).fold((function(){return i.logNoParent(t,n.element(),e.purpose()),bv.complete()}),(function(r){return i.logEventResponse(t,n.element(),e.purpose()),bv.resume(r)}))}))}function av(n,t,e){var o=function(n){var t=In(!1);return{stop:function(){t.set(!0)},cut:r,isStopped:t.get,isCut:u(!1),event:u(n),setSource:f("Cannot set source of a broadcasted event"),getSource:f("Cannot get source of a broadcasted event")}}(t);return C(n,(function(n){var t=n.descHandler();hd(t)(o)})),o.isStopped()}var fv,sv=function(n){return Nm(Bs.sketch({dom:Ns('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run((function(n){n.setReadOnly(!1)}))}}))},lv=function(){return Nm(cm.sketch({dom:Ns('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:so([Zm.config({})])}))},dv=function(n,t,e,r){(!0===e?ho.toAlpha:ho.toOmega)(r),(e?Gp:Up)(n,t)},mv=Object.freeze({__proto__:null,refresh:function(n,t,e){if(e.isExpanded()){ii(n.element(),Wp(t));var r=Xp(t,n.element());Fi(n.element(),Wp(t),r)}},grow:function(n,t,e){e.isExpanded()||nv(n,t,e)},shrink:function(n,t,e){e.isExpanded()&&Zp(n,t,e)},immediateShrink:function(n,t,e){e.isExpanded()&&Jp(n,t,e,Tn.none())},hasGrown:function(n,t,e){return e.isExpanded()},hasShrunk:function(n,t,e){return e.isCollapsed()},isGrowing:tv,isShrinking:ev,isTransitioning:function(n,t,e){return!0===tv(n,t)||!0===ev(n,t)},toggleGrow:function(n,t,e){(e.isExpanded()?Zp:nv)(n,t,e)},disableTransitions:qp}),gv=Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.expanded;return cr(e?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:xe(t.dimension.property,"0px")})},events:function(n,t){return Ze([function(n,t){return rr(n)(t)}(kt(),(function(e,r){r.event().raw().propertyName===n.dimension.property&&(qp(e,n),t.isExpanded()&&ii(e.element(),n.dimension.property),(t.isExpanded()?n.onGrown:n.onShrunk)(e))}))])}}),pv=[Pe("closedClass"),Pe("openClass"),Pe("shrinkingClass"),Pe("growingClass"),Ge("getAnimationRoot"),Po("onShrunk"),Po("onStartShrink"),Po("onGrown"),Po("onStartGrow"),Xe("expanded",!1),ze("dimension",He("property",{width:[Uo("property","width"),Uo("getDimension",(function(n){return wf(n)+"px"}))],height:[Uo("property","height"),Uo("getDimension",(function(n){return Vi(n)+"px"}))]}))],vv=lr({fields:pv,name:"sliding",active:gv,apis:mv,state:Object.freeze({__proto__:null,init:function(n){var t=In(n.expanded);return fo({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:c(t.set,!1),setExpanded:c(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),hv=G().browser.isFirefox(),yv=Me([(fv="triggerEvent",ze(fv,no)),Xe("stopBackspace",!0)]),bv=se([{stopped:[]},{resume:["element"]},{complete:[]}]),xv=function(n,t,e,r,o,i){return cv(n,t,e,r,o,i).fold((function(){return!0}),(function(r){return xv(n,t,e,r,o,i)}),(function(){return!1}))},wv=function(n,t,e,r,o){var i=uv(e,r);return xv(n,t,e,r,i,o)},Sv=Q("element","descHandler"),Tv=function(n,t){return{id:u(n),descHandler:u(t)}};function Ov(){var n={};return{registerId:function(t,e,r){En(r,(function(r,o){var i=void 0!==n[o]?n[o]:{};i[e]=Fm(r,t),n[o]=i}))},unregisterId:function(t){En(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))},filterByType:function(t){return _n(n,t).map((function(n){return Dn(n,(function(n,t){return Tv(t,n)}))})).getOr([])},find:function(t,e,r){var o=_n(n,e);return to(r,(function(n){return function(n,t){return uf(t).fold((function(){return Tn.none()}),(function(e){return n.bind((function(n){return _n(n,e)})).map((function(n){return Sv(t,n)}))}))}(o,n)}),t)}}}function kv(){function n(n){var t=n.element();return uf(t).fold((function(){return function(n,t){var e=sc(ef+n);return of(t,e),e}("uid-",n.element())}),(function(n){return n}))}var t=Ov(),e={},r=function(n){uf(n.element()).each((function(n){delete e[n],t.unregisterId(n)}))};return{find:function(n,e,r){return t.find(n,e,r)},filter:function(n){return t.filterByType(n)},register:function(o){var i=n(o);x(e,i)&&function(n,t){var o=e[t];if(o!==n)throw new Error('The tagId "'+t+'" is already used by: '+Do(o.element())+"\nCannot use it for: "+Do(n.element())+"\nThe conflicting element is"+(J(o.element())?" ":" not ")+"already in the DOM");r(n)}(o,i);var u=[o];t.registerId(u,i,o.events()),e[i]=o},unregister:r,getById:function(n){return _n(e,n)}}}var Ev=function(n){function t(t){return fn(n.element()).fold((function(){return!0}),(function(n){return cn(t,n)}))}function e(n,e){return i.find(t,n,e)}function o(n){var t=i.filter(It());C(t,(function(t){var e=t.descHandler();hd(e)(n)}))}var i=kv(),c=iv(n.element(),{triggerEvent:function(n,t){return jo(n,t.target(),(function(r){return function(n,t,e,r){var o=e.target();return wv(n,t,e,o,r)}(e,n,t,r)}))}}),a={debugInfo:u("real"),triggerEvent:function(n,t,r){jo(n,t,(function(o){return wv(e,n,r,t,o)}))},triggerFocus:function(n,t){uf(n).fold((function(){xo(n)}),(function(o){jo(Dt(),n,(function(o){return function(n,t,e,r,o){var i=uv(e,r);cv(n,t,e,r,i,o)}(e,Dt(),{originator:u(t),kill:r,prevent:r,target:u(n)},n,o),!1}))}))},triggerEscape:function(n,t){a.triggerEvent("keydown",n.element(),t.event())},getByUid:function(n){return v(n)},getByDom:function(n){return h(n)},build:Nm,addToGui:function(n){l(n)},removeFromGui:function(n){d(n)},addToWorld:function(n){f(n)},removeFromWorld:function(n){s(n)},broadcast:function(n){m(n)},broadcastOn:function(n,t){g(n,t)},broadcastEvent:function(n,t){p(n,t)},isConnected:u(!0)},f=function(n){n.connect(a),Yt(n.element())||(i.register(n),C(n.components(),f),a.triggerEvent(Vt(),n.element(),{target:u(n.element())}))},s=function(n){Yt(n.element())||(C(n.components(),s),i.unregister(n)),n.disconnect()},l=function(t){!function(n,t){ie(n,t,te)}(n,t)},d=function(n){yn(n)},m=function(n){o({universal:u(!0),data:u(n)})},g=function(n,t){o({universal:u(!1),channels:u(n),data:u(t)})},p=function(n,t){var e=i.filter(n);return av(e,t)},v=function(n){return i.getById(n).fold((function(){return fe.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),fe.value)},h=function(n){var t=uf(n).getOr("not found");return v(t)};return f(n),{root:u(n),element:n.element,destroy:function(){c.unbind(),ee(n.element())},add:l,remove:d,getByUid:v,getByDom:h,addToWorld:f,removeFromWorld:s,broadcast:m,broadcastOn:g,broadcastEvent:p}},Cv=u(Di.resolve("readonly-mode")),Dv=u(Di.resolve("edit-mode"));function _v(n){var t=Nm(cm.sketch({dom:{classes:[Di.resolve("outer-container")].concat(n.classes)},containerBehaviours:so([ho.config({alpha:Cv(),omega:Dv()})])}));return Ev(t)}var Mv,Iv,Av,Fv,Rv=function(n,t){var e=Ut.fromTag("input");ei(e,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),te(n,e),xo(e),t(e),ee(e)},Bv=function(n){var t=n.getSelection();if(0<t.rangeCount){var e=t.getRangeAt(0),r=n.document.createRange();r.setStart(e.startContainer,e.startOffset),r.setEnd(e.endContainer,e.endOffset),t.removeAllRanges(),t.addRange(r)}},Vv=function(n,t){So().each((function(n){cn(n,t)||wo(n)})),n.focus(),xo(Ut.fromDom(n.document.body)),Bv(n)},Nv={stubborn:function(n,t,e,r){function o(){Vv(t,r)}var i=qd(e,"keydown",(function(n){k(["input","textarea"],Y(n.target()))||o()}));return{toReading:function(){Rv(n,wo)},toEditing:o,onToolbarTouch:function(){},destroy:function(){i.unbind()}}},timid:function(n,t,e,o){function i(){wo(o)}return{toReading:function(){i()},toEditing:function(){Vv(t,o)},onToolbarTouch:function(){i()},destroy:r}}},jv=function(n,t,e,r,o){function i(){t.run((function(n){n.refreshSelection()}))}function u(n,e){var o=n-r.dom().scrollTop;t.run((function(n){n.scrollIntoView(o,o+e)}))}function c(){t.run((function(n){n.clearSelection()}))}function a(){n.getCursorBox().each((function(n){u(n.top(),n.height())})),t.run((function(n){n.syncHeight()}))}var f=Ag(n),s=ap(a,300),l=[n.onKeyup((function(){c(),s.throttle()})),n.onNodeChanged(i),n.onDomChanged(s.throttle),n.onDomChanged(i),n.onScrollToCursor((function(n){n.preventDefault(),s.throttle()})),n.onScrollToElement((function(n){n.element(),u(t,r)})),n.onToEditing((function(){t.run((function(n){n.toEditing()}))})),n.onToReading((function(){t.run((function(n){n.toReading()}))})),qd(n.doc(),"touchend",(function(t){cn(n.html(),t.target())||cn(n.body(),t.target())})),qd(e,"transitionend",(function(n){"height"===n.raw().propertyName&&function(){var n=Vi(e);t.run((function(t){t.setViewportOffset(n)})),i(),a()}()})),Yd(e,"touchstart",(function(e){t.run((function(n){n.highlightSelection()})),function(n){t.run((function(t){t.onToolbarTouch(n)}))}(e),n.onTouchToolstrip()})),qd(n.body(),"touchstart",(function(t){c(),n.onTouchContent(),f.fireTouchstart(t)})),f.onTouchmove(),f.onTouchend(),qd(n.body(),"click",(function(n){n.kill()})),qd(e,"touchmove",(function(){n.onToolbarScrollStart()}))];return{destroy:function(){C(l,(function(n){n.unbind()}))}}},Hv={},Pv={exports:Hv};function zv(t){n.setTimeout((function(){throw t}),0)}function Lv(n,t,e){return Math.abs(n-t)<=e?Tn.none():n<t?Tn.some(n+e):Tn.some(n-e)}function Gv(n,t){return H([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],(function(e){return function(n,t){return n?Tn.some(t):Tn.none()}(n<=e.width&&t<=e.height,e.keyboard)})).getOr({portrait:t/5,landscape:n/4})}function Uv(n){var t=Cg(n).isPortrait(),e=function(n){return Gv(n.screen.width,n.screen.height)}(n),r=t?e.portrait:e.landscape;return(t?n.screen.height:n.screen.width)-n.innerHeight>r?0:r}function $v(n,t){var e=an(n).dom().defaultView;return Vi(n)+Vi(t)-Uv(e)}function Wv(n){return Bg(n,sh)}function Xv(n,t){var e=function(n){return pr(n,lh)}(n);return fh.fixed(n,e,t)}function qv(n,t){return fh.scroller(n,t)}function Yv(n){var t=Wv(n);return("true"===pr(n,dh)?qv:Xv)(n,t)}function Kv(n,t,e){var r=an(n).dom().defaultView.innerHeight;return mr(n,mh,r+"px"),r-t-e}function Jv(n){var t=oi(n,"top").getOr("0");return parseInt(t,10)}function Qv(n){return parseInt(n.dom().scrollTop,10)}function Zv(n,t){var e=t+vh(n)+"px";Fi(n,"top",e)}Mv=void 0,Iv=Hv,Av=Pv,Fv=void 0,function(n){"object"==typeof Iv&&void 0!==Av?Av.exports=n():"function"==typeof Mv&&Mv.amd?Mv([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}((function(){return function n(t,e,r){function o(u,c){if(!e[u]){if(!t[u]){var a="function"==typeof Fv&&Fv;if(!c&&a)return a(u,!0);if(i)return i(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var s=e[u]={exports:{}};t[u][0].call(s.exports,(function(n){return o(t[u][1][n]||n)}),s,s.exports,n,t,e,r)}return e[u].exports}for(var i="function"==typeof Fv&&Fv,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(n,t,e){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(t){try{return r.call(null,n,0)}catch(t){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var f,s=[],l=!1,d=-1;function m(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&g())}function g(){if(!l){var n=a(m);l=!0;for(var t=s.length;t;){for(f=s,s=[];++d<t;)f&&f[d].run();d=-1,t=s.length}f=null,l=!1,function(n){if(o===clearTimeout)return clearTimeout(n);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{o(n)}catch(t){try{return o.call(null,n)}catch(t){return o.call(this,n)}}}(n)}}function p(n,t){this.fun=n,this.array=t}function v(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];s.push(new p(n,t)),1!==s.length||l||a(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){function e(){}function r(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function o(n,t){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,r._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var r;try{r=e(n._value)}catch(l){return void u(t.promise,l)}i(t.promise,r)}else(1===n._state?i:u)(t.promise,n._value)}))):n._deferreds.push(t)}function i(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof r)return n._state=3,n._value=t,void c(n);if("function"==typeof e)return void f(function(n,t){return function(){n.apply(t,arguments)}}(e,t),n)}n._state=1,n._value=t,c(n)}catch(o){u(n,o)}}function u(n,t){n._state=2,n._value=t,c(n)}function c(n){2===n._state&&0===n._deferreds.length&&r._immediateFn((function(){n._handled||r._unhandledRejectionFn(n._value)}));for(var t=0,e=n._deferreds.length;t<e;t++)o(n,n._deferreds[t]);n._deferreds=null}function a(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function f(n,t){var r=!1;try{n((function(n){r||(r=!0,i(t,n))}),(function(n){r||(r=!0,u(t,n))}))}catch(e){if(r)return;r=!0,u(t,e)}}var s,l;s=this,l=setTimeout,r.prototype["catch"]=function(n){return this.then(null,n)},r.prototype.then=function(n,t){var r=new this.constructor(e);return o(this,new a(n,t,r)),r},r.all=function(n){var t=Array.prototype.slice.call(n);return new r((function(n,r){if(0===t.length)return n([]);var o=t.length;function i(u,c){try{if(c&&("object"==typeof c||"function"==typeof c)){var a=c.then;if("function"==typeof a)return void a.call(c,(function(n){i(u,n)}),r)}t[u]=c,0==--o&&n(t)}catch(e){r(e)}}for(var u=0;u<t.length;u++)i(u,t[u])}))},r.resolve=function(n){return n&&"object"==typeof n&&n.constructor===r?n:new r((function(t){t(n)}))},r.reject=function(n){return new r((function(t,e){e(n)}))},r.race=function(n){return new r((function(t,e){for(var r=0,o=n.length;r<o;r++)n[r].then(t,e)}))},r._immediateFn="function"==typeof n?function(t){n(t)}:function(n){l(n,0)},r._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},r._setImmediateFn=function(n){r._immediateFn=n},r._setUnhandledRejectionFn=function(n){r._unhandledRejectionFn=n},void 0!==t&&t.exports?t.exports=r:s.Promise||(s.Promise=r)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,r){var o=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,c={},a=0;function f(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new f(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new f(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;0<=t&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"==typeof t?t:function(n){var t=a++,r=!(arguments.length<2)&&u.call(arguments,1);return c[t]=!0,o((function(){c[t]&&(r?n.apply(null,r):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"==typeof r?r:function(n){delete c[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}));var nh=Pv.exports.boltExport,th=function(t){var e=Tn.none(),r=[],o=function(n){i()?c(n):r.push(n)},i=function(){return e.isSome()},u=function(n){C(n,c)},c=function(t){e.each((function(e){n.setTimeout((function(){t(e)}),0)}))};return t((function(n){e=Tn.some(n),u(r),r=[]})),{get:o,map:function(n){return th((function(t){o((function(e){t(n(e))}))}))},isReady:i}},eh={nu:th,pure:function(n){return th((function(t){t(n)}))}},rh=function(n){function t(t){n().then(t,zv)}return{map:function(t){return rh((function(){return n().then(t)}))},bind:function(t){return rh((function(){return n().then((function(n){return t(n).toPromise()}))}))},anonBind:function(t){return rh((function(){return n().then((function(){return t.toPromise()}))}))},toLazy:function(){return eh.nu(t)},toCached:function(){var t=null;return rh((function(){return null===t&&(t=n()),t}))},toPromise:n,get:t}},oh=function(n){return rh((function(){return new nh(n)}))},ih=function(n){return rh((function(){return nh.resolve(n)}))},uh=function(){var n=null;return{animate:function(t,e,r,o,i,u){function c(n){a=!0,i(n)}var a=!1;function f(t){Eg.clearInterval(n),c(t)}Eg.clearInterval(n),n=Eg.setInterval((function(){var i=t();Lv(i,e,r).fold((function(){Eg.clearInterval(n),c(e)}),(function(r){if(o(r,f),!a){var u=t();(u!==r||Math.abs(u-e)>Math.abs(i-e))&&(Eg.clearInterval(n),c(e))}}))}),u)}}},ch=$v,ah=function(n,t,e){var r=$v(t,e),o=Vi(t)+Vi(e)-r;Fi(n,"padding-bottom",o+"px")},fh=se([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),sh="data-"+Di.resolve("position-y-fixed"),lh="data-"+Di.resolve("y-property"),dh="data-"+Di.resolve("scrolling"),mh="data-"+Di.resolve("last-window-height"),gh=function(n){var t=Hi(n,"["+sh+"]");return it(t,Yv)},ph=function(n,t,e,r){function o(){var t=u.innerHeight;return function(n){return Bg(n,mh)}(n)<t}function i(){if(m){var o=Vi(e),i=Vi(r),u=Kv(n,o,i);mr(n,sh,o+"px"),Fi(n,"height",u+"px"),ah(t,n,r)}}var u=an(n).dom().defaultView,c=function(n){var t=pr(n,"style");return ei(n,{position:"absolute",top:"0px"}),mr(n,sh,"0px"),mr(n,lh,"top"),{restore:function(){mr(n,"style",t||""),hr(n,sh),hr(n,lh)}}}(e),f=Vi(e),s=Vi(r),l=function(n,t,e){var r=pr(e,"style");return dg.register(e),ei(e,{position:"absolute",height:t+"px",width:"100%",top:n+"px"}),mr(e,sh,n+"px"),mr(e,dh,"true"),mr(e,lh,"top"),{restore:function(){dg.deregister(e),mr(e,"style",r||""),hr(e,sh),hr(e,dh),hr(e,lh)}}}(f,Kv(n,f,s),n),d=function(n){var t=pr(n,"style");return ei(n,{position:"absolute",bottom:"0px"}),mr(n,sh,"0px"),mr(n,lh,"bottom"),{restore:function(){mr(n,"style",t||""),hr(n,sh),hr(n,lh)}}}(r),m=!0;return ah(t,n,r),{setViewportOffset:function(t){mr(n,sh,t+"px"),i()},isExpanding:o,isShrinking:a(o),refresh:i,restore:function(){m=!1,c.restore(),l.restore(),d.restore()}}},vh=Wv,hh=uh(),yh="data-"+Di.resolve("last-scroll-top"),bh=function(n,t,e){return oh((function(r){var o=c(Qv,n);hh.animate(o,t,15,(function(t){n.dom().scrollTop=t,Fi(n,"top",Jv(n)+15+"px")}),(function(){n.dom().scrollTop=t,Fi(n,"top",e+"px"),r(t)}),10)}))},xh=function(n,t){return oh((function(e){var r=c(Qv,n);mr(n,yh,r());var o=Math.abs(t-r()),i=Math.ceil(o/10);hh.animate(r,t,i,(function(t,e){Bg(n,yh)!==n.dom().scrollTop?e(n.dom().scrollTop):(n.dom().scrollTop=t,mr(n,yh,t))}),(function(){n.dom().scrollTop=t,mr(n,yh,t),e(t)}),10)}))},wh=function(n,t){return oh((function(e){function r(t){Fi(n,"top",t+"px")}var o=c(Jv,n),i=Math.abs(t-o()),u=Math.ceil(i/10);hh.animate(o,t,u,r,(function(){r(t),e(t)}),10)}))},Sh=function(n,t,e){var r=an(n).dom().defaultView;return oh((function(o){Zv(n,e),Zv(t,e),r.scrollTo(0,e),o(e)}))};function Th(n,t){return t((function(t){var e=[],r=0;0===n.length?t([]):C(n,(function(o,i){o.get(function(o){return function(i){e[o]=i,++r>=n.length&&t(e)}}(i))}))}))}function Oh(n,t){return n.fold((function(n,e,r){return function(n,t,e,r){return Fi(n,t,e+r+"px"),ih(r)}(n,e,t,r)}),(function(n,e){return function(n,t,e){var r=t+e,o=oi(n,"top").getOr(e),i=r-parseInt(o,10),u=n.dom().scrollTop+i;return bh(n,u,r)}(n,t,e)}))}function kh(n,t,e,r,i,c){var a=function(n){var t=In(eh.pure({}));return{start:function(e){var r=eh.nu((function(t){return n(e).get(t)}));t.set(r)},idle:function(n){t.get().get((function(){n()}))}}}((function(e){return Sh(n,t,e)})),f=ap((function(){a.idle((function(){Ch(e,r.pageYOffset).get((function(){(function(){var n=yp(c);return Tn.from(n[0]).bind((function(n){var e=n.top()-t.dom().scrollTop;return e>r.innerHeight+5||e<-5?Tn.some({top:u(e),bottom:u(e+n.height())}):Tn.none()}))})().each((function(n){t.dom().scrollTop=t.dom().scrollTop+n.top()})),a.start(0),i.refresh()}))}))}),1e3),s=qd(Ut.fromDom(r),"scroll",(function(){r.pageYOffset<0||f.throttle()}));return Ch(e,r.pageYOffset).get(o),{unbind:s.unbind}}var Eh=function(n,t,e,r,o){var i=ch(t,e),u=c(Bv,n);i<r||i<o?xh(t,t.dom().scrollTop-i+o).get(u):r<0&&xh(t,t.dom().scrollTop+r).get(u)},Ch=function(n,t){var e=gh(n);return function(n){return Th(n,oh)}(it(e,(function(n){return Oh(n,t)})))},Dh=function(n){var t=n.cWin(),e=n.ceBody(),i=n.socket(),u=n.toolstrip(),c=n.toolbar(),a=n.contentElement(),f=n.keyboardType(),s=n.outerWindow(),l=n.dropup(),d=ph(i,e,u,l),m=f(n.outerBody(),t,Kt(),a,u,c),g=Dg(s,{onChange:r,onReady:d.refresh});g.onAdjustment((function(){d.refresh()}));var p=qd(Ut.fromDom(s),"resize",(function(){d.isExpanding()&&d.refresh()})),v=kh(u,i,n.outerBody(),s,d,t),h=function(n,t){var e=n.document,r=Ut.fromTag("div");function o(n){var t=Ut.fromTag("span");return Td(t,[Di.resolve("layer-editor"),Di.resolve("unfocused-selection")]),ei(t,{left:n.left()+"px",top:n.top()+"px",width:n.width()+"px",height:n.height()+"px"}),t}Sr(r,Di.resolve("unfocused-selections")),te(Ut.fromDom(e.documentElement),r);var i=qd(r,"touchstart",(function(e){e.prevent(),Vv(n,t),u()})),u=function(){pn(r)};return{update:function(){u();var t=yp(n),e=it(t,o);gn(r,e)},isActive:function(){return 0<ne(r).length},destroy:function(){i.unbind(),ee(r)},clear:u}}(t,a),y=function(){h.clear()};return{toEditing:function(){m.toEditing(),y()},toReading:function(){m.toReading()},onToolbarTouch:function(n){m.onToolbarTouch(n)},refreshSelection:function(){h.isActive()&&h.update()},clearSelection:y,highlightSelection:function(){h.update()},scrollIntoView:function(n,e){Eh(t,i,l,n,e)},updateToolbarPadding:r,setViewportOffset:function(n){d.setViewportOffset(n),wh(i,n).get(o)},syncHeight:function(){Fi(a,"height",a.dom().contentWindow.document.body.scrollHeight+"px")},refreshStructure:d.refresh,destroy:function(){d.restore(),g.destroy(),v.unbind(),p.unbind(),m.destroy(),h.destroy(),Rv(Kt(),wo)}}},_h=function(t,e){var o=_p(),i=dd(),u=dd(),c=ld(),a=ld();return{enter:function(){e.hide();var f=Ut.fromDom(n.document);Sp.getActiveApi(t.editor).each((function(e){i.set({socketHeight:oi(t.socket,"height"),iframeHeight:oi(e.frame(),"height"),outerScroll:n.document.body.scrollTop}),u.set({exclusives:zp.exclusive(f,"."+dg.scrollable())}),Sr(t.container,Di.resolve("fullscreen-maximized")),Cp(t.container,e.body()),o.maximize(),Fi(t.socket,"overflow","scroll"),Fi(t.socket,"-webkit-overflow-scrolling","touch"),xo(e.body());var s=tn(["cWin","ceBody","socket","toolstrip","toolbar","dropup","contentElement","cursor","keyboardType","isScrolling","outerWindow","outerBody"],[]);c.set(Dh(s({cWin:e.win(),ceBody:e.body(),socket:t.socket,toolstrip:t.toolstrip,toolbar:t.toolbar,dropup:t.dropup.element(),contentElement:e.frame(),cursor:r,outerBody:t.body,outerWindow:t.win,keyboardType:Nv.stubborn,isScrolling:function(){return u.get().exists((function(n){return n.socket.isScrolling()}))}}))),c.run((function(n){n.syncHeight()})),a.set(jv(e,c,t.toolstrip,t.socket,t.dropup))}))},refreshStructure:function(){c.run((function(n){n.refreshStructure()}))},exit:function(){o.restore(),a.clear(),c.clear(),e.show(),i.on((function(e){e.socketHeight.each((function(n){Fi(t.socket,"height",n)})),e.iframeHeight.each((function(n){Fi(t.editor.getFrame(),"height",n)})),n.document.body.scrollTop=e.scrollTop})),i.clear(),u.on((function(n){n.exclusives.unbind()})),u.clear(),Or(t.container,Di.resolve("fullscreen-maximized")),Dp(),dg.deregister(t.toolbar),ii(t.socket,"overflow"),ii(t.socket,"-webkit-overflow-scrolling"),wo(t.editor.getFrame()),Sp.getActiveApi(t.editor).each((function(n){n.clearSelection()}))}}},Mh=function(n){var t=je("Getting IosWebapp schema",Ap,n);Fi(t.toolstrip,"width","100%"),Fi(t.container,"position","relative");var e=Nm(Ip((function(){t.setReadOnly(t.readOnlyOnInit()),i.enter()}),t.translate));t.alloy.add(e);var o={show:function(){t.alloy.add(e)},hide:function(){t.alloy.remove(e)}},i=_h(t,o);return{setReadOnly:t.setReadOnly,refreshStructure:i.refreshStructure,enter:i.enter,exit:i.exit,destroy:r}};function Ih(n,t,e){n.system().broadcastOn([Ro.formatChanged()],{command:t,state:e})}function Ah(n){return{getNotificationManagerImpl:function(){return{open:u({progressBar:{value:r},close:r,text:r,getEl:u(null),moveTo:r,moveRel:r,settings:{}}),close:r,reposition:r,getArgs:u({})}},renderUI:function(){var t=n.getElement(),e=Rh(n);function o(){n.fire("ScrollIntoView")}!1===function(n){return!1===n.settings.skin}(n)?(n.contentCSS.push(e.content),Io.DOM.styleSheetLoader.load(e.ui,Vh(n))):Vh(n)();var i=G().os.isAndroid()?function(n){var t=_v({classes:[Di.resolve("android-container")]}),e=Lp(),o=ld(),i=sv(o),c=lv(),a=rv(r,n);return t.add(e.wrapper()),t.add(c),t.add(a.component()),{system:u(t),element:t.element,init:function(n){o.set(Fp(n))},exit:function(){o.run((function(n){n.exit(),Zm.remove(c,i)}))},setToolbarGroups:function(n){var t=e.createGroups(n);e.setGroups(t)},setContextToolbar:function(n){var t=e.createGroups(n);e.setContextToolbar(t)},focusToolbar:function(){e.focus()},restoreToolbar:function(){e.restoreToolbar()},updateMode:function(n){dv(c,i,n,t.root())},socket:u(c),dropup:u(a)}}(o):function(n){var t=_v({classes:[Di.resolve("ios-container")]}),e=Lp(),r=ld(),o=sv(r),i=lv(),c=rv((function(){r.run((function(n){n.refreshStructure()}))}),n);return t.add(e.wrapper()),t.add(i),t.add(c.component()),{system:u(t),element:t.element,init:function(n){r.set(Mh(n))},exit:function(){r.run((function(n){Zm.remove(i,o),n.exit()}))},setToolbarGroups:function(n){var t=e.createGroups(n);e.setGroups(t)},setContextToolbar:function(n){var t=e.createGroups(n);e.setContextToolbar(t)},focusToolbar:function(){e.focus()},restoreToolbar:function(){e.restoreToolbar()},updateMode:function(n){dv(i,o,n,t.root())},socket:u(i),dropup:u(c)}}(o);function c(t,e,r,o){!1===o&&n.selection.collapse();var u=l(t,e,r);i.setToolbarGroups(!0===o?u.readOnly:u.main),n.setMode(!0===o?"readonly":"design"),n.fire(!0===o?Nh():jh()),i.updateMode(o)}function a(t,e){return n.on(t,e),{unbind:function(){n.off(t)}}}!function(n,t){ue(n,t,dn)}(Ut.fromDom(t),i.system());var f=t.ownerDocument.defaultView,s=Dg(f,{onChange:function(){i.system().broadcastOn([Ro.orientationChanged()],{width:_g(f)})},onReady:r}),l=function(n,t,e){var r=n.get();return{readOnly:r.backToMask.concat(t.get()),main:r.backToMask.concat(e.get())}};return n.on("init",(function(){i.init({editor:{getFrame:function(){return Ut.fromDom(n.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:r}},onToReading:function(n){return a(Nh(),n)},onToEditing:function(n){return a(jh(),n)},onScrollToCursor:function(t){return n.on("ScrollIntoView",(function(n){t(n)})),{unbind:function(){n.off("ScrollIntoView"),s.destroy()}}},onTouchToolstrip:function(){t()},onTouchContent:function(){(function(n){return To(n).bind((function(n){return i.system().getByDom(n).toOption()}))})(Ut.fromDom(n.editorContainer.querySelector("."+Di.resolve("toolbar")))).each(W),i.restoreToolbar(),t()},onTapContent:function(t){var e=t.target();"img"===Y(e)?(n.selection.select(e.dom()),t.kill()):"a"===Y(e)&&i.system().getByDom(Ut.fromDom(n.editorContainer)).each((function(n){ho.isAlpha(n)&&Fo(e.dom())}))}},container:Ut.fromDom(n.editorContainer),socket:Ut.fromDom(n.contentAreaContainer),toolstrip:Ut.fromDom(n.editorContainer.querySelector("."+Di.resolve("toolstrip"))),toolbar:Ut.fromDom(n.editorContainer.querySelector("."+Di.resolve("toolbar"))),dropup:i.dropup(),alloy:i.system(),translate:r,setReadOnly:function(n){c(g,m,d,n)},readOnlyOnInit:function(){return!1}});var t=function(){i.dropup().disappear((function(){i.system().broadcastOn([Ro.dropupDismissed()],{})}))},e={label:"The first group",scrollable:!1,items:[Hs.forToolbar("back",(function(){n.selection.collapse(),i.exit()}),{},n)]},o={label:"Back to read only",scrollable:!1,items:[Hs.forToolbar("readonly-back",(function(){c(g,m,d,!0)}),{},n)]},u=Sg(i,n),f=Tg(n.settings,u),l={label:"The extra group",scrollable:!1,items:[]},d=In([{label:"the action group",scrollable:!0,items:f},l]),m=In([{label:"The read only mode group",scrollable:!0,items:[]},l]),g=In({backToMask:[e],backToReadOnly:[o]});Bh(i,n)})),n.on("remove",(function(){i.exit()})),n.on("detach",(function(){!function(n){var t=ne(n.element());C(t,(function(t){n.getByDom(t).each(re)})),ee(n.element())}(i.system()),i.system().destroy()})),{iframeContainer:i.socket().element().dom(),editorContainer:i.element().dom()}}}}var Fh=tinymce.util.Tools.resolve("tinymce.EditorManager"),Rh=function(n){var t=_n(n.settings,"skin_url").fold((function(){return Fh.baseURL+"/skins/ui/oxide"}),(function(n){return n}));return{content:t+"/content.mobile.min.css",ui:t+"/skin.mobile.min.css"}},Bh=function(n,t){var e=On(t.formatter.get());C(e,(function(e){t.formatter.formatChanged(e,(function(t){Ih(n,e,t)}))})),C(["ul","ol"],(function(e){t.selection.selectorChanged(e,(function(t,r){Ih(n,e,t)}))}))},Vh=(u(["x-small","small","medium","large","x-large"]),function(n){function t(){n._skinLoaded=!0,n.fire("SkinLoaded")}return function(){n.initialized?t():n.on("init",t)}}),Nh=u("toReading"),jh=u("toEditing");!function(){Ao.add("mobile",Ah)}()}(window);